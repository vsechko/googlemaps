<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1671.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 14.0px; font: 12.0px Courier; color: #000000; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 14.0px; font: 12.0px Courier; color: #000000; -webkit-text-stroke: #000000; min-height: 12.0px}
    span.s1 {font-kerning: none}
    span.s2 {font: 12.0px 'Courier New'; font-kerning: none}
    span.s3 {font: 12.0px 'Noto Sans Balinese'; font-kerning: none}
    span.s4 {font: 12.0px 'Kohinoor Bangla'; font-kerning: none}
    span.s5 {font: 12.0px 'Kohinoor Devanagari'; font-kerning: none}
    span.s6 {font: 12.0px 'PingFang SC'; font-kerning: none}
    span.s7 {font: 12.0px 'Gujarati Sangam MN'; font-kerning: none}
    span.s8 {font: 12.0px 'Gurmukhi MN'; font-kerning: none}
    span.s9 {font: 12.0px 'Khmer Sangam MN'; font-kerning: none}
    span.s10 {font: 12.0px 'Kannada Sangam MN'; font-kerning: none}
    span.s11 {font: 12.0px 'Lao Sangam MN'; font-kerning: none}
    span.s12 {font: 12.0px 'Noto Sans Limbu'; font-kerning: none}
    span.s13 {font: 12.0px 'Malayalam Sangam MN'; font-kerning: none}
    span.s14 {font: 12.0px 'Noto Sans Mongolian'; font-kerning: none}
    span.s15 {font: 12.0px 'Myanmar Sangam MN'; font-kerning: none}
    span.s16 {font: 12.0px 'Oriya Sangam MN'; font-kerning: none}
    span.s17 {font: 12.0px 'Tamil Sangam MN'; font-kerning: none}
    span.s18 {font: 12.0px 'Kohinoor Telugu'; font-kerning: none}
    span.s19 {font: 12.0px Ayuthaya; font-kerning: none}
    span.s20 {font: 12.0px Kailasa; font-kerning: none}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><span class="s1">/* Polyfill service v3.31.1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* For detailed credits and licence information see https://github.com/financial-times/polyfill-service.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Features requested: Array.from,Array.isArray,Array.of,Array.prototype.@@iterator,Array.prototype.copyWithin,Array.prototype.entries,Array.prototype.every,Array.prototype.fill,Array.prototype.filter,Array.prototype.find,Array.prototype.findIndex,Array.prototype.flat,Array.prototype.flatMap,Array.prototype.forEach,Array.prototype.includes,Array.prototype.indexOf,Array.prototype.keys,Array.prototype.lastIndexOf,Array.prototype.map,Array.prototype.reduce,Array.prototype.reduceRight,Array.prototype.some,Array.prototype.values,AudioContext,Blob,CustomEvent,DOMTokenList,DOMTokenList.prototype.@@iterator,Date.now,Date.prototype.toISOString,DocumentFragment,DocumentFragment.prototype.append,DocumentFragment.prototype.prepend,Element,Element.prototype.after,Element.prototype.append,Element.prototype.before,Element.prototype.classList,Element.prototype.cloneNode,Element.prototype.closest,Element.prototype.dataset,Element.prototype.matches,Element.prototype.placeholder,Element.prototype.prepend,Element.prototype.remove,Element.prototype.replaceWith,Event,Event.focusin,Event.hashchange,EventSource,Function.prototype.bind,Function.prototype.name,HTMLCanvasElement.prototype.toBlob,HTMLDocument,HTMLPictureElement,IntersectionObserver,IntersectionObserverEntry,Intl,JSON,Map,Math.acosh,Math.asinh,Math.atanh,Math.cbrt,Math.clz32,Math.cosh,Math.expm1,Math.fround,Math.hypot,Math.imul,Math.log10,Math.log1p,Math.log2,Math.sign,Math.sinh,Math.tanh,Math.trunc,MutationObserver,Node.prototype.contains,NodeList.prototype.@@iterator,NodeList.prototype.forEach,Number.Epsilon,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.isFinite,Number.isInteger,Number.isNaN,Number.isSafeInteger,Number.parseFloat,Number.parseInt,Object.assign,Object.create,Object.defineProperties,Object.defineProperty,Object.entries,Object.freeze,Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.getPrototypeOf,Object.is,Object.isExtensible,Object.isFrozen,Object.isSealed,Object.keys,Object.preventExtensions,Object.seal,Object.setPrototypeOf,Object.values,Promise,Promise.prototype.finally,RegExp.prototype.flags,Set,String.fromCodePoint,String.prototype.@@iterator,String.prototype.codePointAt,String.prototype.endsWith,String.prototype.includes,String.prototype.padEnd,String.prototype.padStart,String.prototype.repeat,String.prototype.startsWith,String.prototype.trim,Symbol,Symbol.hasInstance,Symbol.isConcatSpreadable,Symbol.iterator,Symbol.match,Symbol.replace,Symbol.search,Symbol.species,Symbol.split,Symbol.toPrimitive,Symbol.toStringTag,Symbol.unscopables,URL,UserTiming,WeakMap,WeakSet,WebAnimations,Window,XMLHttpRequest,blissfuljs,default,es2015,es2016,es2017,es5,es6,es7,getComputedStyle,navigator.sendBeacon,performance.now,setImmediate</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ArrayCreate, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "_ESAbstract.ArraySpeciesCreate", "Array.prototype.filter", "es5", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.map")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.Call, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.prototype.every", "es5", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.forEach", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "WeakMap", "WeakSet", "_ESAbstract.GetIterator", "Map", "Set", "_ESAbstract.IteratorClose", "_ESAbstract.FlattenIntoArray", "Array.prototype.flat", "Array.prototype.flatMap", "_ESAbstract.IteratorNext", "_ESAbstract.IteratorStep", "_ESAbstract.ToPrimitive", "_ESAbstract.ToString", "Array.of", "Array.prototype.fill", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim", "_ESAbstract.OrdinaryToPrimitive")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.Get, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "Object.assign", "Object.defineProperties", "Object.create", "Map", "RegExp.prototype.flags", "WeakMap", "WeakSet", "_ESAbstract.IteratorValue", "Set", "_ESAbstract.ArraySpeciesCreate", "_ESAbstract.FlattenIntoArray", "_ESAbstract.IteratorComplete", "_ESAbstract.IteratorStep", "_ESAbstract.EnumerableOwnProperties", "Object.entries", "es2017", "_ESAbstract.SpeciesConstructor", "Promise.prototype.finally", "_ESAbstract.IsRegExp", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.startsWith", "_ESAbstract.GetPrototypeFromConstructor", "_ESAbstract.OrdinaryCreateFromConstructor", "_ESAbstract.Construct", "Array.of", "_ESAbstract.OrdinaryToPrimitive", "_ESAbstract.ToPrimitive", "_ESAbstract.ToString", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.padEnd", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.trim")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.HasProperty, License: CC0 (required by "Array.prototype.copyWithin", "es2015", "es6", "Array.prototype.every", "default", "es5", "Array.prototype.filter", "blissfuljs", "Array.prototype.forEach", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "_ESAbstract.FlattenIntoArray", "Array.prototype.flat", "Array.prototype.flatMap")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IsArray, License: CC0 (required by "Array.isArray", "blissfuljs", "default", "es5", "String.fromCodePoint", "es6", "WeakMap", "es2015", "WeakSet", "_ESAbstract.ArraySpeciesCreate", "Array.prototype.filter", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.map", "_ESAbstract.FlattenIntoArray")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IsCallable, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.prototype.every", "es5", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "Function.prototype.bind", "Map", "Promise.prototype.finally", "Set", "WeakMap", "WeakSet", "_ESAbstract.GetMethod", "_ESAbstract.OrdinaryToPrimitive", "_ESAbstract.ToPrimitive", "_ESAbstract.ToString", "Array.of", "Array.prototype.fill", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.RequireObjectCoercible, License: CC0 (required by "String.prototype.@@iterator", "es2015", "es6", "String.prototype.codePointAt", "String.prototype.endsWith", "blissfuljs", "default", "String.prototype.includes", "String.prototype.padEnd", "es2016", "es2017", "es7", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.SameValueNonNumber, License: CC0 (required by "_ESAbstract.SameValueZero", "Array.prototype.includes", "es2016", "es7", "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set", "WeakSet", "_ESAbstract.SameValue", "Object.is", "String.fromCodePoint", "WeakMap")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToBoolean, License: CC0 (required by "Array.prototype.every", "default", "es5", "Array.prototype.filter", "blissfuljs", "Array.prototype.find", "es2015", "es6", "Array.prototype.findIndex", "Array.prototype.some", "RegExp.prototype.flags", "_ESAbstract.IteratorComplete", "Map", "Array.from", "Set", "_ESAbstract.IteratorStep", "WeakMap", "WeakSet", "_ESAbstract.IsRegExp", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.startsWith")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToInteger, License: CC0 (required by "Array.prototype.copyWithin", "es2015", "es6", "Array.prototype.fill", "default", "Array.prototype.flat", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "blissfuljs", "es5", "Array.prototype.lastIndexOf", "Number.isInteger", "Number.isSafeInteger", "String.fromCodePoint", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.repeat", "String.prototype.startsWith", "_ESAbstract.ToLength", "Array.from", "Array.prototype.every", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.padEnd", "es2017", "String.prototype.padStart")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToLength, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "_ESAbstract.FlattenIntoArray")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToNumber, License: CC0 (required by "String.fromCodePoint", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToObject, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.prototype.entries", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.keys", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "Array.prototype.values", "Array.prototype.@@iterator", "Object.assign", "Object.defineProperties", "Object.create", "Map", "Object.entries", "es2017", "Object.values", "_ESAbstract.GetV", "_ESAbstract.GetMethod", "Set", "_ESAbstract.GetIterator", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.GetV, License: CC0 (required by "_ESAbstract.GetMethod", "Array.from", "blissfuljs", "default", "es2015", "es6", "Map", "Set", "_ESAbstract.GetIterator", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.GetMethod, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Map", "Set", "_ESAbstract.IsConstructor", "Array.of", "_ESAbstract.GetIterator", "WeakMap", "WeakSet", "_ESAbstract.IteratorClose", "_ESAbstract.ToPrimitive", "_ESAbstract.ToString", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToUint32, License: CC0 (required by "Math.clz32", "es2015", "es6", "Math.imul")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.Type, License: CC0 (required by "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Number.isFinite", "Number.isInteger", "Number.isNaN", "Number.isSafeInteger", "Object.create", "es5", "Object.defineProperties", "Object.isExtensible", "Object.isFrozen", "Object.isSealed", "Object.seal", "RegExp.prototype.flags", "WeakMap", "WeakSet", "_ESAbstract.IsConstructor", "Array.of", "_ESAbstract.GetIterator", "Set", "_ESAbstract.IteratorClose", "_ESAbstract.ToString", "Array.prototype.every", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim", "_ESAbstract.IteratorValue", "_ESAbstract.ArraySpeciesCreate", "Array.prototype.flat", "Array.prototype.flatMap", "_ESAbstract.SameValueZero", "_ESAbstract.CreateIterResultObject", "_ESAbstract.IteratorComplete", "_ESAbstract.IteratorStep", "_ESAbstract.IteratorNext", "_ESAbstract.EnumerableOwnProperties", "Object.entries", "_ESAbstract.SameValue", "Object.is", "String.fromCodePoint", "_ESAbstract.SpeciesConstructor", "Promise.prototype.finally", "_ESAbstract.IsRegExp", "_ESAbstract.ToPrimitive", "_ESAbstract.GetPrototypeFromConstructor", "_ESAbstract.OrdinaryCreateFromConstructor", "_ESAbstract.Construct", "_ESAbstract.OrdinaryToPrimitive")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.GetPrototypeFromConstructor, License: CC0 (required by "_ESAbstract.OrdinaryCreateFromConstructor", "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set", "WeakMap", "WeakSet", "_ESAbstract.Construct", "Array.of")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IsConstructor, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "_ESAbstract.Construct", "_ESAbstract.ArraySpeciesCreate", "Array.prototype.filter", "es5", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.map", "_ESAbstract.SpeciesConstructor", "Promise.prototype.finally")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IsRegExp, License: CC0 (required by "String.prototype.endsWith", "blissfuljs", "default", "es2015", "es6", "String.prototype.includes", "String.prototype.startsWith")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IteratorClose, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Map", "Set", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IteratorComplete, License: CC0 (required by "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set", "_ESAbstract.IteratorStep", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IteratorNext, License: CC0 (required by "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set", "_ESAbstract.IteratorStep", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IteratorStep, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Map", "Set", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.IteratorValue, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Map", "Set", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.OrdinaryToPrimitive, License: CC0 (required by "_ESAbstract.ToPrimitive", "_ESAbstract.ToString", "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.SameValue, License: CC0 (required by "Object.is", "es2015", "es6", "String.fromCodePoint", "WeakMap", "blissfuljs")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.SameValueZero, License: CC0 (required by "Array.prototype.includes", "es2016", "es7", "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.SpeciesConstructor, License: CC0 (required by "Promise.prototype.finally")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToPrimitive, License: CC0 (required by "_ESAbstract.ToString", "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ToString, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "Array.prototype.every", "es5", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "es2017", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim", "_ESAbstract.FlattenIntoArray", "Array.prototype.flat", "Array.prototype.flatMap")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.UTF16Decode, License: CC0 (required by "String.prototype.codePointAt", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.UTF16Encoding, License: CC0 (required by "String.fromCodePoint", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _TypedArray, License: MIT (required by "HTMLCanvasElement.prototype.toBlob", "Math.fround", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - atob, License: MIT (required by "default", "Blob", "HTMLCanvasElement.prototype.toBlob")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - AudioContext, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Date.now, License: CC0 (required by "default", "es5", "performance.now", "IntersectionObserver", "requestAnimationFrame")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Date.prototype.toISOString, License: CC0 (required by "default", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - document, License: CC0 (required by "default", "DocumentFragment.prototype.append", "DocumentFragment.prototype.prepend", "Element", "Element.prototype.after", "Element.prototype.append", "Element.prototype.before", "Element.prototype.prepend", "Element.prototype.remove", "Element.prototype.replaceWith", "Event", "CustomEvent", "document.querySelector", "blissfuljs", "Element.prototype.dataset", "Element.prototype.matches", "Element.prototype.closest", "Element.prototype.placeholder", "~html5-elements", "HTMLPictureElement", "_mutation")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - ~html5-elements, License: MIT (required by "default", "HTMLPictureElement")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - DocumentFragment, License: CC0 (required by "DocumentFragment.prototype.append", "default", "DocumentFragment.prototype.prepend")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element, License: CC0 (required by "default", "DocumentFragment.prototype.append", "DocumentFragment.prototype.prepend", "Element.prototype.after", "Element.prototype.append", "Element.prototype.before", "Element.prototype.classList", "blissfuljs", "Element.prototype.cloneNode", "Element.prototype.dataset", "Element.prototype.matches", "Element.prototype.closest", "Element.prototype.placeholder", "Element.prototype.prepend", "Element.prototype.remove", "Element.prototype.replaceWith", "Event", "CustomEvent", "Node.prototype.contains", "document.querySelector", "_mutation")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _mutation, License: CC0 (required by "DocumentFragment.prototype.append", "default", "DocumentFragment.prototype.prepend", "Element.prototype.after", "Element.prototype.append", "Element.prototype.before", "Element.prototype.prepend", "Element.prototype.remove", "Element.prototype.replaceWith")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - document.querySelector, License: CC0 (required by "blissfuljs", "default", "Element.prototype.dataset", "Element.prototype.matches", "Element.prototype.closest", "Element.prototype.placeholder")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - DocumentFragment.prototype.append, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - DocumentFragment.prototype.prepend, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.append, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.cloneNode, License: CC0 (required by "blissfuljs", "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.matches, License: CC0 (required by "blissfuljs", "default", "Element.prototype.closest")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.closest, License: CC0 (required by "blissfuljs", "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.prepend, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.remove, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.replaceWith, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - EventSource, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - HTMLDocument, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - HTMLPictureElement, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Intl, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - JSON, License: MIT (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - MutationObserver, License: WTFPL</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Node.prototype.contains, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.defineProperty, License: CC0 (required by "blissfuljs", "default", "es5", "Element.prototype.classList", "Element.prototype.dataset", "Element.prototype.placeholder", "Event", "CustomEvent", "Function.prototype.name", "es2015", "es6", "IntersectionObserverEntry", "Map", "Array.from", "Number.Epsilon", "Number.MAX_SAFE_INTEGER", "Number.MIN_SAFE_INTEGER", "Object.defineProperties", "Object.create", "Object.setPrototypeOf", "Object.values", "es2017", "RegExp.prototype.flags", "Set", "Symbol", "Symbol.hasInstance", "Symbol.isConcatSpreadable", "Symbol.iterator", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "String.prototype.@@iterator", "Symbol.match", "Symbol.replace", "Symbol.search", "Symbol.species", "Symbol.split", "Symbol.toPrimitive", "Symbol.toStringTag", "Symbol.unscopables", "WeakMap", "WeakSet", "_ESAbstract.CreateMethodProperty", "Array.isArray", "Array.of", "Array.prototype.copyWithin", "Array.prototype.entries", "Array.prototype.every", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.keys", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "Array.prototype.values", "Function.prototype.bind", "HTMLCanvasElement.prototype.toBlob", "Math.acosh", "Math.asinh", "Math.atanh", "Math.cbrt", "Math.clz32", "Math.cosh", "Math.expm1", "Math.fround", "Math.hypot", "Math.imul", "Math.log10", "Math.log1p", "Math.log2", "Math.sign", "Math.sinh", "Math.tanh", "Math.trunc", "Number.isFinite", "Number.isInteger", "Number.isNaN", "Number.isSafeInteger", "Number.parseFloat", "Number.parseInt", "Object.assign", "Object.entries", "Object.freeze", "Object.getOwnPropertyDescriptor", "Object.getOwnPropertyNames", "Object.getPrototypeOf", "Object.is", "Object.isExtensible", "Object.isFrozen", "Object.isSealed", "Object.keys", "Object.preventExtensions", "Object.seal", "Promise.prototype.finally", "String.fromCodePoint", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim", "_ArrayIterator", "_DOMTokenList", "DOMTokenList", "_ESAbstract.OrdinaryCreateFromConstructor", "_ESAbstract.Construct", "_StringIterator", "_ESAbstract.CreateDataProperty", "_ESAbstract.CreateDataPropertyOrThrow", "_ESAbstract.CreateIterResultObject", "_Iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _DOMTokenList, License: ISC (required by "DOMTokenList", "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - DOMTokenList, License: CC0 (required by "default", "DOMTokenList.prototype.@@iterator", "Element.prototype.classList", "blissfuljs")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.CreateDataProperty, License: CC0 (required by "_ESAbstract.CreateDataPropertyOrThrow", "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "Array.prototype.filter", "es5", "Array.prototype.map", "_ESAbstract.CreateIterResultObject", "Map", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.CreateDataPropertyOrThrow, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "Array.prototype.filter", "es5", "Array.prototype.map", "_ESAbstract.FlattenIntoArray", "Array.prototype.flat", "Array.prototype.flatMap")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.FlattenIntoArray, License: CC0 (required by "Array.prototype.flat", "Array.prototype.flatMap")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.CreateIterResultObject, License: CC0 (required by "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.CreateMethodProperty, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.isArray", "es5", "Array.of", "Array.prototype.@@iterator", "Array.prototype.copyWithin", "Array.prototype.entries", "Array.prototype.every", "Array.prototype.fill", "Array.prototype.filter", "Array.prototype.find", "Array.prototype.findIndex", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.forEach", "Array.prototype.includes", "es2016", "es7", "Array.prototype.indexOf", "Array.prototype.keys", "Array.prototype.lastIndexOf", "Array.prototype.map", "Array.prototype.reduce", "Array.prototype.reduceRight", "Array.prototype.some", "Array.prototype.values", "Function.prototype.bind", "HTMLCanvasElement.prototype.toBlob", "Map", "Math.acosh", "Math.asinh", "Math.atanh", "Math.cbrt", "Math.clz32", "Math.cosh", "Math.expm1", "Math.fround", "Math.hypot", "Math.imul", "Math.log10", "Math.log1p", "Math.log2", "Math.sign", "Math.sinh", "Math.tanh", "Math.trunc", "Number.isFinite", "Number.isInteger", "Number.isNaN", "Number.isSafeInteger", "Number.parseFloat", "Number.parseInt", "Object.assign", "Object.create", "Object.defineProperties", "Object.entries", "es2017", "Object.freeze", "Object.getOwnPropertyDescriptor", "Element.prototype.dataset", "Object.getOwnPropertyNames", "Object.getPrototypeOf", "Object.is", "Object.isExtensible", "Object.isFrozen", "Object.isSealed", "Object.keys", "Object.preventExtensions", "Object.seal", "Object.setPrototypeOf", "Object.values", "Promise.prototype.finally", "Set", "String.fromCodePoint", "String.prototype.@@iterator", "String.prototype.codePointAt", "String.prototype.endsWith", "String.prototype.includes", "String.prototype.padEnd", "String.prototype.padStart", "String.prototype.repeat", "String.prototype.startsWith", "String.prototype.trim", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.isArray, License: CC0 (required by "blissfuljs", "default", "es5", "IntersectionObserver", "Map", "es2015", "es6", "Array.from", "Set", "URL", "Blob", "WeakMap")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.copyWithin, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.every, License: CC0 (required by "default", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.fill, License: CC0 (required by "default", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.find, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.findIndex, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.forEach, License: CC0 (required by "blissfuljs", "default", "es5", "IntersectionObserver", "NodeList.prototype.forEach", "Object.setPrototypeOf", "es2015", "es6", "Symbol", "Map", "Array.from", "Set", "URL", "Blob")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - NodeList.prototype.forEach, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.includes, License: MIT (required by "es2016", "es7")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.indexOf, License: CC0 (required by "blissfuljs", "default", "es5", "Element.prototype.after", "Element.prototype.before", "IntersectionObserver")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.after, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.before, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.lastIndexOf, License: CC0 (required by "default", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.reduce, License: CC0 (required by "blissfuljs", "default", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.reduceRight, License: CC0 (required by "default", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.some, License: CC0 (required by "blissfuljs", "default", "es5", "IntersectionObserver")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Function.prototype.bind, License: MIT (required by "blissfuljs", "default", "es5", "IntersectionObserver", "Object.getOwnPropertyDescriptor", "Element.prototype.dataset", "Object.assign", "es2015", "es6", "Object.defineProperties", "Object.create", "Map", "Array.from", "Promise.prototype.finally", "_ESAbstract.Construct", "Array.of", "_Iterator", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.acosh, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.asinh, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.atanh, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.cbrt, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.clz32, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.cosh, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.expm1, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.fround, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.hypot, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.imul, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.log10, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.log1p, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.log2, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.sign, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.sinh, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.tanh, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Math.trunc, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.isFinite, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.isInteger, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.isNaN, License: MIT (required by "default", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.isSafeInteger, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.parseFloat, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.parseInt, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.classList, License: ISC (required by "blissfuljs", "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.placeholder, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Function.prototype.name, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.Epsilon, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.MAX_SAFE_INTEGER, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Number.MIN_SAFE_INTEGER, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.freeze, License: CC0 (required by "es5", "Symbol", "es2015", "es6", "Map", "default", "Array.from", "blissfuljs", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.getOwnPropertyDescriptor, License: CC0 (required by "blissfuljs", "default", "es5", "Element.prototype.dataset", "Object.assign", "es2015", "es6", "Object.defineProperties", "Object.create", "Map", "Array.from", "Object.setPrototypeOf", "Symbol", "Set", "_ESAbstract.EnumerableOwnProperties", "Object.entries", "es2017")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.EnumerableOwnProperties, License: CC0 (required by "Object.entries", "es2017")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.entries, License: CC0 (required by "es2017")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Element.prototype.dataset, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.getOwnPropertyNames, License: CC0 (required by "default", "es5", "Object.setPrototypeOf", "es2015", "es6", "Symbol", "Map", "Array.from", "blissfuljs", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.getPrototypeOf, License: CC0 (required by "default", "es5", "Object.setPrototypeOf", "es2015", "es6", "_ESAbstract.OrdinaryCreateFromConstructor", "Map", "Array.from", "blissfuljs", "Set", "WeakMap", "WeakSet", "_ESAbstract.Construct", "Array.of")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.is, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.isExtensible, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.isFrozen, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.isSealed, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.keys, License: MIT (required by "blissfuljs", "default", "es5", "Object.assign", "es2015", "es6", "Object.defineProperties", "Object.create", "Map", "Array.from", "Object.values", "es2017", "Symbol", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.assign, License: CC0 (required by "default", "es2015", "es6", "_Iterator", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.defineProperties, License: CC0 (required by "default", "es5", "Object.create", "blissfuljs", "Map", "es2015", "es6", "Array.from", "URL", "Blob", "location.origin", "_Iterator", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - location.origin, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.create, License: CC0 (required by "blissfuljs", "default", "es5", "Map", "es2015", "es6", "Array.from", "Object.setPrototypeOf", "Set", "Symbol", "_ESAbstract.GetIterator", "WeakMap", "WeakSet", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_ESAbstract.OrdinaryCreateFromConstructor", "_ESAbstract.Construct", "Array.of", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.GetIterator, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Map", "Set", "WeakMap", "WeakSet")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.OrdinaryCreateFromConstructor, License: CC0 (required by "Map", "default", "es2015", "es6", "Array.from", "blissfuljs", "Set", "WeakMap", "WeakSet", "_ESAbstract.Construct", "Array.of")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.Construct, License: CC0 (required by "Array.from", "blissfuljs", "default", "es2015", "es6", "Array.of", "_ESAbstract.ArraySpeciesCreate", "Array.prototype.filter", "es5", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.map")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ESAbstract.ArraySpeciesCreate, License: CC0 (required by "Array.prototype.filter", "blissfuljs", "default", "es5", "Array.prototype.flat", "Array.prototype.flatMap", "Array.prototype.map")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.filter, License: CC0 (required by "blissfuljs", "default", "es5", "IntersectionObserver", "Symbol", "es2015", "es6", "Map", "Array.from", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.flat, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.flatMap, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.map, License: CC0 (required by "blissfuljs", "default", "es5", "IntersectionObserver", "Object.values", "es2017", "Symbol", "es2015", "es6", "Map", "Array.from", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.of, License: CC0 (required by "default", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.preventExtensions, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.seal, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.setPrototypeOf, License: MIT (required by "es2015", "es6", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Object.values, License: CC0 (required by "es2017")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - performance.now, License: CC0 (required by "IntersectionObserver")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Promise, License: MIT (required by "blissfuljs", "default", "es2015", "es6", "Promise.prototype.finally")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Promise.prototype.finally, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - RegExp.prototype.flags, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - requestAnimationFrame, License: MIT (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - setImmediate, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.fromCodePoint, License: MIT (required by "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.codePointAt, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.endsWith, License: CC0 (required by "blissfuljs", "default", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.includes, License: CC0 (required by "default", "es2015", "es6", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.padEnd, License: CC0 (required by "es2016", "es2017", "es7")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.padStart, License: CC0 (required by "es2016", "es2017", "es7")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.repeat, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.startsWith, License: CC0 (required by "blissfuljs", "default", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.trim, License: CC0 (required by "blissfuljs", "default", "es5")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol, License: MIT (required by "es2015", "es6", "Map", "default", "Array.from", "blissfuljs", "Set", "Symbol.hasInstance", "Symbol.isConcatSpreadable", "Symbol.iterator", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "String.prototype.@@iterator", "Symbol.match", "Symbol.replace", "Symbol.search", "Symbol.species", "Symbol.split", "Symbol.toPrimitive", "Symbol.toStringTag", "Symbol.unscopables", "WeakMap", "WeakSet", "_Iterator", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "_StringIterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.hasInstance, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.isConcatSpreadable, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.iterator, License: MIT (required by "es2015", "es6", "Array.from", "blissfuljs", "default", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "Map", "NodeList.prototype.@@iterator", "Set", "String.prototype.@@iterator", "_Iterator", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "_StringIterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.match, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.replace, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.search, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.species, License: MIT (required by "es2015", "es6", "Map", "default", "Array.from", "blissfuljs", "Set")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Map, License: CC0 (required by "default", "es2015", "es6", "Array.from", "blissfuljs")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Set, License: CC0 (required by "default", "es2015", "es6", "Array.from", "blissfuljs")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.from, License: CC0 (required by "blissfuljs", "default", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.split, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.toPrimitive, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.toStringTag, License: MIT (required by "es2015", "es6", "_Iterator", "_ArrayIterator", "Array.prototype.entries", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _Iterator, License: MIT (required by "_ArrayIterator", "Array.prototype.entries", "es2015", "es6", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator", "_StringIterator", "String.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _ArrayIterator, License: MIT (required by "Array.prototype.entries", "es2015", "es6", "Array.prototype.keys", "Array.prototype.values", "Array.prototype.@@iterator", "DOMTokenList.prototype.@@iterator", "NodeList.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.entries, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.keys, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.values, License: MIT (required by "es2015", "es6", "Array.prototype.@@iterator")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Array.prototype.@@iterator, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - DOMTokenList.prototype.@@iterator, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - NodeList.prototype.@@iterator, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - _StringIterator, License: MIT (required by "String.prototype.@@iterator", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - String.prototype.@@iterator, License: CC0 (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Symbol.unscopables, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - URL, License: CC0-1.0 (required by "blissfuljs", "default", "Blob")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Blob, License: MIT (required by "HTMLCanvasElement.prototype.toBlob")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - HTMLCanvasElement.prototype.toBlob, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - UserTiming, License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - WeakMap, License: MIT (required by "blissfuljs", "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - WeakSet, License: MIT (required by "es2015", "es6")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - WebAnimations, License: Apache-2.0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Window, License: CC0 (required by "default", "Event", "CustomEvent", "getComputedStyle", "IntersectionObserver")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Event, License: CC0 (required by "default", "CustomEvent", "Event.focusin", "Event.hashchange", "IntersectionObserver", "XMLHttpRequest", "blissfuljs")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - CustomEvent, License: CC0 (required by "default", "document.visibilityState")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - document.visibilityState, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Event.focusin, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - Event.hashchange, License: CC0 (required by "default")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - getComputedStyle, License: CC0 (required by "IntersectionObserver")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - IntersectionObserver, License: CC0 (required by "IntersectionObserverEntry")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - IntersectionObserverEntry, License: CC0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - XMLHttpRequest, License: CC0 (required by "blissfuljs", "default", "navigator.sendBeacon")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* - navigator.sendBeacon, License: MIT */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function(undefined) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ArrayCreate</span></p>
<p class="p1"><span class="s1">// 9.4.2.2. ArrayCreate ( length [ , proto ] )</span></p>
<p class="p1"><span class="s1">function ArrayCreate(length /* [, proto] */) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: length is an integer Number ≥ 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If length is -0, set length to +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1 / length === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If length&gt;2^32-1, throw a RangeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (length &gt; (Math.pow(2, 32) - 1)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new RangeError('Invalid array length');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If proto is not present, set proto to the intrinsic object %ArrayPrototype%.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let A be a newly created Array exotic object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var A = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Set A's essential internal methods except for [[DefineOwnProperty]] to the default ordinary object definitions specified in 9.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Set A.[[DefineOwnProperty]] as specified in 9.4.2.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Set A.[[Prototype]] to proto.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Set A.[[Extensible]] to true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Perform ! OrdinaryDefineOwnProperty(A, "length", PropertyDescriptor{[[Value]]: length, [[Writable]]: true, [[Enumerable]]: false, [[Configurable]]: false}).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>A.length = length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 11. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return A;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.Call</span></p>
<p class="p1"><span class="s1">/* global IsCallable */</span></p>
<p class="p1"><span class="s1">// 7.3.12. Call ( F, V [ , argumentsList ] )</span></p>
<p class="p1"><span class="s1">function Call(F, V /* [, argumentsList] */) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If argumentsList is not present, set argumentsList to a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var argumentsList = arguments.length &gt; 2 ? arguments[2] : [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If IsCallable(F) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(F) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(Object.prototype.toString.call(F) + 'is not a function.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return ? F.[[Call]](V, argumentsList).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return F.apply(V, argumentsList);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.Get</span></p>
<p class="p1"><span class="s1">// 7.3.1. Get ( O, P )</span></p>
<p class="p1"><span class="s1">function Get(O, P) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return ? O.[[Get]](P, O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return O[P];</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.HasProperty</span></p>
<p class="p1"><span class="s1">// 7.3.10. HasProperty ( O, P )</span></p>
<p class="p1"><span class="s1">function HasProperty(O, P) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Return ? O.[[HasProperty]](P).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return P in O;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IsArray</span></p>
<p class="p1"><span class="s1">// 7.2.2. IsArray ( argument )</span></p>
<p class="p1"><span class="s1">function IsArray(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(argument) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If argument is an Array exotic object, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If argument is a Proxy exotic object, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If argument.[[ProxyHandler]] is null, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let target be argument.[[ProxyTarget]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Return ? IsArray(target).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return false.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We can skip all the above steps and check the string returned from Object.prototype.toString().</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Object.prototype.toString.call(argument) === '[object Array]';</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IsCallable</span></p>
<p class="p1"><span class="s1">// 7.2.3. IsCallable ( argument )</span></p>
<p class="p1"><span class="s1">function IsCallable(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(argument) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If argument has a [[Call]] internal method, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return false.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - Only function objects have a [[Call]] internal method. This means we can simplify this function to check that the argument has a type of function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return typeof argument === 'function';</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.RequireObjectCoercible</span></p>
<p class="p1"><span class="s1">// 7.2.1. RequireObjectCoercible ( argument )</span></p>
<p class="p1"><span class="s1">// The abstract operation ToObject converts argument to a value of type Object according to Table 12:</span></p>
<p class="p1"><span class="s1">// Table 12: ToObject Conversions</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1">|----------------------------------------------------------------------------------------------------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Argument Type | Result <span class="Apple-converted-space">                                                                                                                            </span>|</span></p>
<p class="p1"><span class="s1">|----------------------------------------------------------------------------------------------------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Undefined <span class="Apple-converted-space">    </span>| Throw a TypeError exception. <span class="Apple-converted-space">                                                                                                      </span>|</span></p>
<p class="p1"><span class="s1">| Null<span class="Apple-converted-space">          </span>| Throw a TypeError exception. <span class="Apple-converted-space">                                                                                                      </span>|</span></p>
<p class="p1"><span class="s1">| Boolean <span class="Apple-converted-space">      </span>| Return argument. <span class="Apple-converted-space">                                                                                                                  </span>|</span></p>
<p class="p1"><span class="s1">| Number<span class="Apple-converted-space">        </span>| Return argument. <span class="Apple-converted-space">                                                                                                                  </span>|</span></p>
<p class="p1"><span class="s1">| String<span class="Apple-converted-space">        </span>| Return argument. <span class="Apple-converted-space">                                                                                                                  </span>|</span></p>
<p class="p1"><span class="s1">| Symbol<span class="Apple-converted-space">        </span>| Return argument. <span class="Apple-converted-space">                                                                                                                  </span>|</span></p>
<p class="p1"><span class="s1">| Object<span class="Apple-converted-space">        </span>| Return argument. <span class="Apple-converted-space">                                                                                                                  </span>|</span></p>
<p class="p1"><span class="s1">|----------------------------------------------------------------------------------------------------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">function RequireObjectCoercible(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (argument === null || argument === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return argument;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.SameValueNonNumber</span></p>
<p class="p1"><span class="s1">// 7.2.12. SameValueNonNumber ( x, y )</span></p>
<p class="p1"><span class="s1">function SameValueNonNumber(x, y) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(x) is not Number.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: Type(x) is the same as Type(y).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If Type(x) is Undefined, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If Type(x) is Null, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If Type(x) is String, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If x and y are exactly the same sequence of code units (same length and same code units at corresponding indices), return true; otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. If Type(x) is Boolean, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If x and y are both true or both false, return true; otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If Type(x) is Symbol, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If x and y are both the same Symbol value, return true; otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. If x and y are the same Object value, return true. Otherwise, return false.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We can skip all above steps because the === operator does it all for us.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return x === y;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToBoolean</span></p>
<p class="p1"><span class="s1">// 7.1.2. ToBoolean ( argument )</span></p>
<p class="p1"><span class="s1">// The abstract operation ToBoolean converts argument to a value of type Boolean according to Table 9:</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1">--------------------------------------------------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1">| Argument Type | Result <span class="Apple-converted-space">                                                                                    </span>|</span></p>
<p class="p1"><span class="s1">--------------------------------------------------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1">| Undefined <span class="Apple-converted-space">    </span>| Return false.<span class="Apple-converted-space">                                                                              </span>|</span></p>
<p class="p1"><span class="s1">| Null<span class="Apple-converted-space">          </span>| Return false.<span class="Apple-converted-space">                                                                              </span>|</span></p>
<p class="p1"><span class="s1">| Boolean <span class="Apple-converted-space">      </span>| Return argument. <span class="Apple-converted-space">                                                                          </span>|</span></p>
<p class="p1"><span class="s1">| Number<span class="Apple-converted-space">        </span>| If argument is +0, -0, or NaN, return false; otherwise return true.<span class="Apple-converted-space">                        </span>|</span></p>
<p class="p1"><span class="s1">| String<span class="Apple-converted-space">        </span>| If argument is the empty String (its length is zero), return false; otherwise return true. |</span></p>
<p class="p1"><span class="s1">| Symbol<span class="Apple-converted-space">        </span>| Return true. <span class="Apple-converted-space">                                                                              </span>|</span></p>
<p class="p1"><span class="s1">| Object<span class="Apple-converted-space">        </span>| Return true. <span class="Apple-converted-space">                                                                              </span>|</span></p>
<p class="p1"><span class="s1">--------------------------------------------------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">function ToBoolean(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Boolean(argument);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToInteger</span></p>
<p class="p1"><span class="s1">// 7.1.4. ToInteger ( argument )</span></p>
<p class="p1"><span class="s1">function ToInteger(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let number be ? ToNumber(argument).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var number = Number(argument);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If number is NaN, return +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(number)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If number is +0, -0, +∞, or -∞, return number.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1/number === Infinity || 1/number === -Infinity || number === Infinity || number === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return number;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return the number value that is the same sign as number and whose magnitude is floor(abs(number)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return ((number &lt; 0) ? -1 : 1) * Math.floor(Math.abs(number));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToLength</span></p>
<p class="p1"><span class="s1">/* global ToInteger */</span></p>
<p class="p1"><span class="s1">// 7.1.15. ToLength ( argument )</span></p>
<p class="p1"><span class="s1">function ToLength(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let len be ? ToInteger(argument).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToInteger(argument);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If len ≤ +0, return +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return min(len, 253-1).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.min(len, Math.pow(2, 53) -1);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToNumber</span></p>
<p class="p1"><span class="s1">// 7.1.3. ToNumber ( argument )</span></p>
<p class="p1"><span class="s1">function ToNumber(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Number(argument);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToObject</span></p>
<p class="p1"><span class="s1">// 7.1.13 ToObject ( argument )</span></p>
<p class="p1"><span class="s1">// The abstract operation ToObject converts argument to a value of type Object according to Table 12:</span></p>
<p class="p1"><span class="s1">// Table 12: ToObject Conversions</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1">|----------------------------------------------------------------------------------------------------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Argument Type | Result <span class="Apple-converted-space">                                                                                                                            </span>|</span></p>
<p class="p1"><span class="s1">|----------------------------------------------------------------------------------------------------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Undefined <span class="Apple-converted-space">    </span>| Throw a TypeError exception. <span class="Apple-converted-space">                                                                                                      </span>|</span></p>
<p class="p1"><span class="s1">| Null<span class="Apple-converted-space">          </span>| Throw a TypeError exception. <span class="Apple-converted-space">                                                                                                      </span>|</span></p>
<p class="p1"><span class="s1">| Boolean <span class="Apple-converted-space">      </span>| Return a new Boolean object whose [[BooleanData]] internal slot is set to argument. See 19.3 for a description of Boolean objects. |</span></p>
<p class="p1"><span class="s1">| Number<span class="Apple-converted-space">        </span>| Return a new Number object whose [[NumberData]] internal slot is set to argument. See 20.1 for a description of Number objects.<span class="Apple-converted-space">    </span>|</span></p>
<p class="p1"><span class="s1">| String<span class="Apple-converted-space">        </span>| Return a new String object whose [[StringData]] internal slot is set to argument. See 21.1 for a description of String objects.<span class="Apple-converted-space">    </span>|</span></p>
<p class="p1"><span class="s1">| Symbol<span class="Apple-converted-space">        </span>| Return a new Symbol object whose [[SymbolData]] internal slot is set to argument. See 19.4 for a description of Symbol objects.<span class="Apple-converted-space">    </span>|</span></p>
<p class="p1"><span class="s1">| Object<span class="Apple-converted-space">        </span>| Return argument. <span class="Apple-converted-space">                                                                                                                  </span>|</span></p>
<p class="p1"><span class="s1">|----------------------------------------------------------------------------------------------------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">function ToObject(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (argument === null || argument === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return Object(argument);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.GetV</span></p>
<p class="p1"><span class="s1">/* global ToObject */</span></p>
<p class="p1"><span class="s1">// 7.3.2 GetV (V, P)</span></p>
<p class="p1"><span class="s1">function GetV(v, p) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let O be ? ToObject(V).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var o = ToObject(v);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return ? O.[[Get]](P, V).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return o[p];</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.GetMethod</span></p>
<p class="p1"><span class="s1">/* global GetV, IsCallable */</span></p>
<p class="p1"><span class="s1">// 7.3.9. GetMethod ( V, P )</span></p>
<p class="p1"><span class="s1">function GetMethod(V, P) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let func be ? GetV(V, P).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var func = GetV(V, P);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If func is either undefined or null, return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (func === null || func === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If IsCallable(func) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(func) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method not callable: ' + P);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return func.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return func;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToUint32</span></p>
<p class="p1"><span class="s1">// 7.1.6. ToUint32 ( argument )</span></p>
<p class="p1"><span class="s1">function ToUint32(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let number be ? ToNumber(argument).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var number = Number(argument);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If number is NaN, +0, -0, +∞, or -∞, return +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(number) || 1/number === Infinity || 1/number === -Infinity || number === Infinity || number === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let int be the mathematical value that is the same sign as number and whose magnitude is floor(abs(number)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var int = ((number &lt; 0) ? -1 : 1) * Math.floor(Math.abs(number));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let int32bit be int modulo 2^32.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var int32bit = int &gt;&gt;&gt; 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return int32bit.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return int32bit;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.Type</span></p>
<p class="p1"><span class="s1">// "Type(x)" is used as shorthand for "the type of x"...</span></p>
<p class="p1"><span class="s1">function Type(x) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>switch (typeof x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'undefined':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 'undefined';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'boolean':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 'boolean';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'number':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 'number';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'string':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 'string';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'symbol':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 'symbol';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>default:</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// typeof null is 'object'</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (x === null) return 'null';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - This is here because a Symbol polyfill will have a typeof `object`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ('Symbol' in this &amp;&amp; x instanceof this.Symbol) return 'symbol';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 'object';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.GetPrototypeFromConstructor</span></p>
<p class="p1"><span class="s1">/* global Get, Type */</span></p>
<p class="p1"><span class="s1">// 9.1.14. GetPrototypeFromConstructor ( constructor, intrinsicDefaultProto )</span></p>
<p class="p1"><span class="s1">function GetPrototypeFromConstructor(constructor, intrinsicDefaultProto) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: intrinsicDefaultProto is a String value that is this specification's name of an intrinsic object. The corresponding object must be an intrinsic that is intended to be used as the [[Prototype]] value of an object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: IsCallable(constructor) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let proto be ? Get(constructor, "prototype").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var proto = Get(constructor, "prototype");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If Type(proto) is not Object, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(proto) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let realm be ? GetFunctionRealm(constructor).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Set proto to realm's intrinsic object named intrinsicDefaultProto.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>proto = intrinsicDefaultProto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return proto.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return proto;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IsConstructor</span></p>
<p class="p1"><span class="s1">/* global Type */</span></p>
<p class="p1"><span class="s1">// 7.2.4. IsConstructor ( argument )</span></p>
<p class="p1"><span class="s1">function IsConstructor(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(argument) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(argument) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If argument has a [[Construct]] internal method, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return false.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - `new argument` is the only way<span class="Apple-converted-space">  </span>to truly test if a function is a constructor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// We choose to not use`new argument` because the argument could have side effects when called.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Instead we check to see if the argument is a function and if it has a prototype.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Arrow functions do not have a [[Construct]] internal method, nor do they have a prototype.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return typeof argument === 'function' &amp;&amp; !!argument.prototype;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IsRegExp</span></p>
<p class="p1"><span class="s1">/* global Type, Get, ToBoolean */</span></p>
<p class="p1"><span class="s1">// 7.2.8. IsRegExp ( argument )</span></p>
<p class="p1"><span class="s1">function IsRegExp(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(argument) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(argument) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let matcher be ? Get(argument, @@match).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var matcher = 'Symbol' in this &amp;&amp; 'match' in this.Symbol ? Get(argument, this.Symbol.match) : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If matcher is not undefined, return ToBoolean(matcher).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (matcher !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return ToBoolean(matcher);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If argument has a [[RegExpMatcher]] internal slot, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var lastIndex = argument.lastIndex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>argument.lastIndex = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>RegExp.prototype.exec.call(argument);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>argument.lastIndex = lastIndex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IteratorClose</span></p>
<p class="p1"><span class="s1">/* global GetMethod, Type, Call */</span></p>
<p class="p1"><span class="s1">// 7.4.6. IteratorClose ( iteratorRecord, completion )</span></p>
<p class="p1"><span class="s1">function IteratorClose(iteratorRecord, completion) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(iteratorRecord.[[Iterator]]) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(iteratorRecord['[[Iterator]]']) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error(Object.prototype.toString.call(iteratorRecord['[[Iterator]]']) + 'is not an Object.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: completion is a Completion Record.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - Ignoring this step as there is no way to check if something is a Completion Record in userland JavaScript.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let iterator be iteratorRecord.[[Iterator]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var iterator = iteratorRecord['[[Iterator]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let return be ? GetMethod(iterator, "return").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We name it<span class="Apple-converted-space">  </span>returnMethod because return is a keyword and can not be used as an identifier (E.G. variable name, function name etc).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var returnMethod = GetMethod(iterator, "return");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If return is undefined, return Completion(completion).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (returnMethod === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return completion;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let innerResult be Call(return, iterator, « »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var innerResult = Call(returnMethod, iterator);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var innerException = error;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If completion.[[Type]] is throw, return Completion(completion).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (completion) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return completion;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. If innerResult.[[Type]] is throw, return Completion(innerResult).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (innerException) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw innerException;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. If Type(innerResult.[[Value]]) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(innerResult) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Iterator's return method returned a non-object.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Return Completion(completion).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return completion;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IteratorComplete</span></p>
<p class="p1"><span class="s1">/* global Type, ToBoolean, Get */</span></p>
<p class="p1"><span class="s1">// 7.4.3 IteratorComplete ( iterResult )</span></p>
<p class="p1"><span class="s1">function IteratorComplete(iterResult) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(iterResult) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(iterResult) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error(Object.prototype.toString.call(iterResult) + 'is not an Object.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Return ToBoolean(? Get(iterResult, "done")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return ToBoolean(Get(iterResult, "done"));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IteratorNext</span></p>
<p class="p1"><span class="s1">/* global Call, Type */</span></p>
<p class="p1"><span class="s1">// 7.4.2. IteratorNext ( iteratorRecord [ , value ] )</span></p>
<p class="p1"><span class="s1">function IteratorNext(iteratorRecord /* [, value] */) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If value is not present, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (arguments.length &lt; 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let result be ? Call(iteratorRecord.[[NextMethod]], iteratorRecord.[[Iterator]], « »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var result = Call(iteratorRecord['[[NextMethod]]'], iteratorRecord['[[Iterator]]']);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let result be ? Call(iteratorRecord.[[NextMethod]], iteratorRecord.[[Iterator]], « value »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result = Call(iteratorRecord['[[NextMethod]]'], iteratorRecord['[[Iterator]]'], [arguments[1]]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If Type(result) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(result) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('bad iterator');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return result;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IteratorStep</span></p>
<p class="p1"><span class="s1">/* global IteratorNext, IteratorComplete */</span></p>
<p class="p1"><span class="s1">// 7.4.5. IteratorStep ( iteratorRecord )</span></p>
<p class="p1"><span class="s1">function IteratorStep(iteratorRecord) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let result be ? IteratorNext(iteratorRecord).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var result = IteratorNext(iteratorRecord);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let done be ? IteratorComplete(result).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var done = IteratorComplete(result);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If done is true, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (done === true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return result;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.IteratorValue</span></p>
<p class="p1"><span class="s1">/* global Type, Get */</span></p>
<p class="p1"><span class="s1">// 7.4.4 IteratorValue ( iterResult )</span></p>
<p class="p1"><span class="s1">function IteratorValue(iterResult) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Assert: Type(iterResult) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(iterResult) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error(Object.prototype.toString.call(iterResult) + 'is not an Object.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Return ? Get(iterResult, "value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Get(iterResult, "value");</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.OrdinaryToPrimitive</span></p>
<p class="p1"><span class="s1">/* global Get, IsCallable, Call, Type */</span></p>
<p class="p1"><span class="s1">// 7.1.1.1. OrdinaryToPrimitive ( O, hint )</span></p>
<p class="p1"><span class="s1">function OrdinaryToPrimitive(O, hint) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: Type(hint) is String and its value is either "string" or "number".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If hint is "string", then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (hint === 'string') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let methodNames be « "toString", "valueOf" ».</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var methodNames = ['toString', 'valueOf'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let methodNames be « "valueOf", "toString" ».</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>methodNames = ['valueOf', 'toString'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. For each name in methodNames in List order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; methodNames.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var name = methodNames[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let method be ? Get(O, name).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var method = Get(O, name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If IsCallable(method) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsCallable(method)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let result be ? Call(method, O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var result = Call(method, O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. If Type(result) is not Object, return result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(result) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>throw new TypeError('Cannot convert to primitive.');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.SameValue</span></p>
<p class="p1"><span class="s1">/* global Type, SameValueNonNumber */</span></p>
<p class="p1"><span class="s1">// 7.2.10. SameValue ( x, y )</span></p>
<p class="p1"><span class="s1">function SameValue(x, y) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(x) is different from Type(y), return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(x) !== Type(y)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If Type(x) is Number, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(x) === 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If x is NaN and y is NaN, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (isNaN(x) &amp;&amp; isNaN(y)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - 0 === -0 is true, but they are not the same value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If x is +0 and y is -0, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If x is -0 and y is +0, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; y === 0 &amp;&amp; 1/x !== 1/y) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If x is the same Number value as y, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (x === y) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return SameValueNonNumber(x, y).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return SameValueNonNumber(x, y);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.SameValueZero</span></p>
<p class="p1"><span class="s1">/* global Type, SameValueNonNumber */</span></p>
<p class="p1"><span class="s1">// 7.2.11. SameValueZero ( x, y )</span></p>
<p class="p1"><span class="s1">function SameValueZero (x, y) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(x) is different from Type(y), return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(x) !== Type(y)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If Type(x) is Number, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(x) === 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If x is NaN and y is NaN, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (isNaN(x) &amp;&amp; isNaN(y)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If x is +0 and y is -0, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (1/x === Infinity &amp;&amp; 1/y === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If x is -0 and y is +0, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (1/x === -Infinity &amp;&amp; 1/y === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If x is the same Number value as y, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (x === y) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return SameValueNonNumber(x, y).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return SameValueNonNumber(x, y);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.SpeciesConstructor</span></p>
<p class="p1"><span class="s1">/* global Get, Type, IsConstructor */</span></p>
<p class="p1"><span class="s1">// 7.3.20 SpeciesConstructor(O, defaultConstructor)</span></p>
<p class="p1"><span class="s1">function SpeciesConstructor (O, defaultConstructor) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.1 Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.2 Let C be ? Get(O, "constructor").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var C = Get(O, "constructor");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.3 If C is undefined, return defaultConstructor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (C === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return defaultConstructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.4 If Type(C) is not Object, throw a TypeError exception</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(C) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('O.constructor is not an Object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.5 Let S be ? Get(C, @@species).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = typeof this.Symbol === 'function' &amp;&amp; typeof this.Symbol.species === 'symbol' ? C[this.Symbol.species] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.6 If S is either undefined or null, return defaultConstructor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (S === undefined || S === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return defaultConstructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.7 If IsConstructor(S) is true, return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsConstructor(S)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7.3.20.8 Throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>throw new TypeError('No constructor found');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToPrimitive</span></p>
<p class="p1"><span class="s1">/* global Type, GetMethod, Call, OrdinaryToPrimitive */</span></p>
<p class="p1"><span class="s1">// 7.1.1. ToPrimitive ( input [ , PreferredType ] )</span></p>
<p class="p1"><span class="s1">function ToPrimitive(input /* [, PreferredType] */) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var PreferredType = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: input is an ECMAScript language value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If Type(input) is Object, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(input) === 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If PreferredType is not present, let hint be "default".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arguments.length &lt; 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var hint = 'default';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Else if PreferredType is hint String, let hint be "string".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (PreferredType === String) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>hint = 'string';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Else PreferredType is hint Number, let hint be "number".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (PreferredType === Number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>hint = 'number';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Let exoticToPrim be ? GetMethod(input, @@toPrimitive).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var exoticToPrim = typeof this.Symbol === 'function' &amp;&amp; typeof this.Symbol.toPrimitive === 'symbol' ? GetMethod(input, this.Symbol.toPrimitive) : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. If exoticToPrim is not undefined, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (exoticToPrim !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let result be ? Call(exoticToPrim, input, « hint »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var result = Call(exoticToPrim, input, [hint]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. If Type(result) is not Object, return result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(result) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Cannot convert exotic object to primitive.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// f. If hint is "default", set hint to "number".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (hint === 'default') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>hint = 'number';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// g. Return ? OrdinaryToPrimitive(input, hint).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return OrdinaryToPrimitive(input, hint);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return input</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return input;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ToString</span></p>
<p class="p1"><span class="s1">/* global Type, ToPrimitive */</span></p>
<p class="p1"><span class="s1">// 7.1.12. ToString ( argument )</span></p>
<p class="p1"><span class="s1">// The abstract operation ToString converts argument to a value of type String according to Table 11:</span></p>
<p class="p1"><span class="s1">// Table 11: ToString Conversions</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Argument Type | Result <span class="Apple-converted-space">                                                </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Undefined <span class="Apple-converted-space">    </span>| Return "undefined".<span class="Apple-converted-space">                                    </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Null<span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>| Return "null". <span class="Apple-converted-space">                                        </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Boolean <span class="Apple-converted-space">      </span>| If argument is true, return "true".<span class="Apple-converted-space">                    </span>|</span></p>
<p class="p1"><span class="s1">| <span class="Apple-converted-space">              </span>| If argument is false, return "false".<span class="Apple-converted-space">                  </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Number<span class="Apple-converted-space">        </span>| Return NumberToString(argument). <span class="Apple-converted-space">                      </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| String<span class="Apple-converted-space">        </span>| Return argument. <span class="Apple-converted-space">                                      </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Symbol<span class="Apple-converted-space">        </span>| Throw a TypeError exception. <span class="Apple-converted-space">                          </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">| Object<span class="Apple-converted-space">        </span>| Apply the following steps: <span class="Apple-converted-space">                            </span>|</span></p>
<p class="p1"><span class="s1">| <span class="Apple-converted-space">              </span>| Let primValue be ? ToPrimitive(argument, hint String). |</span></p>
<p class="p1"><span class="s1">| <span class="Apple-converted-space">              </span>| Return ? ToString(primValue).<span class="Apple-converted-space">                          </span>|</span></p>
<p class="p1"><span class="s1">|---------------|--------------------------------------------------------|</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">function ToString(argument) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>switch(Type(argument)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'symbol':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Cannot convert a Symbol value to a string');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>case 'object':</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var primValue = ToPrimitive(argument, 'string');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return ToString(primValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>default:</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return String(argument);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.UTF16Decode</span></p>
<p class="p1"><span class="s1">// 10.1.2. Static Semantics: UTF16Decode( lead, trail )</span></p>
<p class="p1"><span class="s1">function UTF16Decode(lead, trail) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: 0xD800 ≤ lead ≤ 0xDBFF and 0xDC00 ≤ trail ≤ 0xDFFF.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let cp be (lead - 0xD800) × 0x400 + (trail - 0xDC00) + 0x10000.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var cp = (lead - 0xD800) * 0x400 + (trail - 0xDC00) + 0x10000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return the code point cp.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return cp;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.UTF16Encoding</span></p>
<p class="p1"><span class="s1">// 10.1.1. Static Semantics: UTF16Encoding ( cp )</span></p>
<p class="p1"><span class="s1">function UTF16Encoding(cp) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: 0 ≤ cp ≤ 0x10FFFF.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If cp ≤ 0xFFFF, return cp.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (cp &lt;= 0xFFFF) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return cp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let cu1 be floor((cp - 0x10000) / 0x400) + 0xD800.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var cu1 = Math.floor((cp - 0x10000) / 0x400) + 0xD800;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let cu2 be ((cp - 0x10000) modulo 0x400) + 0xDC00.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var cu2 = ((cp - 0x10000) % 0x400) + 0xDC00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Return the code unit sequence consisting of cu1 followed by cu2.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return [cu1, cu2];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _TypedArray</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>Copyright (c) 2010, Linden Research, Inc.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>Copyright (c) 2014, Joshua Bell</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>Permission is hereby granted, free of charge, to any person obtaining a copy</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>of this software and associated documentation files (the "Software"), to deal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>in the Software without restriction, including without limitation the rights</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>copies of the Software, and to permit persons to whom the Software is</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>furnished to do so, subject to the following conditions:</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>The above copyright notice and this permission notice shall be included in</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>all copies or substantial portions of the Software.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>THE SOFTWARE.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>$/LicenseInfo$</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Original can be found at:</span></p>
<p class="p1"><span class="s1">// <span class="Apple-converted-space">  </span>https://bitbucket.org/lindenlab/llsd</span></p>
<p class="p1"><span class="s1">// Modifications by Joshua Bell inexorabletash@gmail.com</span></p>
<p class="p1"><span class="s1">// <span class="Apple-converted-space">  </span>https://github.com/inexorabletash/polyfill</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// ES3/ES5 implementation of the Krhonos Typed Array Specification</span></p>
<p class="p1"><span class="s1">// <span class="Apple-converted-space">  </span>Ref: http://www.khronos.org/registry/typedarray/specs/latest/</span></p>
<p class="p1"><span class="s1">// <span class="Apple-converted-space">  </span>Date: 2011-02-01</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// Variations:</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">  </span>* Allows typed_array.get/set() as alias for subscripts (typed_array[])</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">  </span>* Gradually migrating structure from Khronos spec to ES2015 spec</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// Caveats:</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">  </span>* Beyond 10000 or so entries, polyfilled array accessors (ta[0],</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">    </span>etc) become memory-prohibitive, so array creation will fail. Set</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">    </span>self.TYPED_ARRAY_POLYFILL_NO_ARRAY_ACCESSORS=true to disable</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">    </span>creation of accessors. Your code will need to use the</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">    </span>non-standard get()/set() instead, and will need to add those to</span></p>
<p class="p1"><span class="s1">//<span class="Apple-converted-space">    </span>native arrays for interop.</span></p>
<p class="p1"><span class="s1">(function(global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var undefined = (void 0); // Paranoia</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Beyond this value, index getters/setters (i.e. array[0], array[1]) are so slow to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// create, and consume so much memory, that the browser appears frozen.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var MAX_ARRAY_LENGTH = 1e5;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Approximations of internal ECMAScript conversion functions</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function Type(v) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>switch(typeof v) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>case 'undefined': return 'undefined';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>case 'boolean': return 'boolean';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>case 'number': return 'number';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>case 'string': return 'string';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>default: return v === null ? 'null' : 'object';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Class returns internal [[Class]] property, used to avoid cross-frame instanceof issues:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function Class(v) { return Object.prototype.toString.call(v).replace(/^\[object *|\]$/g, ''); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function IsCallable(o) { return typeof o === 'function'; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function ToObject(v) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (v === null || v === undefined) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return Object(v);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function ToInt32(v) { return v &gt;&gt; 0; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function ToUint32(v) { return v &gt;&gt;&gt; 0; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Snapshot intrinsics</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var LN2 = Math.LN2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>abs = Math.abs,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>floor = Math.floor,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>log = Math.log,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>max = Math.max,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>min = Math.min,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>pow = Math.pow,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>round = Math.round;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// emulate ES5 getter/setter API using legacy APIs</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// http://blogs.msdn.com/b/ie/archive/2010/09/07/transitioning-existing-code-to-the-es5-getter-setter-apis.aspx</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// (second clause tests for Object.defineProperty() in IE&lt;9 that only supports extending DOM prototypes, but</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// note that IE&lt;9 does not support __defineGetter__ or __defineSetter__ so it just renders the method harmless)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>(function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var orig = Object.defineProperty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var dom_only = !(function(){try{return Object.defineProperty({},'x',{});}catch(_){return false;}}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!orig || dom_only) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty = function (o, prop, desc) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// In IE8 try built-in implementation for defining properties on DOM prototypes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (orig)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>try { return orig(o, prop, desc); } catch (_) {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (o !== Object(o))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>throw TypeError('Object.defineProperty called on non-object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Object.prototype.__defineGetter__ &amp;&amp; ('get' in desc))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.prototype.__defineGetter__.call(o, prop, desc.get);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Object.prototype.__defineSetter__ &amp;&amp; ('set' in desc))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.prototype.__defineSetter__.call(o, prop, desc.set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if ('value' in desc)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>o[prop] = desc.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ES5: Make obj[index] an alias for obj._getter(index)/obj._setter(index, value)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// for index in 0 ... obj.length</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function makeArrayAccessors(obj) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if ('TYPED_ARRAY_POLYFILL_NO_ARRAY_ACCESSORS' in global)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (obj.length &gt; MAX_ARRAY_LENGTH) throw RangeError('Array too large for polyfill');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function makeArrayAccessor(index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(obj, index, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>'get': function() { return obj._getter(index); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>'set': function(v) { obj._setter(index, v); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>enumerable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>configurable: false</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (i = 0; i &lt; obj.length; i += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>makeArrayAccessor(i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Internal conversion functions:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//<span class="Apple-converted-space">    </span>pack&lt;Type&gt;() <span class="Apple-converted-space">  </span>- take a number (interpreted as Type), output a byte array</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//<span class="Apple-converted-space">    </span>unpack&lt;Type&gt;() - take a byte array, output a Type-like number</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function as_signed(value, bits) { var s = 32 - bits; return (value &lt;&lt; s) &gt;&gt; s; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function as_unsigned(value, bits) { var s = 32 - bits; return (value &lt;&lt; s) &gt;&gt;&gt; s; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packI8(n) { return [n &amp; 0xff]; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackI8(bytes) { return as_signed(bytes[0], 8); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packU8(n) { return [n &amp; 0xff]; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackU8(bytes) { return as_unsigned(bytes[0], 8); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packU8Clamped(n) { n = round(Number(n)); return [n &lt; 0 ? 0 : n &gt; 0xff ? 0xff : n &amp; 0xff]; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packI16(n) { return [n &amp; 0xff, (n &gt;&gt; 8) &amp; 0xff]; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackI16(bytes) { return as_signed(bytes[1] &lt;&lt; 8 | bytes[0], 16); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packU16(n) { return [n &amp; 0xff, (n &gt;&gt; 8) &amp; 0xff]; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackU16(bytes) { return as_unsigned(bytes[1] &lt;&lt; 8 | bytes[0], 16); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packI32(n) { return [n &amp; 0xff, (n &gt;&gt; 8) &amp; 0xff, (n &gt;&gt; 16) &amp; 0xff, (n &gt;&gt; 24) &amp; 0xff]; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackI32(bytes) { return as_signed(bytes[3] &lt;&lt; 24 | bytes[2] &lt;&lt; 16 | bytes[1] &lt;&lt; 8 | bytes[0], 32); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packU32(n) { return [n &amp; 0xff, (n &gt;&gt; 8) &amp; 0xff, (n &gt;&gt; 16) &amp; 0xff, (n &gt;&gt; 24) &amp; 0xff]; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackU32(bytes) { return as_unsigned(bytes[3] &lt;&lt; 24 | bytes[2] &lt;&lt; 16 | bytes[1] &lt;&lt; 8 | bytes[0], 32); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packIEEE754(v, ebits, fbits) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var bias = (1 &lt;&lt; (ebits - 1)) - 1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function roundToEven(n) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var w = floor(n), f = n - w;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (f &lt; 0.5)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return w;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (f &gt; 0.5)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return w + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return w % 2 ? w + 1 : w;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Compute sign, exponent, fraction</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var s, e, f;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (v !== v) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// NaN</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// http://dev.w3.org/2006/webapi/WebIDL/#es-type-mapping</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>e = (1 &lt;&lt; ebits) - 1; f = pow(2, fbits - 1); s = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (v === Infinity || v === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>e = (1 &lt;&lt; ebits) - 1; f = 0; s = (v &lt; 0) ? 1 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (v === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>e = 0; f = 0; s = (1 / v === -Infinity) ? 1 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>s = v &lt; 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>v = abs(v);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (v &gt;= pow(2, 1 - bias)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Normalized</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>e = min(floor(log(v) / LN2), 1023);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var significand = v / pow(2, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (significand &lt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>e -= 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>significand *= 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (significand &gt;= 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>e += 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>significand /= 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var d = pow(2, fbits);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>f = roundToEven(significand * d) - d;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>e += bias;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (f / d &gt;= 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>e += 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>f = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (e &gt; 2 * bias) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Overflow</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>e = (1 &lt;&lt; ebits) - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>f = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Denormalized</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>e = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>f = roundToEven(v / pow(2, 1 - bias - fbits));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Pack sign, exponent, fraction</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var bits = [], i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (i = fbits; i; i -= 1) { bits.push(f % 2 ? 1 : 0); f = floor(f / 2); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (i = ebits; i; i -= 1) { bits.push(e % 2 ? 1 : 0); e = floor(e / 2); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bits.push(s ? 1 : 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bits.reverse();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var str = bits.join('');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Bits to bytes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var bytes = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>while (str.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>bytes.unshift(parseInt(str.substring(0, 8), 2));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>str = str.substring(8);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return bytes;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackIEEE754(bytes, ebits, fbits) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Bytes to bits</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var bits = [], i, j, b, str,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>bias, s, e, f;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (i = 0; i &lt; bytes.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b = bytes[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (j = 8; j; j -= 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>bits.push(b % 2 ? 1 : 0); b = b &gt;&gt; 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bits.reverse();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>str = bits.join('');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Unpack sign, exponent, fraction</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bias = (1 &lt;&lt; (ebits - 1)) - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>s = parseInt(str.substring(0, 1), 2) ? -1 : 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>e = parseInt(str.substring(1, 1 + ebits), 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>f = parseInt(str.substring(1 + ebits), 2);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Produce number</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (e === (1 &lt;&lt; ebits) - 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return f !== 0 ? NaN : s * Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (e &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Normalized</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return s * pow(2, e - bias) * (1 + f / pow(2, fbits));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (f !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Denormalized</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return s * pow(2, -(bias - 1)) * (f / pow(2, fbits));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return s &lt; 0 ? -0 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackF64(b) { return unpackIEEE754(b, 11, 52); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packF64(v) { return packIEEE754(v, 11, 52); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function unpackF32(b) { return unpackIEEE754(b, 8, 23); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function packF32(v) { return packIEEE754(v, 8, 23); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// 3 The ArrayBuffer Type</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>(function() {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function ArrayBuffer(length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>length = ToInt32(length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (length &lt; 0) throw RangeError('ArrayBuffer size is not a small enough positive integer.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(this, 'byteLength', {value: length});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(this, '_bytes', {value: Array(length)});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; length; i += 1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._bytes[i] = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.ArrayBuffer = global.ArrayBuffer || ArrayBuffer;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 5 The Typed Array View Types</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function $TypedArray$() {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// %TypedArray% ( length )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!arguments.length || typeof arguments[0] !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return (function(length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>length = ToInt32(length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (length &lt; 0) throw RangeError('length is not a small enough positive integer.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'length', {value: length});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteLength', {value: length * this.BYTES_PER_ELEMENT});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'buffer', {value: new ArrayBuffer(this.byteLength)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteOffset', {value: 0});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>}).apply(this, arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// %TypedArray% ( typedArray )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt;= 1 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Type(arguments[0]) === 'object' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>arguments[0] instanceof $TypedArray$) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return (function(typedArray){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (this.constructor !== typedArray.constructor) throw TypeError();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var byteLength = typedArray.length * this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'buffer', {value: new ArrayBuffer(byteLength)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteLength', {value: byteLength});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteOffset', {value: 0});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'length', {value: typedArray.length});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this.length; i += 1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this._setter(i, typedArray._getter(i));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}).apply(this, arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// %TypedArray% ( array )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt;= 1 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Type(arguments[0]) === 'object' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>!(arguments[0] instanceof $TypedArray$) &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>!(arguments[0] instanceof ArrayBuffer || Class(arguments[0]) === 'ArrayBuffer')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return (function(array) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var byteLength = array.length * this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'buffer', {value: new ArrayBuffer(byteLength)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteLength', {value: byteLength});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteOffset', {value: 0});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'length', {value: array.length});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this.length; i += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var s = array[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this._setter(i, Number(s));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}).apply(this, arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// %TypedArray% ( buffer, byteOffset=0, length=undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt;= 1 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Type(arguments[0]) === 'object' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>(arguments[0] instanceof ArrayBuffer || Class(arguments[0]) === 'ArrayBuffer')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return (function(buffer, byteOffset, length) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>byteOffset = ToUint32(byteOffset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (byteOffset &gt; buffer.byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>throw RangeError('byteOffset out of range');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// The given byteOffset must be a multiple of the element</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// size of the specific type, otherwise an exception is raised.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (byteOffset % this.BYTES_PER_ELEMENT)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>throw RangeError('buffer length minus the byteOffset is not a multiple of the element size.');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (length === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var byteLength = buffer.byteLength - byteOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (byteLength % this.BYTES_PER_ELEMENT)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>throw RangeError('length of buffer minus byteOffset not a multiple of the element size');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>length = byteLength / this.BYTES_PER_ELEMENT;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>length = ToUint32(length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>byteLength = length * this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if ((byteOffset + byteLength) &gt; buffer.byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>throw RangeError('byteOffset and length reference an area beyond the end of the buffer');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'buffer', {value: buffer});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteLength', {value: byteLength});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'byteOffset', {value: byteOffset});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperty(this, 'length', {value: length});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}).apply(this, arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// %TypedArray% ( all other argument combinations )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Properties of the %TypedArray Instrinsic Object</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.from ( source , mapfn=undefined, thisArg=undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$, 'from', {value: function(iterable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return new this(iterable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.of ( ...items )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$, 'of', {value: function(/*...items*/) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return new this(arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var $TypedArrayPrototype$ = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>$TypedArray$.prototype = $TypedArrayPrototype$;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// WebIDL: getter type (unsigned long index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, '_getter', {value: function(index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &lt; 1) throw SyntaxError('Not enough arguments');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>index = ToUint32(index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (index &gt;= this.length)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return undefined;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var bytes = [], i, o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (i = 0, o = this.byteOffset + index * this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">           </span>i &lt; this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">           </span>i += 1, o += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>bytes.push(this.buffer._bytes[o]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return this._unpack(bytes);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// NONSTANDARD: convenience alias for getter: type get(unsigned long index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'get', {value: $TypedArray$.prototype._getter});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// WebIDL: setter void (unsigned long index, type value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, '_setter', {value: function(index, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &lt; 2) throw SyntaxError('Not enough arguments');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>index = ToUint32(index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (index &gt;= this.length)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var bytes = this._pack(value), i, o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (i = 0, o = this.byteOffset + index * this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">           </span>i &lt; this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">           </span>i += 1, o += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.buffer._bytes[o] = bytes[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get %TypedArray%.prototype.buffer</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get %TypedArray%.prototype.byteLength</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get %TypedArray%.prototype.byteOffset</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// -- applied directly to the object in the constructor</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'constructor', {value: $TypedArray$});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.copyWithin (target, start, end = this.length )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'copyWithin', {value: function(target, start) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var end = arguments[2];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var o = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var lenVal = o.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(lenVal);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>len = max(len, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeTarget = ToInt32(target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var to;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (relativeTarget &lt; 0)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>to = max(len + relativeTarget, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>to = min(relativeTarget, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeStart = ToInt32(start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var from;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (relativeStart &lt; 0)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>from = max(len + relativeStart, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>from = min(relativeStart, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeEnd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (end === undefined)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>relativeEnd = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>relativeEnd = ToInt32(end);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var final;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (relativeEnd &lt; 0)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>final = max(len + relativeEnd, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>final = min(relativeEnd, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var count = min(final - from, len - to);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var direction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (from &lt; to &amp;&amp; to &lt; from + count) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>direction = -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>from = from + count - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>to = to + count - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>direction = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (count &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o._setter(to, o._getter(from));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>from = from + direction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>to = to + direction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>count = count - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.entries ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// -- defined in es6.js to shim browsers w/ native TypedArrays</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.every ( callbackfn, thisArg = undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'every', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var thisArg = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!callbackfn.call(thisArg, t._getter(i), i, t))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.fill (value, start = 0, end = this.length )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'fill', {value: function(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var start = arguments[1],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>end = arguments[2];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var o = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var lenVal = o.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(lenVal);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>len = max(len, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeStart = ToInt32(start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (relativeStart &lt; 0)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>k = max((len + relativeStart), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>k = min(relativeStart, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeEnd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (end === undefined)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>relativeEnd = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>relativeEnd = ToInt32(end);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var final;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (relativeEnd &lt; 0)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>final = max((len + relativeEnd), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>final = min(relativeEnd, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (k &lt; final) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o._setter(k, value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>k += 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.filter ( callbackfn, thisArg = undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'filter', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var res = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var thisp = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var val = t._getter(i); // in case fun mutates this</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (callbackfn.call(thisp, val, i, t))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>res.push(val);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return new this.constructor(res);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.find (predicate, thisArg = undefined)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'find', {value: function(predicate) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var o = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var lenValue = o.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(lenValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(predicate)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var kValue = o._getter(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var testResult = predicate.call(t, kValue, k, o);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Boolean(testResult))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return kValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>++k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.findIndex ( predicate, thisArg = undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'findIndex', {value: function(predicate) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var o = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var lenValue = o.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(lenValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(predicate)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var kValue = o._getter(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var testResult = predicate.call(t, kValue, k, o);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Boolean(testResult))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>++k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.forEach ( callbackfn, thisArg = undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'forEach', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var thisp = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; i++)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>callbackfn.call(thisp, t._getter(i), i, t);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.indexOf (searchElement, fromIndex = 0 )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'indexOf', {value: function(searchElement) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (len === 0) return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var n = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>n = Number(arguments[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (n !== n) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>n = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else if (n !== 0 &amp;&amp; n !== (1 / 0) &amp;&amp; n !== -(1 / 0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>n = (n &gt; 0 || -1) * floor(abs(n));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (n &gt;= len) return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = n &gt;= 0 ? n : max(len - abs(n), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (; k &lt; len; k++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (t._getter(k) === searchElement) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.join ( separator )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'join', {value: function(separator) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var tmp = Array(len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tmp[i] = t._getter(i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return tmp.join(separator === undefined ? ',' : separator); // Hack for IE7</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.keys ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// -- defined in es6.js to shim browsers w/ native TypedArrays</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.lastIndexOf ( searchElement, fromIndex = this.length-1 )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'lastIndexOf', {value: function(searchElement) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (len === 0) return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var n = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>n = Number(arguments[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (n !== n) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>n = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else if (n !== 0 &amp;&amp; n !== (1 / 0) &amp;&amp; n !== -(1 / 0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>n = (n &gt; 0 || -1) * floor(abs(n));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = n &gt;= 0 ? min(n, len - 1) : len - abs(n);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (; k &gt;= 0; k--) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (t._getter(k) === searchElement)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get %TypedArray%.prototype.length</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// -- applied directly to the object in the constructor</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.map ( callbackfn, thisArg = undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'map', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var res = []; res.length = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var thisp = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; i++)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>res[i] = callbackfn.call(thisp, t._getter(i), i, t);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return new this.constructor(res);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.reduce ( callbackfn [, initialValue] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'reduce', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// no value to return if no initial value and an empty array</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (len === 0 &amp;&amp; arguments.length === 1) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var accumulator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt;= 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>accumulator = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>accumulator = t._getter(k++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>accumulator = callbackfn.call(undefined, accumulator, t._getter(k), k, t);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>k++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return accumulator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.reduceRight ( callbackfn [, initialValue] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'reduceRight', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// no value to return if no initial value, empty array</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (len === 0 &amp;&amp; arguments.length === 1) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = len - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var accumulator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &gt;= 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>accumulator = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>accumulator = t._getter(k--);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (k &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>accumulator = callbackfn.call(undefined, accumulator, t._getter(k), k, t);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>k--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return accumulator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.reverse ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'reverse', {value: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var half = floor(len / 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0, j = len - 1; i &lt; half; ++i, --j) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var tmp = t._getter(i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>t._setter(i, t._getter(j));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>t._setter(j, tmp);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return t;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.set(array, offset = 0 )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.set(typedArray, offset = 0 )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// WebIDL: void set(TypedArray array, optional unsigned long offset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// WebIDL: void set(sequence&lt;type&gt; array, optional unsigned long offset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'set', {value: function(index, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &lt; 1) throw SyntaxError('Not enough arguments');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var array, sequence, offset, len,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>i, s, d,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>byteOffset, byteLength, tmp;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (typeof arguments[0] === 'object' &amp;&amp; arguments[0].constructor === this.constructor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// void set(TypedArray array, optional unsigned long offset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>array = arguments[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>offset = ToUint32(arguments[1]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (offset + array.length &gt; this.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>throw RangeError('Offset plus length of array is out of range');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteOffset = this.byteOffset + offset * this.BYTES_PER_ELEMENT;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteLength = array.length * this.BYTES_PER_ELEMENT;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (array.buffer === this.buffer) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>tmp = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (i = 0, s = array.byteOffset; i &lt; byteLength; i += 1, s += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>tmp[i] = array.buffer._bytes[s];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (i = 0, d = byteOffset; i &lt; byteLength; i += 1, d += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this.buffer._bytes[d] = tmp[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (i = 0, s = array.byteOffset, d = byteOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">               </span>i &lt; byteLength; i += 1, s += 1, d += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this.buffer._bytes[d] = array.buffer._bytes[s];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (typeof arguments[0] === 'object' &amp;&amp; typeof arguments[0].length !== 'undefined') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// void set(sequence&lt;type&gt; array, optional unsigned long offset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>sequence = arguments[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>len = ToUint32(sequence.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>offset = ToUint32(arguments[1]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (offset + len &gt; this.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>throw RangeError('Offset plus length of array is out of range');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (i = 0; i &lt; len; i += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>s = sequence[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._setter(offset + i, Number(s));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throw TypeError('Unexpected argument type(s)');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.slice ( start, end )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'slice', {value: function(start, end) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var o = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var lenVal = o.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(lenVal);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeStart = ToInt32(start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var k = (relativeStart &lt; 0) ? max(len + relativeStart, 0) : min(relativeStart, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var relativeEnd = (end === undefined) ? len : ToInt32(end);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var final = (relativeEnd &lt; 0) ? max(len + relativeEnd, 0) : min(relativeEnd, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var count = final - k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var c = o.constructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var a = new c(count);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var n = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>while (k &lt; final) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var kValue = o._getter(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>a._setter(n, kValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>++k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>++n;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.some ( callbackfn, thisArg = undefined )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'some', {value: function(callbackfn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!IsCallable(callbackfn)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var thisp = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (callbackfn.call(thisp, t._getter(i), i, t)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.sort ( comparefn )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'sort', {value: function(comparefn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this === undefined || this === null) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var t = Object(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = ToUint32(t.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var tmp = Array(len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = 0; i &lt; len; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tmp[i] = t._getter(i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>function sortCompare(x, y) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (x !== x &amp;&amp; y !== y) return +0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (x !== x) return 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (y !== y) return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (comparefn !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return comparefn(x, y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (x &lt; y) return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (x &gt; y) return 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return +0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>tmp.sort(sortCompare);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (i = 0; i &lt; len; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>t._setter(i, tmp[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return t;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.subarray(begin = 0, end = this.length )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// WebIDL: TypedArray subarray(long begin, optional long end);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty($TypedArray$.prototype, 'subarray', {value: function(start, end) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>function clamp(v, min, max) { return v &lt; min ? min : v &gt; max ? max : v; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>start = ToInt32(start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>end = ToInt32(end);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &lt; 1) { start = 0; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (arguments.length &lt; 2) { end = this.length; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (start &lt; 0) { start = this.length + start; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (end &lt; 0) { end = this.length + end; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>start = clamp(start, 0, this.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>end = clamp(end, 0, this.length);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var len = end - start;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (len &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>len = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return new this.constructor(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.buffer, this.byteOffset + start * this.BYTES_PER_ELEMENT, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.toLocaleString ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.toString ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype.values ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// %TypedArray%.prototype [ @@iterator ] ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get %TypedArray%.prototype [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// -- defined in es6.js to shim browsers w/ native TypedArrays</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function makeTypedArray(elementSize, pack, unpack) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Each TypedArray type requires a distinct constructor instance with</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// identical logic, which this produces.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var TypedArray = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Object.defineProperty(this, 'constructor', {value: TypedArray});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>$TypedArray$.apply(this, arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>makeArrayAccessors(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if ('__proto__' in TypedArray) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>TypedArray.__proto__ = $TypedArray$;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>TypedArray.from = $TypedArray$.from;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>TypedArray.of = $TypedArray$.of;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>TypedArray.BYTES_PER_ELEMENT = elementSize;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var TypedArrayPrototype = function() {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>TypedArrayPrototype.prototype = $TypedArrayPrototype$;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>TypedArray.prototype = new TypedArrayPrototype();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(TypedArray.prototype, 'BYTES_PER_ELEMENT', {value: elementSize});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(TypedArray.prototype, '_pack', {value: pack});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(TypedArray.prototype, '_unpack', {value: unpack});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return TypedArray;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Int8Array = makeTypedArray(1, packI8, unpackI8);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Uint8Array = makeTypedArray(1, packU8, unpackU8);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Uint8ClampedArray = makeTypedArray(1, packU8Clamped, unpackU8);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Int16Array = makeTypedArray(2, packI16, unpackI16);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Uint16Array = makeTypedArray(2, packU16, unpackU16);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Int32Array = makeTypedArray(4, packI32, unpackI32);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Uint32Array = makeTypedArray(4, packU32, unpackU32);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Float32Array = makeTypedArray(4, packF32, unpackF32);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Float64Array = makeTypedArray(8, packF64, unpackF64);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Int8Array = global.Int8Array || Int8Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Uint8Array = global.Uint8Array || Uint8Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Uint8ClampedArray = global.Uint8ClampedArray || Uint8ClampedArray;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Int16Array = global.Int16Array || Int16Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Uint16Array = global.Uint16Array || Uint16Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Int32Array = global.Int32Array || Int32Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Uint32Array = global.Uint32Array || Uint32Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Float32Array = global.Float32Array || Float32Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.Float64Array = global.Float64Array || Float64Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// 6 The DataView View Type</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>(function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function r(array, index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return IsCallable(array.get) ? array.get(index) : array[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var IS_BIG_ENDIAN = (function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var u16array = new Uint16Array([0x1234]),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>u8array = new Uint8Array(u16array.buffer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return r(u8array, 0) === 0x12;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// DataView(buffer, byteOffset=0, byteLength=undefined)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// WebIDL: Constructor(ArrayBuffer buffer,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// <span class="Apple-converted-space">                    </span>optional unsigned long byteOffset,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// <span class="Apple-converted-space">                    </span>optional unsigned long byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function DataView(buffer, byteOffset, byteLength) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!(buffer instanceof ArrayBuffer || Class(buffer) === 'ArrayBuffer')) throw TypeError();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>byteOffset = ToUint32(byteOffset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (byteOffset &gt; buffer.byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throw RangeError('byteOffset out of range');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (byteLength === undefined)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteLength = buffer.byteLength - byteOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteLength = ToUint32(byteLength);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if ((byteOffset + byteLength) &gt; buffer.byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throw RangeError('byteOffset and length reference an area beyond the end of the buffer');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(this, 'buffer', {value: buffer});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(this, 'byteLength', {value: byteLength});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(this, 'byteOffset', {value: byteOffset});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get DataView.prototype.buffer</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get DataView.prototype.byteLength</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// get DataView.prototype.byteOffset</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// -- applied directly to instances by the constructor</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function makeGetter(arrayType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return function GetViewValue(byteOffset, littleEndian) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteOffset = ToUint32(byteOffset);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (byteOffset + arrayType.BYTES_PER_ELEMENT &gt; this.byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>throw RangeError('Array index out of range');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteOffset += this.byteOffset;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var uint8Array = new Uint8Array(this.buffer, byteOffset, arrayType.BYTES_PER_ELEMENT),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>bytes = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (var i = 0; i &lt; arrayType.BYTES_PER_ELEMENT; i += 1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>bytes.push(r(uint8Array, i));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Boolean(littleEndian) === Boolean(IS_BIG_ENDIAN))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>bytes.reverse();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return r(new arrayType(new Uint8Array(bytes).buffer), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getUint8', {value: makeGetter(Uint8Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getInt8', {value: makeGetter(Int8Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getUint16', {value: makeGetter(Uint16Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getInt16', {value: makeGetter(Int16Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getUint32', {value: makeGetter(Uint32Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getInt32', {value: makeGetter(Int32Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getFloat32', {value: makeGetter(Float32Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'getFloat64', {value: makeGetter(Float64Array)});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function makeSetter(arrayType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return function SetViewValue(byteOffset, value, littleEndian) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteOffset = ToUint32(byteOffset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (byteOffset + arrayType.BYTES_PER_ELEMENT &gt; this.byteLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>throw RangeError('Array index out of range');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Get bytes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var typeArray = new arrayType([value]),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>byteArray = new Uint8Array(typeArray.buffer),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>bytes = [], i, byteView;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (i = 0; i &lt; arrayType.BYTES_PER_ELEMENT; i += 1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>bytes.push(r(byteArray, i));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Flip if necessary</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Boolean(littleEndian) === Boolean(IS_BIG_ENDIAN))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>bytes.reverse();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Write them</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteView = new Uint8Array(this.buffer, byteOffset, arrayType.BYTES_PER_ELEMENT);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>byteView.set(bytes);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setUint8', {value: makeSetter(Uint8Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setInt8', {value: makeSetter(Int8Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setUint16', {value: makeSetter(Uint16Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setInt16', {value: makeSetter(Int16Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setUint32', {value: makeSetter(Uint32Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setInt32', {value: makeSetter(Int32Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setFloat32', {value: makeSetter(Float32Array)});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperty(DataView.prototype, 'setFloat64', {value: makeSetter(Float64Array)});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.DataView = global.DataView || DataView;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(self));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// atob</span></p>
<p class="p1"><span class="s1">;(function () {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var object =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>typeof exports != 'undefined' ? exports :</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>typeof self != 'undefined' ? self : // #8: web workers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>$.global; // #31: ExtendScript</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function InvalidCharacterError(message) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.message = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>InvalidCharacterError.prototype = new Error;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>InvalidCharacterError.prototype.name = 'InvalidCharacterError';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// encoder</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// [https://gist.github.com/999166] by [https://github.com/nignag]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>object.btoa || (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>object.btoa = function (input) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var str = String(input);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// initialize result and counter</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var block, charCode, idx = 0, map = chars, output = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// if the next str index does not exist:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// <span class="Apple-converted-space">  </span>change the mapping table to "="</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// <span class="Apple-converted-space">  </span>check if d has no fractional digits</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>str.charAt(idx | 0) || (map = '=', idx % 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// "8 - idx % 1 * 8" generates the sequence 2, 4, 6, 8</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>output += map.charAt(63 &amp; block &gt;&gt; 8 - idx % 1 * 8)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>charCode = str.charCodeAt(idx += 3/4);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (charCode &gt; 0xFF) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>block = block &lt;&lt; 8 | charCode;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return output;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// decoder</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// [https://gist.github.com/1020396] by [https://github.com/atk]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>object.atob || (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>object.atob = function (input) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var str = String(input).replace(/[=]+$/, ''); // #31: ExtendScript bad parse of /=</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (str.length % 4 == 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// initialize result and counters</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var bc = 0, bs, buffer, idx = 0, output = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// get next character</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>buffer = str.charAt(idx++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// character found in table? initialize bit storage and add its ascii value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>~buffer &amp;&amp; (bs = bc % 4 ? bs * 64 + buffer : buffer,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// and if not first of each 4 characters,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// convert the first 8 bits to one ascii character</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>bc++ % 4) ? output += String.fromCharCode(255 &amp; bs &gt;&gt; (-2 * bc &amp; 6)) : 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// try to find character in table (0-63, not found =&gt; -1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>buffer = chars.indexOf(buffer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return output;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// AudioContext</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>AudioContext = window.AudioContext = window.AudioContext || window.webkitAudioContext,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>AudioContextPrototype = AudioContext.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperties(AudioContextPrototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>createGain: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: AudioContextPrototype.createGain || AudioContextPrototype.createGainNode</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>createDelay: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: AudioContextPrototype.createDelay|| AudioContextPrototype.createDelayNode</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>createScriptProcessor: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: AudioContextPrototype.createScriptProcessor || AudioContextPrototype.createJavaScriptNode</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>audioContext = new AudioContext(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>oscillatorPrototype = audioContext.createOscillator().constructor.prototype,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>bufferSourcePrototype = audioContext.createBufferSource().constructor.prototype,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>gainGainConstructorPrototype = audioContext.createGain().gain.constructor.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperties(oscillatorPrototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setPeriodicWave: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: oscillatorPrototype.setPeriodicWave || oscillatorPrototype.setWaveTable</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>start: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: oscillatorPrototype.start || oscillatorPrototype.noteOn</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>stop: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: oscillatorPrototype.stop || oscillatorPrototype.noteOff</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperties(bufferSourcePrototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>start: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: bufferSourcePrototype.start || function start() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return arguments.length &gt; 1 ? bufferSourcePrototype.noteGrainOn.apply(this, arguments) : bufferSourcePrototype.noteOn.apply(this, arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>stop: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: bufferSourcePrototype.stop || bufferSourcePrototype.noteOff</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperties(gainGainConstructorPrototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setTargetAtTime: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: gainGainConstructorPrototype.setTargetAtTime || gainGainConstructorPrototype.setTargetValueAtTime</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">})();</span></p>
<p class="p1"><span class="s1">// Date.now</span></p>
<p class="p1"><span class="s1">Date.now = function now() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return new Date().getTime();</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Date.prototype.toISOString</span></p>
<p class="p1"><span class="s1">Date.prototype.toISOString = function toISOString() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var date = this;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function pad(str, len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var pad = "0000";</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>str = '' + str;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return pad.substr(0, len - str.length) + str;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var y = date.getUTCFullYear(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>m = pad(date.getUTCMonth() + 1, 2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>d = pad(date.getUTCDate(), 2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>h = pad(date.getUTCHours(), 2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>i = pad(date.getUTCMinutes(), 2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>s = pad(date.getUTCSeconds(), 2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>ms = pad(date.getUTCMilliseconds(), 3);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return y +'-'+ m +'-'+ d + 'T' + h +':'+ i +':'+ s +'.'+ ms +'Z';</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// document</span></p>
<p class="p1"><span class="s1">if ((typeof WorkerGlobalScope === "undefined") &amp;&amp; (typeof importScripts !== "function")) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (this.HTMLDocument) { // IE8</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// HTMLDocument is an extension of Document.<span class="Apple-converted-space">  </span>If the browser has HTMLDocument but not Document, the former will suffice as an alias for the latter.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.Document = this.HTMLDocument;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Create an empty function to act as the missing constructor for the document object, attach the document object as its prototype.<span class="Apple-converted-space">  </span>The function needs to be anonymous else it is hoisted and causes the feature detect to prematurely pass, preventing the assignments below being made.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.Document = this.HTMLDocument = document.constructor = (new Function('return function Document() {}')());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.Document.prototype = document;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// ~html5-elements</span></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1">* @preserve HTML5 Shiv 3.7.3 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">!function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x&lt;style&gt;"+b+"&lt;/style&gt;",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=t.elements;return"string"==typeof a?a.split(" "):a}function e(a,b){var c=t.elements;"string"!=typeof c&amp;&amp;(c=c.join(" ")),"string"!=typeof a&amp;&amp;(a=a.join(" ")),t.elements=c+" "+a,j(b)}function f(a){var b=s[a[q]];return b||(b={},r++,a[q]=r,s[r]=b),b}function g(a,c,d){if(c||(c=b),l)return c.createElement(a);d||(d=f(c));var e;return e=d.cache[a]?d.cache[a].cloneNode():p.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!e.canHaveChildren||o.test(a)||e.tagUrn?e:d.frag.appendChild(e)}function h(a,c){if(a||(a=b),l)return a.createDocumentFragment();c=c||f(a);for(var e=c.frag.cloneNode(),g=0,h=d(),i=h.length;i&gt;g;g++)e.createElement(h[g]);return e}function i(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return t.shivMethods?g(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&amp;&amp;("+d().join().replace(/[\w\-:]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(t,b.frag)}function j(a){a||(a=b);var d=f(a);return!t.shivCSS||k||d.hasCSS||(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),l||i(a,d),a}var k,l,m="3.7.3-pre",n=a.html5||{},o=/^&lt;|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,q="_html5shiv",r=0,s={};!function(){try{var a=b.createElement("a");a.innerHTML="&lt;xyz&gt;&lt;/xyz&gt;",k="hidden"in a,l=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(c){k=!0,l=!0}}();var t={elements:n.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:m,shivCSS:n.shivCSS!==!1,supportsUnknownElements:l,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:j,createElement:g,createDocumentFragment:h,addElements:e};a.html5=t,j(b),"object"==typeof module&amp;&amp;module.exports&amp;&amp;(module.exports=t)}("undefined"!=typeof window?window:this,document);</span></p>
<p class="p1"><span class="s1">// DocumentFragment</span></p>
<p class="p1"><span class="s1">this.DocumentFragment = document.createDocumentFragment().constructor;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// IE8</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (window.Element &amp;&amp; !window.HTMLElement) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>window.HTMLElement = window.Element;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// create Element constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>window.Element = window.HTMLElement = new Function('return function Element() {}')();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// generate sandboxed iframe</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var vbody = document.appendChild(document.createElement('body'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var frame = vbody.appendChild(document.createElement('iframe'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// use sandboxed iframe to replicate Element functionality</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var frameDocument = frame.contentWindow.document;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var prototype = Element.prototype = frameDocument.appendChild(frameDocument.createElement('*'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var cache = {};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// polyfill Element.prototype on an element</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var shiv = function (element, deep) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>childNodes = element.childNodes || [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = -1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>key, value, childNode;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (element.nodeType === 1 &amp;&amp; element.constructor !== Element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.constructor = Element;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (key in cache) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value = cache[key];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element[key] = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (childNode = deep &amp;&amp; childNodes[++index]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>shiv(childNode, deep);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return element;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var elements = document.getElementsByTagName('*');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nativeCreateElement = document.createElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var interval;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var loopLimit = 100;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>prototype.attachEvent('onpropertychange', function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>propertyName = event.propertyName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nonValue = !cache.hasOwnProperty(propertyName),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>newValue = prototype[propertyName],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>oldValue = cache[propertyName],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = -1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (element = elements[++index]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (element.nodeType === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (nonValue || element[propertyName] === oldValue) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element[propertyName] = newValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>cache[propertyName] = newValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>prototype.constructor = Element;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!prototype.hasAttribute) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;Element&gt;.hasAttribute</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>prototype.hasAttribute = function hasAttribute(name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this.getAttribute(name) !== null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Apply Element prototype to the pre-existing DOM as soon as the body element appears.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function bodyCheck() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(loopLimit--)) clearTimeout(interval);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (document.body &amp;&amp; !document.body.prototype &amp;&amp; /(complete|interactive)/.test(document.readyState)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>shiv(document, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (interval &amp;&amp; document.body.prototype) clearTimeout(interval);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return (!!document.body.prototype);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!bodyCheck()) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.onreadystatechange = bodyCheck;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>interval = setInterval(bodyCheck, 25);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Apply to any new elements created after load</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>document.createElement = function createElement(nodeName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var element = nativeCreateElement(String(nodeName).toLowerCase());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return shiv(element);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// remove sandboxed iframe</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>document.removeChild(vbody);</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _mutation</span></p>
<p class="p1"><span class="s1">var _mutation = (function () { // eslint-disable-line no-unused-vars</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function isNode(object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// DOM, Level2</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof Node === 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return object instanceof Node;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Older browsers, check if it looks like a Node instance)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return object &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>typeof object === "object" &amp;&amp;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>object.nodeName &amp;&amp;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>object.nodeType &gt;= 1 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>object.nodeType &lt;= 12;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// http://dom.spec.whatwg.org/#mutation-method-macro</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return function mutation(nodes) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (nodes.length === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return isNode(nodes[0]) ? nodes[0] : document.createTextNode(nodes[0] + '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var fragment = document.createDocumentFragment();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; nodes.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fragment.appendChild(isNode(nodes[i]) ? nodes[i] : document.createTextNode(nodes[i] + ''));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return fragment;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// document.querySelector</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>head = document.getElementsByTagName('head')[0];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function getElementsByQuery(node, selector, one) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>generator = document.createElement('div'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>id = 'qsa' + String(Math.random()).slice(3),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style, elements;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>generator.innerHTML = 'x&lt;style&gt;' + selector + '{qsa:' + id + ';}';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style = head.appendChild(generator.lastChild);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elements = getElements(node, selector, one, id);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>head.removeChild(style);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return one ? elements[0] : elements;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function getElements(node, selector, one, id) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>validNode = /1|9/.test(node.nodeType),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>childNodes = node.childNodes,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elements = [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = -1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>childNode;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (validNode &amp;&amp; node.currentStyle &amp;&amp; node.currentStyle.qsa === id) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (elements.push(node) &amp;&amp; one) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return elements;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (childNode = childNodes[++index]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elements = elements.concat(getElements(childNode, selector, one, id));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (one &amp;&amp; elements.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return elements;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return elements;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Document.prototype.querySelector = Element.prototype.querySelector = function querySelectorAll(selector) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return getElementsByQuery(this, selector, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Document.prototype.querySelectorAll = Element.prototype.querySelectorAll = function querySelectorAll(selector) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return getElementsByQuery(this, selector, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// DocumentFragment.prototype.append</span></p>
<p class="p1"><span class="s1">DocumentFragment.prototype.append = function append() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>this.appendChild(_mutation(arguments));</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// DocumentFragment.prototype.prepend</span></p>
<p class="p1"><span class="s1">DocumentFragment.prototype.prepend = function prepend() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>this.insertBefore(_mutation(arguments), this.firstChild);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.append</span></p>
<p class="p1"><span class="s1">Document.prototype.append = Element.prototype.append = function append() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>this.appendChild(_mutation(arguments));</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.cloneNode</span></p>
<p class="p1"><span class="s1">Element.prototype.cloneNode = (function(nativeFunc, undef) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return function(deep) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (deep === undef) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>deep = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var clone = nativeFunc.call(this, deep);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ('checked' in this) clone.checked = this.checked;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return clone;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}(Element.prototype.cloneNode));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.matches</span></p>
<p class="p1"><span class="s1">Element.prototype.matches = Element.prototype.webkitMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.mozMatchesSelector || function matches(selector) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var element = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var elements = (element.document || element.ownerDocument).querySelectorAll(selector);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var index = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (elements[index] &amp;&amp; elements[index] !== element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>++index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return !!elements[index];</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.closest</span></p>
<p class="p1"><span class="s1">Element.prototype.closest = function closest(selector) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var node = this;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (node) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (node.matches(selector)) return node;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else node = 'SVGElement' in window &amp;&amp; node instanceof SVGElement ? node.parentNode : node.parentElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return null;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.prepend</span></p>
<p class="p1"><span class="s1">Document.prototype.prepend = Element.prototype.prepend = function prepend() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>this.insertBefore(_mutation(arguments), this.firstChild);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.remove</span></p>
<p class="p1"><span class="s1">Document.prototype.remove = Element.prototype.remove = function remove() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (this.parentNode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.parentNode.removeChild(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Not all UAs support the Text constructor.<span class="Apple-converted-space">  </span>Polyfill on the Text constructor only where it exists</span></p>
<p class="p1"><span class="s1">// TODO: Add a polyfill for the Text constructor, and make it a dependency of this polyfill.</span></p>
<p class="p1"><span class="s1">if ("Text" in this) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Text.prototype.remove = Element.prototype.remove;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.replaceWith</span></p>
<p class="p1"><span class="s1">Document.prototype.replaceWith = Element.prototype.replaceWith = function replaceWith() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (this.parentNode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.parentNode.replaceChild(_mutation(arguments), this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Not all UAs support the Text constructor.<span class="Apple-converted-space">  </span>Polyfill on the Text constructor only where it exists</span></p>
<p class="p1"><span class="s1">// TODO: Add a polyfill for the Text constructor, and make it a dependency of this polyfill.</span></p>
<p class="p1"><span class="s1">if ('Text' in this) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Text.prototype.replaceWith = Element.prototype.replaceWith;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// EventSource</span></p>
<p class="p1"><span class="s1">/** @license</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* eventsource.js</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Available under MIT License (MIT)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* https://github.com/Yaffle/EventSource/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/*jslint indent: 2, vars: true, plusplus: true */</span></p>
<p class="p1"><span class="s1">/*global setTimeout, clearTimeout */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>"use strict";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var setTimeout = global.setTimeout;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var clearTimeout = global.clearTimeout;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var k = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function XHRTransport(xhr, onStartCallback, onProgressCallback, onFinishCallback, thisArg) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._internal = new XHRTransportInternal(xhr, onStartCallback, onProgressCallback, onFinishCallback, thisArg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransport.prototype.open = function (url, withCredentials) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._internal.open(url, withCredentials);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransport.prototype.cancel = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._internal.cancel();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function XHRTransportInternal(xhr, onStartCallback, onProgressCallback, onFinishCallback, thisArg) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onStartCallback = onStartCallback;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onProgressCallback = onProgressCallback;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onFinishCallback = onFinishCallback;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.thisArg = thisArg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr = xhr;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.state = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.charOffset = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.offset = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.url = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.withCredentials = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onStart = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var status = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var statusText = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var contentType = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!("contentType" in this.xhr)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>status = this.xhr.status;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>statusText = this.xhr.statusText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>contentType = this.xhr.getResponseHeader("Content-Type");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// https://bugs.webkit.org/show_bug.cgi?id=29121</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>status = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>statusText = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>contentType = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// FF &lt; 14, WebKit</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// https://bugs.webkit.org/show_bug.cgi?id=29658</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// https://bugs.webkit.org/show_bug.cgi?id=77854</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>status = 200;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>statusText = "OK";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>contentType = this.xhr.contentType;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (contentType == undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>contentType = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onStartCallback.call(this.thisArg, status, statusText, contentType);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onProgress = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onStart();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state === 2 || this.state === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var responseText = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>responseText = this.xhr.responseText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// IE 8 - 9 with XMLHttpRequest</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var chunkStart = this.charOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var length = responseText.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i = this.offset; i &lt; length; i += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var c = responseText.charCodeAt(i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (c === "\n".charCodeAt(0) || c === "\r".charCodeAt(0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this.charOffset = i + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.offset = length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var chunk = responseText.slice(chunkStart, this.charOffset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onProgressCallback.call(this.thisArg, chunk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onFinish = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// IE 8 fires "onload" without "onprogress</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onProgress();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this.timeout !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>clearTimeout(this.timeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onFinishCallback.call(this.thisArg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onReadyStateChange = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.xhr != undefined) { // Opera 12</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this.xhr.readyState === 4) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (this.xhr.status === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this.onFinish();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this.onFinish();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (this.xhr.readyState === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.onProgress();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (this.xhr.readyState === 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Opera 10.63 throws exception for `this.xhr.status`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// this.onStart();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onTimeout2 = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var tmp = (/^data\:([^,]*?)(base64)?,([\S]*)$/).exec(this.url);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var contentType = tmp[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var data = tmp[2] === "base64" ? global.atob(tmp[3]) : decodeURIComponent(tmp[3]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onStartCallback.call(this.thisArg, 200, "OK", contentType);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state === 2 || this.state === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onProgressCallback.call(this.thisArg, data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onFinishCallback.call(this.thisArg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onTimeout1 = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.open(this.url, this.withCredentials);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.onTimeout0 = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.onTimeout0();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}, 500);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.xhr.readyState === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onProgress();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.handleEvent = function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (event.type === "load") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onFinish();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (event.type === "error") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onFinish();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (event.type === "abort") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// improper fix to match Firefox behaviour, but it is better than just ignore abort</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// see https://bugzilla.mozilla.org/show_bug.cgi?id=768596</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// https://bugzilla.mozilla.org/show_bug.cgi?id=880200</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// https://code.google.com/p/chromium/issues/detail?id=153570</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// IE 8 fires "onload" without "onprogress</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onFinish();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (event.type === "progress") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onProgress();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (event.type === "readystatechange") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onReadyStateChange();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.open = function (url, withCredentials) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.cancel();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.url = url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.withCredentials = withCredentials;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.state = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.charOffset = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.offset = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var that = this;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var tmp = (/^data\:([^,]*?)(?:;base64)?,[\S]*$/).exec(url);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (tmp != undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>that.onTimeout2();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// loading indicator in Safari, Chrome &lt; 14</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// loading indicator in Firefox</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://bugzilla.mozilla.org/show_bug.cgi?id=736723</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if ((!("ontimeout" in this.xhr) || ("sendAsBinary" in this.xhr) || ("mozAnon" in this.xhr)) &amp;&amp; global.document != undefined &amp;&amp; global.document.readyState != undefined &amp;&amp; global.document.readyState !== "complete") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>that.onTimeout1();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}, 4);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// XDomainRequest#abort removes onprogress, onerror, onload</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.onload = function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.handleEvent({type: "load"});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.onerror = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.handleEvent({type: "error"});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.onabort = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.handleEvent({type: "abort"});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.onprogress = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.handleEvent({type: "progress"});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// IE 8-9 (XMLHTTPRequest)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Firefox 3.5 - 3.6 - ? &lt; 9.0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// onprogress is not fired sometimes or delayed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// see also #64</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.onreadystatechange = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.handleEvent({type: "readystatechange"});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.open("GET", url, true);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// withCredentials should be set after "open" for Safari and Chrome (&lt; 19 ?)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.withCredentials = withCredentials;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.xhr.responseType = "text";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if ("setRequestHeader" in this.xhr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Request header field Cache-Control is not allowed by Access-Control-Allow-Headers.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// "Cache-control: no-cache" are not honored in Chrome and Firefox</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// https://bugzilla.mozilla.org/show_bug.cgi?id=428916</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>//this.xhr.setRequestHeader("Cache-Control", "no-cache");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.setRequestHeader("Accept", "text/event-stream");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Request header field Last-Event-ID is not allowed by Access-Control-Allow-Headers.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>//this.xhr.setRequestHeader("Last-Event-ID", this.lastEventId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.send(undefined);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} catch (error1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Safari 5.1.7, Opera 12</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw error1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (("readyState" in this.xhr) &amp;&amp; global.opera != undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// workaround for Opera issue with "progress" events</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>that.onTimeout0();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>XHRTransportInternal.prototype.cancel = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.state !== 0 &amp;&amp; this.state !== 4) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.state = 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.onload = k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.onerror = k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.onabort = k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.onprogress = k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.onreadystatechange = k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.xhr.abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this.timeout !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>clearTimeout(this.timeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.onFinishCallback.call(this.thisArg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.state = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function Map() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._data = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>Map.prototype.get = function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return this._data[key + "~"];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>Map.prototype.set = function (key, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._data[key + "~"] = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>Map.prototype["delete"] = function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>delete this._data[key + "~"];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function EventTarget() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._listeners = new Map();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function throwError(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw e;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventTarget.prototype.dispatchEvent = function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>event.target = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var type = event.type.toString();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var listeners = this._listeners;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var typeListeners = listeners.get(type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeListeners == undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var length = typeListeners.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var listener = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (var i = 0; i &lt; length; i += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>listener = typeListeners[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof listener.handleEvent === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>listener.handleEvent(event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>listener.call(this, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throwError(e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventTarget.prototype.addEventListener = function (type, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>type = type.toString();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var listeners = this._listeners;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var typeListeners = listeners.get(type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeListeners == undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>typeListeners = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>listeners.set(type, typeListeners);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (var i = typeListeners.length; i &gt;= 0; i -= 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (typeListeners[i] === callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>typeListeners.push(callback);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventTarget.prototype.removeEventListener = function (type, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>type = type.toString();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var listeners = this._listeners;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var typeListeners = listeners.get(type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeListeners == undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var length = typeListeners.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var filtered = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (var i = 0; i &lt; length; i += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (typeListeners[i] !== callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>filtered.push(typeListeners[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (filtered.length === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>listeners["delete"](type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>listeners.set(type, filtered);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function Event(type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.type = type;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.target = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function MessageEvent(type, options) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Event.call(this, type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.data = options.data;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.lastEventId = options.lastEventId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>MessageEvent.prototype = Event.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var XHR = global.XMLHttpRequest;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var XDR = global.XDomainRequest;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var isCORSSupported = XHR != undefined &amp;&amp; (new XHR()).withCredentials != undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var Transport = isCORSSupported || (XHR != undefined &amp;&amp; XDR == undefined) ? XHR : XDR;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var WAITING = -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var CONNECTING = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var OPEN = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var CLOSED = 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var AFTER_CR = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var FIELD_START = 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var FIELD = 5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var VALUE_START = 6;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var VALUE = 7;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var contentTypeRegExp = /^text\/event\-stream;?(\s*charset\=utf\-8)?$/i;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var MINIMUM_DURATION = 1000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var MAXIMUM_DURATION = 18000000;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var getDuration = function (value, def) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var n = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (n !== n) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>n = def;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return (n &lt; MINIMUM_DURATION ? MINIMUM_DURATION : (n &gt; MAXIMUM_DURATION ? MAXIMUM_DURATION : n));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var fire = function (that, f, event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (typeof f === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>f.call(that, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throwError(e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function EventSource(url, options) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>EventTarget.call(this);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onopen = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onmessage = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onerror = undefined;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.url = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.readyState = CONNECTING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.withCredentials = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._internal = new EventSourceInternal(this, url, options);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function EventSourceInternal(es, url, options) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.url = url.toString();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.readyState = CONNECTING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.withCredentials = isCORSSupported &amp;&amp; options != undefined &amp;&amp; Boolean(options.withCredentials);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.es = es;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.initialRetry = getDuration(1000, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.heartbeatTimeout = getDuration(45000, 0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.lastEventId = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.retry = this.initialRetry;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.wasActivity = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var CurrentTransport = options != undefined &amp;&amp; options.Transport != undefined ? options.Transport : Transport;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var xhr = new CurrentTransport();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.transport = new XHRTransport(xhr, this.onStart, this.onProgress, this.onFinish, this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.currentState = WAITING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.dataBuffer = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.lastEventIdBuffer = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.eventTypeBuffer = "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.state = FIELD_START;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.fieldStart = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.valueStart = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.es.url = this.url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.es.readyState = this.readyState;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.es.withCredentials = this.withCredentials;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.onTimeout();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSourceInternal.prototype.onStart = function (status, statusText, contentType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.currentState === CONNECTING) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (contentType == undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>contentType = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (status === 200 &amp;&amp; contentTypeRegExp.test(contentType)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.currentState = OPEN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.wasActivity = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.retry = this.initialRetry;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.readyState = OPEN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.es.readyState = OPEN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var event = new Event("open");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.es.dispatchEvent(event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>fire(this.es, this.es.onopen, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (status !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var message = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (status !== 200) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>message = "EventSource's response has a status " + status + " " + statusText.replace(/\s+/g, " ") + " that is not 200. Aborting the connection.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>message = "EventSource's response has a Content-Type specifying an unsupported type: " + contentType.replace(/\s+/g, " ") + ". Aborting the connection.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throwError(new Error(message));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.close();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var event = new Event("error");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.es.dispatchEvent(event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>fire(this.es, this.es.onerror, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSourceInternal.prototype.onProgress = function (chunk) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.currentState === OPEN) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var length = chunk.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (length !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.wasActivity = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var position = 0; position &lt; length; position += 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var c = chunk.charCodeAt(position);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (this.state === AFTER_CR &amp;&amp; c === "\n".charCodeAt(0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this.state = FIELD_START;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (this.state === AFTER_CR) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this.state = FIELD_START;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (c === "\r".charCodeAt(0) || c === "\n".charCodeAt(0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this.state !== FIELD_START) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (this.state === FIELD) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.valueStart = position + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>var field = chunk.slice(this.fieldStart, this.valueStart - 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>var value = chunk.slice(this.valueStart + (this.valueStart &lt; position &amp;&amp; chunk.charCodeAt(this.valueStart) === " ".charCodeAt(0) ? 1 : 0), position);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (field === "data") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.dataBuffer.push(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else if (field === "id") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.lastEventIdBuffer = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else if (field === "event") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.eventTypeBuffer = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else if (field === "retry") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.initialRetry = getDuration(Number(value), this.initialRetry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.retry = this.initialRetry;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else if (field === "heartbeatTimeout") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.heartbeatTimeout = getDuration(Number(value), this.heartbeatTimeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (this.timeout !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>clearTimeout(this.timeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>that.onTimeout();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}, this.heartbeatTimeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this.state === FIELD_START) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (this.dataBuffer.length !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.lastEventId = this.lastEventIdBuffer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (this.eventTypeBuffer === "") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>this.eventTypeBuffer = "message";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var event = new MessageEvent(this.eventTypeBuffer, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>data: this.dataBuffer.join("\n"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>lastEventId: this.lastEventIdBuffer</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.es.dispatchEvent(event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (this.eventTypeBuffer === "message") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>fire(this.es, this.es.onmessage, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (this.currentState === CLOSED) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this.dataBuffer.length = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this.eventTypeBuffer = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this.state = c === "\r".charCodeAt(0) ? AFTER_CR : FIELD_START;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this.state === FIELD_START) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this.fieldStart = position;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this.state = FIELD;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this.state === FIELD) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (c === ":".charCodeAt(0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.valueStart = position + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.state = VALUE_START;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (this.state === VALUE_START) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this.state = VALUE;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSourceInternal.prototype.onFinish = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.currentState === OPEN || this.currentState === CONNECTING) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.currentState = WAITING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this.timeout !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>clearTimeout(this.timeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this.retry &gt; this.initialRetry * 16) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.retry = this.initialRetry * 16;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this.retry &gt; MAXIMUM_DURATION) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.retry = MAXIMUM_DURATION;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>that.onTimeout();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}, this.retry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.retry = this.retry * 2 + 1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.readyState = CONNECTING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.es.readyState = CONNECTING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var event = new Event("error");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.es.dispatchEvent(event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>fire(this.es, this.es.onerror, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSourceInternal.prototype.onTimeout = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.currentState !== WAITING) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!this.wasActivity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throwError(new Error("No activity within " + this.heartbeatTimeout + " milliseconds. Reconnecting."));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.transport.cancel();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.wasActivity = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>that.onTimeout();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, this.heartbeatTimeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.wasActivity = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.timeout = setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>that.onTimeout();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}, this.heartbeatTimeout);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.currentState = CONNECTING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.dataBuffer.length = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.eventTypeBuffer = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.lastEventIdBuffer = this.lastEventId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.fieldStart = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.valueStart = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.state = FIELD_START;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var s = this.url.slice(0, 5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (s !== "data:" &amp;&amp; s !== "blob:") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>s = this.url + ((this.url.indexOf("?", 0) === -1 ? "?" : "&amp;") + "lastEventId=" + encodeURIComponent(this.lastEventId) + "&amp;r=" + (Math.random() + 1).toString().slice(2));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>s = this.url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.transport.open(s, this.withCredentials);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.close();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw error;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSourceInternal.prototype.close = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.currentState = CLOSED;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.transport.cancel();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.timeout !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>clearTimeout(this.timeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.timeout = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.readyState = CLOSED;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.es.readyState = CLOSED;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function F() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.CONNECTING = CONNECTING;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.OPEN = OPEN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.CLOSED = CLOSED;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>F.prototype = EventTarget.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSource.prototype = new F();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>EventSource.prototype.close = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._internal.close();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>F.call(EventSource);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (isCORSSupported) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>EventSource.prototype.withCredentials = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var isEventSourceSupported = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Opera 12 fails this test, but this is fine.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return global.EventSource != undefined &amp;&amp; ("withCredentials" in global.EventSource.prototype);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (Transport != undefined &amp;&amp; (global.EventSource == undefined || (isCORSSupported &amp;&amp; !isEventSourceSupported()))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Why replace a native EventSource ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://bugzilla.mozilla.org/show_bug.cgi?id=444328</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://bugzilla.mozilla.org/show_bug.cgi?id=831392</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://code.google.com/p/chromium/issues/detail?id=260144</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://code.google.com/p/chromium/issues/detail?id=225654</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// ...</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.NativeEventSource = global.EventSource;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.EventSource = EventSource;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(typeof window !== 'undefined' ? window : this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// HTMLDocument</span></p>
<p class="p1"><span class="s1">this.HTMLDocument = this.Document;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// HTMLPictureElement</span></p>
<p class="p1"><span class="s1">/*! picturefill - v3.0.2 - 2016-02-12</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* https://scottjehl.github.io/picturefill/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">!function(a){var b=navigator.userAgent;a.HTMLPictureElement&amp;&amp;/ecko/.test(b)&amp;&amp;b.match(/rv\:(\d+)/)&amp;&amp;RegExp.$1&lt;45&amp;&amp;addEventListener("resize",function(){var b,c=document.createElement("source"),d=function(a){var b,d,e=a.parentNode;"PICTURE"===e.nodeName.toUpperCase()?(b=c.cloneNode(),e.insertBefore(b,e.firstElementChild),setTimeout(function(){e.removeChild(b)})):(!a._pfLastSize||a.offsetWidth&gt;a._pfLastSize)&amp;&amp;(a._pfLastSize=a.offsetWidth,d=a.sizes,a.sizes+=",100vw",setTimeout(function(){a.sizes=d}))},e=function(){var a,b=document.querySelectorAll("picture &gt; img, img[srcset][sizes]");for(a=0;a&lt;b.length;a++)d(b[a])},f=function(){clearTimeout(b),b=setTimeout(e,99)},g=a.matchMedia&amp;&amp;matchMedia("(orientation: landscape)"),h=function(){f(),g&amp;&amp;g.addListener&amp;&amp;g.addListener(f)};return c.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?h():document.addEventListener("DOMContentLoaded",h),f}())}(window),function(a,b,c){"use strict";function d(a){return" "===a||"<span class="Apple-tab-span">	</span>"===a||"\n"===a||"\f"===a||"\r"===a}function e(b,c){var d=new a.Image;return d.onerror=function(){A[b]=!1,ba()},d.onload=function(){A[b]=1===d.width,ba()},d.src=c,"pending"}function f(){M=!1,P=a.devicePixelRatio,N={},O={},s.DPR=P||1,Q.width=Math.max(a.innerWidth||0,z.clientWidth),Q.height=Math.max(a.innerHeight||0,z.clientHeight),Q.vw=Q.width/100,Q.vh=Q.height/100,r=[Q.height,Q.width,P].join("-"),Q.em=s.getEmValue(),Q.rem=Q.em}function g(a,b,c,d){var e,f,g,h;return"saveData"===B.algorithm?a&gt;2.7?h=c+1:(f=b-c,e=Math.pow(a-.6,1.5),g=f*e,d&amp;&amp;(g+=.1*e),h=a+g):h=c&gt;1?Math.sqrt(a*b):a,h&gt;c}function h(a){var b,c=s.getSet(a),d=!1;"pending"!==c&amp;&amp;(d=r,c&amp;&amp;(b=s.setRes(c),s.applySetCandidate(b,a))),a[s.ns].evaled=d}function i(a,b){return a.res-b.res}function j(a,b,c){var d;return!c&amp;&amp;b&amp;&amp;(c=a[s.ns].sets,c=c&amp;&amp;c[c.length-1]),d=k(b,c),d&amp;&amp;(b=s.makeUrl(b),a[s.ns].curSrc=b,a[s.ns].curCan=d,d.res||aa(d,d.set.sizes)),d}function k(a,b){var c,d,e;if(a&amp;&amp;b)for(e=s.parseSet(b),a=s.makeUrl(a),c=0;c&lt;e.length;c++)if(a===s.makeUrl(e[c].url)){d=e[c];break}return d}function l(a,b){var c,d,e,f,g=a.getElementsByTagName("source");for(c=0,d=g.length;d&gt;c;c++)e=g[c],e[s.ns]=!0,f=e.getAttribute("srcset"),f&amp;&amp;b.push({srcset:f,media:e.getAttribute("media"),type:e.getAttribute("type"),sizes:e.getAttribute("sizes")})}function m(a,b){function c(b){var c,d=b.exec(a.substring(m));return d?(c=d[0],m+=c.length,c):void 0}function e(){var a,c,d,e,f,i,j,k,l,m=!1,o={};for(e=0;e&lt;h.length;e++)f=h[e],i=f[f.length-1],j=f.substring(0,f.length-1),k=parseInt(j,10),l=parseFloat(j),X.test(j)&amp;&amp;"w"===i?((a||c)&amp;&amp;(m=!0),0===k?m=!0:a=k):Y.test(j)&amp;&amp;"x"===i?((a||c||d)&amp;&amp;(m=!0),0&gt;l?m=!0:c=l):X.test(j)&amp;&amp;"h"===i?((d||c)&amp;&amp;(m=!0),0===k?m=!0:d=k):m=!0;m||(o.url=g,a&amp;&amp;(o.w=a),c&amp;&amp;(o.d=c),d&amp;&amp;(o.h=d),d||c||a||(o.d=1),1===o.d&amp;&amp;(b.has1x=!0),o.set=b,n.push(o))}function f(){for(c(T),i="",j="in descriptor";;){if(k=a.charAt(m),"in descriptor"===j)if(d(k))i&amp;&amp;(h.push(i),i="",j="after descriptor");else{if(","===k)return m+=1,i&amp;&amp;h.push(i),void e();if("("===k)i+=k,j="in parens";else{if(""===k)return i&amp;&amp;h.push(i),void e();i+=k}}else if("in parens"===j)if(")"===k)i+=k,j="in descriptor";else{if(""===k)return h.push(i),void e();i+=k}else if("after descriptor"===j)if(d(k));else{if(""===k)return void e();j="in descriptor",m-=1}m+=1}}for(var g,h,i,j,k,l=a.length,m=0,n=[];;){if(c(U),m&gt;=l)return n;g=c(V),h=[],","===g.slice(-1)?(g=g.replace(W,""),e()):f()}}function n(a){function b(a){function b(){f&amp;&amp;(g.push(f),f="")}function c(){g[0]&amp;&amp;(h.push(g),g=[])}for(var e,f="",g=[],h=[],i=0,j=0,k=!1;;){if(e=a.charAt(j),""===e)return b(),c(),h;if(k){if("*"===e&amp;&amp;"/"===a[j+1]){k=!1,j+=2,b();continue}j+=1}else{if(d(e)){if(a.charAt(j-1)&amp;&amp;d(a.charAt(j-1))||!f){j+=1;continue}if(0===i){b(),j+=1;continue}e=" "}else if("("===e)i+=1;else if(")"===e)i-=1;else{if(","===e){b(),c(),j+=1;continue}if("/"===e&amp;&amp;"*"===a.charAt(j+1)){k=!0,j+=2;continue}}f+=e,j+=1}}}function c(a){return k.test(a)&amp;&amp;parseFloat(a)&gt;=0?!0:l.test(a)?!0:"0"===a||"-0"===a||"+0"===a?!0:!1}var e,f,g,h,i,j,k=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,l=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(f=b(a),g=f.length,e=0;g&gt;e;e++)if(h=f[e],i=h[h.length-1],c(i)){if(j=i,h.pop(),0===h.length)return j;if(h=h.join(" "),s.matchesMedia(h))return j}return"100vw"}b.createElement("picture");var o,p,q,r,s={},t=!1,u=function(){},v=b.createElement("img"),w=v.getAttribute,x=v.setAttribute,y=v.removeAttribute,z=b.documentElement,A={},B={algorithm:""},C="data-pfsrc",D=C+"set",E=navigator.userAgent,F=/rident/.test(E)||/ecko/.test(E)&amp;&amp;E.match(/rv\:(\d+)/)&amp;&amp;RegExp.$1&gt;35,G="currentSrc",H=/\s+\+?\d+(e\d+)?w/,I=/(\([^)]+\))?\s*(.+)/,J=a.picturefillCFG,K="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",L="font-size:100%!important;",M=!0,N={},O={},P=a.devicePixelRatio,Q={px:1,"in":96},R=b.createElement("a"),S=!1,T=/^[ \t\n\r\u000c]+/,U=/^[, \t\n\r\u000c]+/,V=/^[^ \t\n\r\u000c]+/,W=/[,]+$/,X=/^\d+$/,Y=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Z=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&amp;&amp;a.attachEvent("on"+b,c)},$=function(a){var b={};return function(c){return c in b||(b[c]=a(c)),b[c]}},_=function(){var a=/^([\d\.]+)(em|vw|px)$/,b=function(){for(var a=arguments,b=0,c=a[0];++b in a;)c=c.replace(a[b],a[++b]);return c},c=$(function(a){return"return "+b((a||"").toLowerCase(),/\band\b/g,"&amp;&amp;",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1&gt;=",/max-([a-z-\s]+):/g,"e.$1&lt;=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&amp;=|&gt;&lt;\+\-\*\(\)\/])).*/gi,"")+";"});return function(b,d){var e;if(!(b in N))if(N[b]=!1,d&amp;&amp;(e=b.match(a)))N[b]=e[1]*Q[e[2]];else try{N[b]=new Function("e",c(b))(Q)}catch(f){}return N[b]}}(),aa=function(a,b){return a.w?(a.cWidth=s.calcListLength(b||"100vw"),a.res=a.w/a.cWidth):a.res=a.d,a},ba=function(a){if(t){var c,d,e,f=a||{};if(f.elements&amp;&amp;1===f.elements.nodeType&amp;&amp;("IMG"===f.elements.nodeName.toUpperCase()?f.elements=[f.elements]:(f.context=f.elements,f.elements=null)),c=f.elements||s.qsa(f.context||b,f.reevaluate||f.reselect?s.sel:s.selShort),e=c.length){for(s.setupRun(f),S=!0,d=0;e&gt;d;d++)s.fillImg(c[d],f);s.teardownRun(f)}}};o=a.console&amp;&amp;console.warn?function(a){console.warn(a)}:u,G in v||(G="src"),A["image/jpeg"]=!0,A["image/gif"]=!0,A["image/png"]=!0,A["image/svg+xml"]=b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),s.ns=("pf"+(new Date).getTime()).substr(0,9),s.supSrcset="srcset"in v,s.supSizes="sizes"in v,s.supPicture=!!a.HTMLPictureElement,s.supSrcset&amp;&amp;s.supPicture&amp;&amp;!s.supSizes&amp;&amp;!function(a){v.srcset="data:,a",a.src="data:,a",s.supSrcset=v.complete===a.complete,s.supPicture=s.supSrcset&amp;&amp;s.supPicture}(b.createElement("img")),s.supSrcset&amp;&amp;!s.supSizes?!function(){var a="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",c="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d=b.createElement("img"),e=function(){var a=d.width;2===a&amp;&amp;(s.supSizes=!0),q=s.supSrcset&amp;&amp;!s.supSizes,t=!0,setTimeout(ba)};d.onload=e,d.onerror=e,d.setAttribute("sizes","9px"),d.srcset=c+" 1w,"+a+" 9w",d.src=c}():t=!0,s.selShort="picture&gt;img,img[srcset]",s.sel=s.selShort,s.cfg=B,s.DPR=P||1,s.u=Q,s.types=A,s.setSize=u,s.makeUrl=$(function(a){return R.href=a,R.href}),s.qsa=function(a,b){return"querySelector"in a?a.querySelectorAll(b):[]},s.matchesMedia=function(){return a.matchMedia&amp;&amp;(matchMedia("(min-width: 0.1em)")||{}).matches?s.matchesMedia=function(a){return!a||matchMedia(a).matches}:s.matchesMedia=s.mMQ,s.matchesMedia.apply(this,arguments)},s.mMQ=function(a){return a?_(a):!0},s.calcLength=function(a){var b=_(a,!0)||!1;return 0&gt;b&amp;&amp;(b=!1),b},s.supportsType=function(a){return a?A[a]:!0},s.parseSize=$(function(a){var b=(a||"").match(I);return{media:b&amp;&amp;b[1],length:b&amp;&amp;b[2]}}),s.parseSet=function(a){return a.cands||(a.cands=m(a.srcset,a)),a.cands},s.getEmValue=function(){var a;if(!p&amp;&amp;(a=b.body)){var c=b.createElement("div"),d=z.style.cssText,e=a.style.cssText;c.style.cssText=K,z.style.cssText=L,a.style.cssText=L,a.appendChild(c),p=c.offsetWidth,a.removeChild(c),p=parseFloat(p,10),z.style.cssText=d,a.style.cssText=e}return p||16},s.calcListLength=function(a){if(!(a in O)||B.uT){var b=s.calcLength(n(a));O[a]=b?b:Q.width}return O[a]},s.setRes=function(a){var b;if(a){b=s.parseSet(a);for(var c=0,d=b.length;d&gt;c;c++)aa(b[c],a.sizes)}return b},s.setRes.res=aa,s.applySetCandidate=function(a,b){if(a.length){var c,d,e,f,h,k,l,m,n,o=b[s.ns],p=s.DPR;if(k=o.curSrc||b[G],l=o.curCan||j(b,k,a[0].set),l&amp;&amp;l.set===a[0].set&amp;&amp;(n=F&amp;&amp;!b.complete&amp;&amp;l.res-.1&gt;p,n||(l.cached=!0,l.res&gt;=p&amp;&amp;(h=l))),!h)for(a.sort(i),f=a.length,h=a[f-1],d=0;f&gt;d;d++)if(c=a[d],c.res&gt;=p){e=d-1,h=a[e]&amp;&amp;(n||k!==s.makeUrl(c.url))&amp;&amp;g(a[e].res,c.res,p,a[e].cached)?a[e]:c;break}h&amp;&amp;(m=s.makeUrl(h.url),o.curSrc=m,o.curCan=h,m!==k&amp;&amp;s.setSrc(b,h),s.setSize(b))}},s.setSrc=function(a,b){var c;a.src=b.url,"image/svg+xml"===b.set.type&amp;&amp;(c=a.style.width,a.style.width=a.offsetWidth+1+"px",a.offsetWidth+1&amp;&amp;(a.style.width=c))},s.getSet=function(a){var b,c,d,e=!1,f=a[s.ns].sets;for(b=0;b&lt;f.length&amp;&amp;!e;b++)if(c=f[b],c.srcset&amp;&amp;s.matchesMedia(c.media)&amp;&amp;(d=s.supportsType(c.type))){"pending"===d&amp;&amp;(c=d),e=c;break}return e},s.parseSets=function(a,b,d){var e,f,g,h,i=b&amp;&amp;"PICTURE"===b.nodeName.toUpperCase(),j=a[s.ns];(j.src===c||d.src)&amp;&amp;(j.src=w.call(a,"src"),j.src?x.call(a,C,j.src):y.call(a,C)),(j.srcset===c||d.srcset||!s.supSrcset||a.srcset)&amp;&amp;(e=w.call(a,"srcset"),j.srcset=e,h=!0),j.sets=[],i&amp;&amp;(j.pic=!0,l(b,j.sets)),j.srcset?(f={srcset:j.srcset,sizes:w.call(a,"sizes")},j.sets.push(f),g=(q||j.src)&amp;&amp;H.test(j.srcset||""),g||!j.src||k(j.src,f)||f.has1x||(f.srcset+=", "+j.src,f.cands.push({url:j.src,d:1,set:f}))):j.src&amp;&amp;j.sets.push({srcset:j.src,sizes:null}),j.curCan=null,j.curSrc=c,j.supported=!(i||f&amp;&amp;!s.supSrcset||g&amp;&amp;!s.supSizes),h&amp;&amp;s.supSrcset&amp;&amp;!j.supported&amp;&amp;(e?(x.call(a,D,e),a.srcset=""):y.call(a,D)),j.supported&amp;&amp;!j.srcset&amp;&amp;(!j.src&amp;&amp;a.src||a.src!==s.makeUrl(j.src))&amp;&amp;(null===j.src?a.removeAttribute("src"):a.src=j.src),j.parsed=!0},s.fillImg=function(a,b){var c,d=b.reselect||b.reevaluate;a[s.ns]||(a[s.ns]={}),c=a[s.ns],(d||c.evaled!==r)&amp;&amp;((!c.parsed||b.reevaluate)&amp;&amp;s.parseSets(a,a.parentNode,b),c.supported?c.evaled=r:h(a))},s.setupRun=function(){(!S||M||P!==a.devicePixelRatio)&amp;&amp;f()},s.supPicture?(ba=u,s.fillImg=u):!function(){var c,d=a.attachEvent?/d$|^c/:/d$|^c|^i/,e=function(){var a=b.readyState||"";f=setTimeout(e,"loading"===a?200:999),b.body&amp;&amp;(s.fillImgs(),c=c||d.test(a),c&amp;&amp;clearTimeout(f))},f=setTimeout(e,b.body?9:99),g=function(a,b){var c,d,e=function(){var f=new Date-d;b&gt;f?c=setTimeout(e,b-f):(c=null,a())};return function(){d=new Date,c||(c=setTimeout(e,b))}},h=z.clientHeight,i=function(){M=Math.max(a.innerWidth||0,z.clientWidth)!==Q.width||z.clientHeight!==h,h=z.clientHeight,M&amp;&amp;s.fillImgs()};Z(a,"resize",g(i,99)),Z(b,"readystatechange",e)}(),s.picturefill=ba,s.fillImgs=ba,s.teardownRun=u,ba._=s,a.picturefillCFG={pf:s,push:function(a){var b=a.shift();"function"==typeof s[b]?s[b].apply(s,a):(B[b]=a[0],S&amp;&amp;s.fillImgs({reselect:!0}))}};for(;J&amp;&amp;J.length;)a.picturefillCFG.push(J.shift());a.picturefill=ba,"object"==typeof module&amp;&amp;"object"==typeof module.exports?module.exports=ba:"function"==typeof define&amp;&amp;define.amd&amp;&amp;define("picturefill",function(){return ba}),s.supPicture||(A["image/webp"]=e("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document);/*! picturefill - v3.0.2 - 2016-02-12</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* https://scottjehl.github.io/picturefill/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">!function(a){"use strict";var b,c=0,d=function(){window.picturefill&amp;&amp;a(window.picturefill),(window.picturefill||c&gt;9999)&amp;&amp;clearInterval(b),c++};b=setInterval(d,8),d()}(function(a){"use strict";var b=window.document,c=window.Element,d=window.MutationObserver,e=function(){},f={disconnect:e,take:e,observe:e,start:e,stop:e,connected:!1},g=/^loade|^c|^i/.test(b.readyState||""),h=a._;if(h.mutationSupport=!1,h.observer=f,Object.keys&amp;&amp;window.HTMLSourceElement&amp;&amp;b.addEventListener){var i,j,k,l,m={src:1,srcset:1,sizes:1,media:1},n=Object.keys(m),o={attributes:!0,childList:!0,subtree:!0,attributeFilter:n},p=c&amp;&amp;c.prototype,q={},r=function(a,b){q[a]=h[a],h[a]=b};p&amp;&amp;!p.matches&amp;&amp;(p.matches=p.matchesSelector||p.mozMatchesSelector||p.webkitMatchesSelector||p.msMatchesSelector),p&amp;&amp;p.matches&amp;&amp;(i=function(a,b){return a.matches(b)},h.mutationSupport=!(!Object.create||!Object.defineProperties)),h.mutationSupport&amp;&amp;(f.observe=function(){k&amp;&amp;(f.connected=!0,j&amp;&amp;j.observe(b.documentElement,o))},f.disconnect=function(){f.connected=!1,j&amp;&amp;j.disconnect()},f.take=function(){j?h.onMutations(j.takeRecords()):l&amp;&amp;l.take()},f.start=function(){k=!0,f.observe()},f.stop=function(){k=!1,f.disconnect()},r("setupRun",function(){return f.disconnect(),q.setupRun.apply(this,arguments)}),r("teardownRun",function(){var a=q.setupRun.apply(this,arguments);return f.observe(),a}),r("setSrc",function(){var a,b=f.connected;return f.disconnect(),a=q.setSrc.apply(this,arguments),b&amp;&amp;f.observe(),a}),h.onMutations=function(a){var b,c,d=[];for(b=0,c=a.length;c&gt;b;b++)g&amp;&amp;"childList"===a[b].type?h.onSubtreeChange(a[b],d):"attributes"===a[b].type&amp;&amp;h.onAttrChange(a[b],d);d.length&amp;&amp;h.fillImgs({elements:d,reevaluate:!0})},h.onSubtreeChange=function(a,b){h.findAddedMutations(a.addedNodes,b),h.findRemovedMutations(a.removedNodes,a.target,b)},h.findAddedMutations=function(a,b){var c,d,e,f;for(c=0,d=a.length;d&gt;c;c++)e=a[c],1===e.nodeType&amp;&amp;(f=e.nodeName.toUpperCase(),"PICTURE"===f?h.addToElements(e.getElementsByTagName("img")[0],b):"IMG"===f&amp;&amp;i(e,h.selShort)?h.addToElements(e,b):"SOURCE"===f?h.addImgForSource(e,e.parentNode,b):h.addToElements(h.qsa(e,h.selShort),b))},h.findRemovedMutations=function(a,b,c){var d,e,f;for(d=0,e=a.length;e&gt;d;d++)f=a[d],1===f.nodeType&amp;&amp;"SOURCE"===f.nodeName.toUpperCase()&amp;&amp;h.addImgForSource(f,b,c)},h.addImgForSource=function(a,b,c){b&amp;&amp;"PICTURE"!==(b.nodeName||"").toUpperCase()&amp;&amp;(b=b.parentNode,b&amp;&amp;"PICTURE"===(b.nodeName||"").toUpperCase()||(b=null)),b&amp;&amp;h.addToElements(b.getElementsByTagName("img")[0],c)},h.addToElements=function(a,b){var c,d;if(a)if("length"in a&amp;&amp;!a.nodeType)for(c=0,d=a.length;d&gt;c;c++)h.addToElements(a[c],b);else a.parentNode&amp;&amp;-1===b.indexOf(a)&amp;&amp;b.push(a)},h.onAttrChange=function(a,b){var c,d=a.target[h.ns];d||"srcset"!==a.attributeName||"IMG"!==(c=a.target.nodeName.toUpperCase())?d&amp;&amp;(c||(c=a.target.nodeName.toUpperCase()),"IMG"===c?(a.attributeName in d&amp;&amp;(d[a.attributeName]=void 0),h.addToElements(a.target,b)):"SOURCE"===c&amp;&amp;h.addImgForSource(a.target,a.target.parentNode,b)):h.addToElements(a.target,b)},h.supPicture||(d&amp;&amp;!h.testMutationEvents?j=new d(h.onMutations):(l=function(){var a=!1,b=[],c=window.setImmediate||window.setTimeout;return function(d){a||(a=!0,l.take||(l.take=function(){b.length&amp;&amp;(h.onMutations(b),b=[]),a=!1}),c(l.take)),b.push(d)}}(),b.documentElement.addEventListener("DOMNodeInserted",function(a){f.connected&amp;&amp;g&amp;&amp;l({type:"childList",addedNodes:[a.target],removedNodes:[]})},!0),b.documentElement.addEventListener("DOMNodeRemoved",function(a){f.connected&amp;&amp;g&amp;&amp;"SOURCE"===(a.target||{}).nodeName&amp;&amp;l({type:"childList",addedNodes:[],removedNodes:[a.target],target:a.target.parentNode})},!0),b.documentElement.addEventListener("DOMAttrModified",function(a){f.connected&amp;&amp;m[a.attrName]&amp;&amp;l({type:"attributes",target:a.target,attributeName:a.attrName})},!0)),window.HTMLImageElement&amp;&amp;Object.defineProperties&amp;&amp;!function(){var a=b.createElement("img"),c=[],d=a.getAttribute,e=a.setAttribute,f={src:1};h.supSrcset&amp;&amp;!h.supSizes&amp;&amp;(f.srcset=1),Object.defineProperties(HTMLImageElement.prototype,{getAttribute:{value:function(a){var b;return f[a]&amp;&amp;(b=this[h.ns])&amp;&amp;void 0!==b[a]?b[a]:d.apply(this,arguments)},writeable:!0,enumerable:!0,configurable:!0}}),h.supSrcset||c.push("srcset"),h.supSizes||c.push("sizes"),c.forEach(function(a){Object.defineProperty(HTMLImageElement.prototype,a,{set:function(b){e.call(this,a,b)},get:function(){return d.call(this,a)||""},enumerable:!0,configurable:!0})}),"currentSrc"in a||!function(){var a,c=function(a,b){null==b&amp;&amp;(b=a.src||""),Object.defineProperty(a,"pfCurrentSrc",{value:b,writable:!0})},d=c;h.supSrcset&amp;&amp;window.devicePixelRatio&amp;&amp;(a=function(a,b){var c=a.d||a.w||a.res,d=b.d||b.w||b.res;return c-d},c=function(b){var c,e,f,g,i=b[h.ns];if(i&amp;&amp;i.supported&amp;&amp;i.srcset&amp;&amp;i.sets&amp;&amp;(e=h.parseSet(i.sets[0]))&amp;&amp;e.sort){for(e.sort(a),f=e.length,g=e[f-1],c=0;f&gt;c;c++)if(e[c].d&gt;=window.devicePixelRatio){g=e[c];break}g&amp;&amp;(g=h.makeUrl(g.url))}d(b,g)}),b.addEventListener("load",function(a){"IMG"===a.target.nodeName.toUpperCase()&amp;&amp;c(a.target)},!0),Object.defineProperty(HTMLImageElement.prototype,"currentSrc",{set:function(){window.console&amp;&amp;console.warn&amp;&amp;console.warn("currentSrc can't be set on img element")},get:function(){return this.complete&amp;&amp;c(this),this.src||this.srcset?this.pfCurrentSrc||"":""},enumerable:!0,configurable:!0})}(),!window.HTMLSourceElement||"srcset"in b.createElement("source")||["srcset","sizes"].forEach(function(a){Object.defineProperty(window.HTMLSourceElement.prototype,a,{set:function(b){this.setAttribute(a,b)},get:function(){return this.getAttribute(a)||""},enumerable:!0,configurable:!0})})}(),f.start()),g||b.addEventListener("DOMContentLoaded",function(){g=!0}))}});</span></p>
<p class="p1"><span class="s1">// Intl</span></p>
<p class="p1"><span class="s1">!function(e,r){"object"==typeof exports&amp;&amp;"undefined"!=typeof module?module.exports=r():"function"==typeof define&amp;&amp;define.amd?define(r):e.IntlPolyfill=r()}(this,function(){"use strict";function e(e){if("function"==typeof Math.log10)return Math.floor(Math.log10(e));var r=Math.round(Math.log(e)*Math.LOG10E);return r-(Number("1e"+r)&gt;e)}function r(e){for(var t in e)(e instanceof r||Me.call(e,t))&amp;&amp;Ie(this,t,{value:e[t],enumerable:!0,writable:!0,configurable:!0})}function t(){Ie(this,"length",{writable:!0,value:0}),arguments.length&amp;&amp;Ge.apply(this,qe.call(arguments))}function n(){if($e.disableRegExpRestore)return function(){};for(var e={lastMatch:RegExp.lastMatch||"",leftContext:RegExp.leftContext,multiline:RegExp.multiline,input:RegExp.input},r=!1,n=1;n&lt;=9;n++)r=(e["$"+n]=RegExp["$"+n])||r;return function(){var n=/[.?*+^$[\]\\(){}|-]/g,a=e.lastMatch.replace(n,"\\$&amp;"),i=new t;if(r)for(var o=1;o&lt;=9;o++){var s=e["$"+o];s?(s=s.replace(n,"\\$&amp;"),a=a.replace(s,"("+s+")")):a="()"+a,Ge.call(i,a.slice(0,a.indexOf("(")+1)),a=a.slice(a.indexOf("(")+1)}var l=Ze.call(i,"")+a;l=l.replace(/(\\\(|\\\)|[^()])+/g,function(e){return"[\\s\\S]{"+e.replace("\\","").length+"}"});var c=new RegExp(l,e.multiline?"gm":"g");c.lastIndex=e.leftContext.length,c.exec(e.input)}}function a(e){if(null===e)throw new TypeError("Cannot convert null or undefined to object");return"object"===("undefined"==typeof e?"undefined":Ne.typeof(e))?e:Object(e)}function i(e){return"number"==typeof e?e:Number(e)}function o(e){var r=i(e);return isNaN(r)?0:0===r||r===-0||r===+(1/0)||r===-(1/0)?r:r&lt;0?Math.floor(Math.abs(r))*-1:Math.floor(Math.abs(r))}function s(e){var r=o(e);return r&lt;=0?0:r===1/0?Math.pow(2,53)-1:Math.min(r,Math.pow(2,53)-1)}function l(e){return Me.call(e,"__getInternalProperties")?e.__getInternalProperties(Ke):Re(null)}function c(e){cr=e}function u(e){for(var r=e.length;r--;){var t=e.charAt(r);t&gt;="a"&amp;&amp;t&lt;="z"&amp;&amp;(e=e.slice(0,r)+t.toUpperCase()+e.slice(r+1))}return e}function g(e){return!!ir.test(e)&amp;&amp;(!or.test(e)&amp;&amp;!sr.test(e))}function f(e){var r=void 0,t=void 0;e=e.toLowerCase(),t=e.split("-");for(var n=1,a=t.length;n&lt;a;n++)if(2===t[n].length)t[n]=t[n].toUpperCase();else if(4===t[n].length)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);else if(1===t[n].length&amp;&amp;"x"!==t[n])break;e=Ze.call(t,"-"),(r=e.match(lr))&amp;&amp;r.length&gt;1&amp;&amp;(r.sort(),e=e.replace(RegExp("(?:"+lr.source+")+","i"),Ze.call(r,""))),Me.call(ur.tags,e)&amp;&amp;(e=ur.tags[e]),t=e.split("-");for(var i=1,o=t.length;i&lt;o;i++)Me.call(ur.subtags,t[i])?t[i]=ur.subtags[t[i]]:Me.call(ur.extLang,t[i])&amp;&amp;(t[i]=ur.extLang[t[i]][0],1===i&amp;&amp;ur.extLang[t[1]][1]===t[0]&amp;&amp;(t=qe.call(t,i++),o-=1));return Ze.call(t,"-")}function m(){return cr}function v(e){var r=String(e),t=u(r);return gr.test(t)!==!1}function d(e){if(void 0===e)return new t;var r=new t;e="string"==typeof e?[e]:e;for(var n=a(e),i=s(n.length),o=0;o&lt;i;){var l=String(o),c=l in n;if(c){var u=n[l];if(null===u||"string"!=typeof u&amp;&amp;"object"!==("undefined"==typeof u?"undefined":Ne.typeof(u)))throw new TypeError("String or Object type expected");var m=String(u);if(!g(m))throw new RangeError("'"+m+"' is not a structurally valid language tag");m=f(m),Ae.call(r,m)===-1&amp;&amp;Ge.call(r,m)}o++}return r}function h(e,r){for(var t=r;t;){if(Ae.call(e,t)&gt;-1)return t;var n=t.lastIndexOf("-");if(n&lt;0)return;n&gt;=2&amp;&amp;"-"===t.charAt(n-2)&amp;&amp;(n-=2),t=t.substring(0,n)}}function p(e,t){for(var n=0,a=t.length,i=void 0,o=void 0,s=void 0;n&lt;a&amp;&amp;!i;)o=t[n],s=String(o).replace(fr,""),i=h(e,s),n++;var l=new r;if(void 0!==i){if(l["[[locale]]"]=i,String(o)!==String(s)){var c=o.match(fr)[0],u=o.indexOf("-u-");l["[[extension]]"]=c,l["[[extensionIndex]]"]=u}}else l["[[locale]]"]=m();return l}function y(e,r){return p(e,r)}function b(e,t,n,a,i){if(0===e.length)throw new ReferenceError("No locale data has been provided for this object yet.");var o=n["[[localeMatcher]]"],s=void 0;s="lookup"===o?p(e,t):y(e,t);var l=s["[[locale]]"],c=void 0,u=void 0;if(Me.call(s,"[[extension]]")){var g=s["[[extension]]"],m=String.prototype.split;c=m.call(g,"-"),u=c.length}var v=new r;v["[[dataLocale]]"]=l;for(var d="-u",h=0,b=a.length;h&lt;b;){var w=a[h],x=i[l],j=x[w],D=j[0],z="",k=Ae;if(void 0!==c){var O=k.call(c,w);if(O!==-1)if(O+1&lt;u&amp;&amp;c[O+1].length&gt;2){var F=c[O+1],S=k.call(j,F);S!==-1&amp;&amp;(D=F,z="-"+w+"-"+D)}else{var E=k(j,"true");E!==-1&amp;&amp;(D="true")}}if(Me.call(n,"[["+w+"]]")){var L=n["[["+w+"]]"];k.call(j,L)!==-1&amp;&amp;L!==D&amp;&amp;(D=L,z="")}v["[["+w+"]]"]=D,d+=z,h++}if(d.length&gt;2){var P=l.indexOf("-x-");if(P===-1)l+=d;else{var N=l.substring(0,P),T=l.substring(P);l=N+d+T}l=f(l)}return v["[[locale]]"]=l,v}function w(e,r){for(var n=r.length,a=new t,i=0;i&lt;n;){var o=r[i],s=String(o).replace(fr,""),l=h(e,s);void 0!==l&amp;&amp;Ge.call(a,o),i++}var c=qe.call(a);return c}function x(e,r){return w(e,r)}function j(e,t,n){var i=void 0,o=void 0;if(void 0!==n&amp;&amp;(n=new r(a(n)),i=n.localeMatcher,void 0!==i&amp;&amp;(i=String(i),"lookup"!==i&amp;&amp;"best fit"!==i)))throw new RangeError('matcher should be "lookup" or "best fit"');o=void 0===i||"best fit"===i?x(e,t):w(e,t);for(var s in o)Me.call(o,s)&amp;&amp;Ie(o,s,{writable:!1,configurable:!1,value:o[s]});return Ie(o,"length",{writable:!1}),o}function D(e,r,t,n,a){var i=e[r];if(void 0!==i){if(i="boolean"===t?Boolean(i):"string"===t?String(i):i,void 0!==n&amp;&amp;Ae.call(n,i)===-1)throw new RangeError("'"+i+"' is not an allowed value for `"+r+"`");return i}return a}function z(e,r,t,n,a){var i=e[r];if(void 0!==i){if(i=Number(i),isNaN(i)||i&lt;t||i&gt;n)throw new RangeError("Value is not a number or outside accepted range");return Math.floor(i)}return a}function k(e){for(var r=d(e),t=[],n=r.length,a=0;a&lt;n;)t[a]=r[a],a++;return t}function O(){var e=arguments[0],r=arguments[1];return this&amp;&amp;this!==mr?F(a(this),e,r):new mr.NumberFormat(e,r)}function F(e,i,o){var s=l(e),c=n();if(s["[[initializedIntlObject]]"]===!0)throw new TypeError("`this` object has already been initialized as an Intl object");Ie(e,"__getInternalProperties",{value:function(){if(arguments[0]===Ke)return s}}),s["[[initializedIntlObject]]"]=!0;var u=d(i);o=void 0===o?{}:a(o);var g=new r,f=D(o,"localeMatcher","string",new t("lookup","best fit"),"best fit");g["[[localeMatcher]]"]=f;var m=$e.NumberFormat["[[localeData]]"],h=b($e.NumberFormat["[[availableLocales]]"],u,g,$e.NumberFormat["[[relevantExtensionKeys]]"],m);s["[[locale]]"]=h["[[locale]]"],s["[[numberingSystem]]"]=h["[[nu]]"],s["[[dataLocale]]"]=h["[[dataLocale]]"];var p=h["[[dataLocale]]"],y=D(o,"style","string",new t("decimal","percent","currency"),"decimal");s["[[style]]"]=y;var w=D(o,"currency","string");if(void 0!==w&amp;&amp;!v(w))throw new RangeError("'"+w+"' is not a valid currency code");if("currency"===y&amp;&amp;void 0===w)throw new TypeError("Currency code is required when style is currency");var x=void 0;"currency"===y&amp;&amp;(w=w.toUpperCase(),s["[[currency]]"]=w,x=S(w));var j=D(o,"currencyDisplay","string",new t("code","symbol","name"),"symbol");"currency"===y&amp;&amp;(s["[[currencyDisplay]]"]=j);var k=z(o,"minimumIntegerDigits",1,21,1);s["[[minimumIntegerDigits]]"]=k;var O="currency"===y?x:0,F=z(o,"minimumFractionDigits",0,20,O);s["[[minimumFractionDigits]]"]=F;var L="currency"===y?Math.max(F,x):"percent"===y?Math.max(F,0):Math.max(F,3),P=z(o,"maximumFractionDigits",F,20,L);s["[[maximumFractionDigits]]"]=P;var N=o.minimumSignificantDigits,T=o.maximumSignificantDigits;void 0===N&amp;&amp;void 0===T||(N=z(o,"minimumSignificantDigits",1,21,1),T=z(o,"maximumSignificantDigits",N,21,21),s["[[minimumSignificantDigits]]"]=N,s["[[maximumSignificantDigits]]"]=T);var _=D(o,"useGrouping","boolean",void 0,!0);s["[[useGrouping]]"]=_;var M=m[p],I=M.patterns,A=I[y];return s["[[positivePattern]]"]=A.positivePattern,s["[[negativePattern]]"]=A.negativePattern,s["[[boundFormat]]"]=void 0,s["[[initializedNumberFormat]]"]=!0,_e&amp;&amp;(e.format=E.call(e)),c(),e}function S(e){return void 0!==vr[e]?vr[e]:2}function E(){var e=null!==this&amp;&amp;"object"===Ne.typeof(this)&amp;&amp;l(this);if(!e||!e["[[initializedNumberFormat]]"])throw new TypeError("`this` value for format() is not an initialized Intl.NumberFormat object.");if(void 0===e["[[boundFormat]]"]){var r=function(e){return T(this,Number(e))},t=Ue.call(r,this);e["[[boundFormat]]"]=t}return e["[[boundFormat]]"]}function L(){var e=arguments.length&lt;=0||void 0===arguments[0]?void 0:arguments[0],r=null!==this&amp;&amp;"object"===Ne.typeof(this)&amp;&amp;l(this);if(!r||!r["[[initializedNumberFormat]]"])throw new TypeError("`this` value for formatToParts() is not an initialized Intl.NumberFormat object.");var t=Number(e);return P(this,t)}function P(e,r){for(var t=N(e,r),n=[],a=0,i=0;t.length&gt;i;i++){var o=t[i],s={};s.type=o["[[type]]"],s.value=o["[[value]]"],n[a]=s,a+=1}return n}function N(e,r){var n=l(e),a=n["[[dataLocale]]"],i=n["[[numberingSystem]]"],o=$e.NumberFormat["[[localeData]]"][a],s=o.symbols[i]||o.symbols.latn,c=void 0;!isNaN(r)&amp;&amp;r&lt;0?(r=-r,c=n["[[negativePattern]]"]):c=n["[[positivePattern]]"];for(var u=new t,g=c.indexOf("{",0),f=0,m=0,v=c.length;g&gt;-1&amp;&amp;g&lt;v;){if(f=c.indexOf("}",g),f===-1)throw new Error;if(g&gt;m){var d=c.substring(m,g);Ge.call(u,{"[[type]]":"literal","[[value]]":d})}var h=c.substring(g+1,f);if("number"===h)if(isNaN(r)){var p=s.nan;Ge.call(u,{"[[type]]":"nan","[[value]]":p})}else if(isFinite(r)){"percent"===n["[[style]]"]&amp;&amp;isFinite(r)&amp;&amp;(r*=100);var y=void 0;y=Me.call(n,"[[minimumSignificantDigits]]")&amp;&amp;Me.call(n,"[[maximumSignificantDigits]]")?_(r,n["[[minimumSignificantDigits]]"],n["[[maximumSignificantDigits]]"]):M(r,n["[[minimumIntegerDigits]]"],n["[[minimumFractionDigits]]"],n["[[maximumFractionDigits]]"]),dr[i]?!function(){var e=dr[i];y=String(y).replace(/\d/g,function(r){return e[r]})}():y=String(y);var b=void 0,w=void 0,x=y.indexOf(".",0);if(x&gt;0?(b=y.substring(0,x),w=y.substring(x+1,x.length)):(b=y,w=void 0),n["[[useGrouping]]"]===!0){var j=s.group,D=[],z=o.patterns.primaryGroupSize||3,k=o.patterns.secondaryGroupSize||z;if(b.length&gt;z){var O=b.length-z,F=O%k,S=b.slice(0,F);for(S.length&amp;&amp;Ge.call(D,S);F&lt;O;)Ge.call(D,b.slice(F,F+k)),F+=k;Ge.call(D,b.slice(O))}else Ge.call(D,b);if(0===D.length)throw new Error;for(;D.length;){var E=Be.call(D);Ge.call(u,{"[[type]]":"integer","[[value]]":E}),D.length&amp;&amp;Ge.call(u,{"[[type]]":"group","[[value]]":j})}}else Ge.call(u,{"[[type]]":"integer","[[value]]":b});if(void 0!==w){var L=s.decimal;Ge.call(u,{"[[type]]":"decimal","[[value]]":L}),Ge.call(u,{"[[type]]":"fraction","[[value]]":w})}}else{var P=s.infinity;Ge.call(u,{"[[type]]":"infinity","[[value]]":P})}else if("plusSign"===h){var N=s.plusSign;Ge.call(u,{"[[type]]":"plusSign","[[value]]":N})}else if("minusSign"===h){var T=s.minusSign;Ge.call(u,{"[[type]]":"minusSign","[[value]]":T})}else if("percentSign"===h&amp;&amp;"percent"===n["[[style]]"]){var I=s.percentSign;Ge.call(u,{"[[type]]":"literal","[[value]]":I})}else if("currency"===h&amp;&amp;"currency"===n["[[style]]"]){var A=n["[[currency]]"],R=void 0;"code"===n["[[currencyDisplay]]"]?R=A:"symbol"===n["[[currencyDisplay]]"]?R=o.currencies[A]||A:"name"===n["[[currencyDisplay]]"]&amp;&amp;(R=A),Ge.call(u,{"[[type]]":"currency","[[value]]":R})}else{var q=c.substring(g,f);Ge.call(u,{"[[type]]":"literal","[[value]]":q})}m=f+1,g=c.indexOf("{",m)}if(m&lt;v){var C=c.substring(m,v);Ge.call(u,{"[[type]]":"literal","[[value]]":C})}return u}function T(e,r){for(var t=N(e,r),n="",a=0;t.length&gt;a;a++){var i=t[a];n+=i["[[value]]"]}return n}function _(r,t,n){var a=n,i=void 0,o=void 0;if(0===r)i=Ze.call(Array(a+1),"0"),o=0;else{o=e(Math.abs(r));var s=Math.round(Math.exp(Math.abs(o-a+1)*Math.LN10));i=String(Math.round(o-a+1&lt;0?r*s:r/s))}if(o&gt;=a)return i+Ze.call(Array(o-a+1+1),"0");if(o===a-1)return i;if(o&gt;=0?i=i.slice(0,o+1)+"."+i.slice(o+1):o&lt;0&amp;&amp;(i="0."+Ze.call(Array(-(o+1)+1),"0")+i),i.indexOf(".")&gt;=0&amp;&amp;n&gt;t){for(var l=n-t;l&gt;0&amp;&amp;"0"===i.charAt(i.length-1);)i=i.slice(0,-1),l--;"."===i.charAt(i.length-1)&amp;&amp;(i=i.slice(0,-1))}return i}function M(e,r,t,n){var a=n,i=Math.pow(10,a)*e,o=0===i?"0":i.toFixed(0),s=void 0,l=(s=o.indexOf("e"))&gt;-1?o.slice(s+1):0;l&amp;&amp;(o=o.slice(0,s).replace(".",""),o+=Ze.call(Array(l-(o.length-1)+1),"0"));var c=void 0;if(0!==a){var u=o.length;if(u&lt;=a){var g=Ze.call(Array(a+1-u+1),"0");o=g+o,u=a+1}var f=o.substring(0,u-a),m=o.substring(u-a,o.length);o=f+"."+m,c=f.length}else c=o.length;for(var v=n-t;v&gt;0&amp;&amp;"0"===o.slice(-1);)o=o.slice(0,-1),v--;if("."===o.slice(-1)&amp;&amp;(o=o.slice(0,-1)),c&lt;r){var d=Ze.call(Array(r-c+1),"0");o=d+o}return o}function I(e){for(var r=0;r&lt;wr.length;r+=1)if(e.hasOwnProperty(wr[r]))return!1;return!0}function A(e){for(var r=0;r&lt;br.length;r+=1)if(e.hasOwnProperty(br[r]))return!1;return!0}function R(e,r){for(var t={_:{}},n=0;n&lt;br.length;n+=1)e[br[n]]&amp;&amp;(t[br[n]]=e[br[n]]),e._[br[n]]&amp;&amp;(t._[br[n]]=e._[br[n]]);for(var a=0;a&lt;wr.length;a+=1)r[wr[a]]&amp;&amp;(t[wr[a]]=r[wr[a]]),r._[wr[a]]&amp;&amp;(t._[wr[a]]=r._[wr[a]]);return t}function q(e){return e.pattern12=e.extendedPattern.replace(/'([^']*)'/g,function(e,r){return r?r:"'"}),e.pattern=e.pattern12.replace("{ampm}","").replace(pr,""),e}function C(e,r){switch(e.charAt(0)){case"G":return r.era=["short","short","short","long","narrow"][e.length-1],"{era}";case"y":case"Y":case"u":case"U":case"r":return r.year=2===e.length?"2-digit":"numeric","{year}";case"Q":case"q":return r.quarter=["numeric","2-digit","short","long","narrow"][e.length-1],"{quarter}";case"M":case"L":return r.month=["numeric","2-digit","short","long","narrow"][e.length-1],"{month}";case"w":return r.week=2===e.length?"2-digit":"numeric","{weekday}";case"W":return r.week="numeric","{weekday}";case"d":return r.day=2===e.length?"2-digit":"numeric","{day}";case"D":case"F":case"g":return r.day="numeric","{day}";case"E":return r.weekday=["short","short","short","long","narrow","short"][e.length-1],"{weekday}";case"e":return r.weekday=["numeric","2-digit","short","long","narrow","short"][e.length-1],"{weekday}";case"c":return r.weekday=["numeric",void 0,"short","long","narrow","short"][e.length-1],"{weekday}";case"a":case"b":case"B":return r.hour12=!0,"{ampm}";case"h":case"H":return r.hour=2===e.length?"2-digit":"numeric","{hour}";case"k":case"K":return r.hour12=!0,r.hour=2===e.length?"2-digit":"numeric","{hour}";case"m":return r.minute=2===e.length?"2-digit":"numeric","{minute}";case"s":return r.second=2===e.length?"2-digit":"numeric","{second}";case"S":case"A":return r.second="numeric","{second}";case"z":case"Z":case"O":case"v":case"V":case"X":case"x":return r.timeZoneName=e.length&lt;4?"short":"long","{timeZoneName}"}}function G(e,r){if(!yr.test(r)){var t={originalPattern:r,_:{}};return t.extendedPattern=r.replace(hr,function(e){return C(e,t._)}),e.replace(hr,function(e){return C(e,t)}),q(t)}}function Z(e){var r=e.availableFormats,t=e.timeFormats,n=e.dateFormats,a=[],i=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=[],g=[];for(i in r)r.hasOwnProperty(i)&amp;&amp;(o=r[i],s=G(i,o),s&amp;&amp;(a.push(s),I(s)?g.push(s):A(s)&amp;&amp;u.push(s)));for(i in t)t.hasOwnProperty(i)&amp;&amp;(o=t[i],s=G(i,o),s&amp;&amp;(a.push(s),u.push(s)));for(i in n)n.hasOwnProperty(i)&amp;&amp;(o=n[i],s=G(i,o),s&amp;&amp;(a.push(s),g.push(s)));for(l=0;l&lt;u.length;l+=1)for(c=0;c&lt;g.length;c+=1)o="long"===g[c].month?g[c].weekday?e.full:e.long:"short"===g[c].month?e.medium:e.short,s=R(g[c],u[l]),s.originalPattern=o,s.extendedPattern=o.replace("{0}",u[l].extendedPattern).replace("{1}",g[c].extendedPattern).replace(/^[,\s]+|[,\s]+$/gi,""),a.push(q(s));return a}function B(e,r){if(xr[e]&amp;&amp;xr[e][r]){var t;return t={originalPattern:xr[e][r],_:ge({},e,r),extendedPattern:"{"+e+"}"},ge(t,e,r),ge(t,"pattern12","{"+e+"}"),ge(t,"pattern","{"+e+"}"),t}}function U(e,r,t,n,a){var i=e[r]&amp;&amp;e[r][t]?e[r][t]:e.gregory[t],o={narrow:["short","long"],short:["long","narrow"],long:["short","narrow"]},s=Me.call(i,n)?i[n]:Me.call(i,o[n][0])?i[o[n][0]]:i[o[n][1]];return null!==a?s[a]:s}function $(){var e=arguments[0],r=arguments[1];return this&amp;&amp;this!==mr?K(a(this),e,r):new mr.DateTimeFormat(e,r)}function K(e,a,i){var o=l(e),s=n();if(o["[[initializedIntlObject]]"]===!0)throw new TypeError("`this` object has already been initialized as an Intl object");Ie(e,"__getInternalProperties",{value:function(){if(arguments[0]===Ke)return o}}),o["[[initializedIntlObject]]"]=!0;var c=d(a);i=H(i,"any","date");var g=new r,f=D(i,"localeMatcher","string",new t("lookup","best fit"),"best fit");g["[[localeMatcher]]"]=f;var m=$e.DateTimeFormat,v=m["[[localeData]]"],h=b(m["[[availableLocales]]"],c,g,m["[[relevantExtensionKeys]]"],v);o["[[locale]]"]=h["[[locale]]"],o["[[calendar]]"]=h["[[ca]]"],o["[[numberingSystem]]"]=h["[[nu]]"],o["[[dataLocale]]"]=h["[[dataLocale]]"];var p=h["[[dataLocale]]"],y=i.timeZone;if(void 0!==y&amp;&amp;(y=u(y),"UTC"!==y))throw new RangeError("timeZone is not supported.");o["[[timeZone]]"]=y,g=new r;for(var w in Dr)if(Me.call(Dr,w)){var x=D(i,w,"string",Dr[w]);g["[["+w+"]]"]=x}var j=void 0,z=v[p],k=Y(z.formats);if(f=D(i,"formatMatcher","string",new t("basic","best fit"),"best fit"),z.formats=k,"basic"===f)j=W(g,k);else{var O=D(i,"hour12","boolean");g.hour12=void 0===O?z.hour12:O,j=X(g,k)}for(var F in Dr)if(Me.call(Dr,F)&amp;&amp;Me.call(j,F)){var S=j[F];S=j._&amp;&amp;Me.call(j._,F)?j._[F]:S,o["[["+F+"]]"]=S}var E=void 0,L=D(i,"hour12","boolean");if(o["[[hour]]"])if(L=void 0===L?z.hour12:L,o["[[hour12]]"]=L,L===!0){var P=z.hourNo0;o["[[hourNo0]]"]=P,E=j.pattern12}else E=j.pattern;else E=j.pattern;return o["[[pattern]]"]=E,o["[[boundFormat]]"]=void 0,o["[[initializedDateTimeFormat]]"]=!0,_e&amp;&amp;(e.format=V.call(e)),s(),e}function Y(e){return"[object Array]"===Object.prototype.toString.call(e)?e:Z(e)}function H(e,t,n){if(void 0===e)e=null;else{var i=a(e);e=new r;for(var o in i)e[o]=i[o]}var s=Re;e=s(e);var l=!0;return"date"!==t&amp;&amp;"any"!==t||void 0===e.weekday&amp;&amp;void 0===e.year&amp;&amp;void 0===e.month&amp;&amp;void 0===e.day||(l=!1),"time"!==t&amp;&amp;"any"!==t||void 0===e.hour&amp;&amp;void 0===e.minute&amp;&amp;void 0===e.second||(l=!1),!l||"date"!==n&amp;&amp;"all"!==n||(e.year=e.month=e.day="numeric"),!l||"time"!==n&amp;&amp;"all"!==n||(e.hour=e.minute=e.second="numeric"),e}function W(e,r){for(var t=120,n=20,a=8,i=6,o=6,s=3,l=-(1/0),c=void 0,u=0,g=r.length;u&lt;g;){var f=r[u],m=0;for(var v in Dr)if(Me.call(Dr,v)){var d=e["[["+v+"]]"],h=Me.call(f,v)?f[v]:void 0;if(void 0===d&amp;&amp;void 0!==h)m-=n;else if(void 0!==d&amp;&amp;void 0===h)m-=t;else{var p=["2-digit","numeric","narrow","short","long"],y=Ae.call(p,d),b=Ae.call(p,h),w=Math.max(Math.min(b-y,2),-2);2===w?m-=i:1===w?m-=s:w===-1?m-=o:w===-2&amp;&amp;(m-=a)}}m&gt;l&amp;&amp;(l=m,c=f),u++}return c}function X(e,r){var t=[];for(var n in Dr)Me.call(Dr,n)&amp;&amp;void 0!==e["[["+n+"]]"]&amp;&amp;t.push(n);if(1===t.length){var a=B(t[0],e["[["+t[0]+"]]"]);if(a)return a}for(var i=120,o=20,s=8,l=6,c=6,u=3,g=2,f=1,m=-(1/0),v=void 0,d=0,h=r.length;d&lt;h;){var p=r[d],y=0;for(var b in Dr)if(Me.call(Dr,b)){var w=e["[["+b+"]]"],x=Me.call(p,b)?p[b]:void 0,j=Me.call(p._,b)?p._[b]:void 0;if(w!==j&amp;&amp;(y-=g),void 0===w&amp;&amp;void 0!==x)y-=o;else if(void 0!==w&amp;&amp;void 0===x)y-=i;else{var D=["2-digit","numeric","narrow","short","long"],z=Ae.call(D,w),k=Ae.call(D,x),O=Math.max(Math.min(k-z,2),-2);k&lt;=1&amp;&amp;z&gt;=2||k&gt;=2&amp;&amp;z&lt;=1?O&gt;0?y-=l:O&lt;0&amp;&amp;(y-=s):O&gt;1?y-=u:O&lt;-1&amp;&amp;(y-=c)}}p._.hour12!==e.hour12&amp;&amp;(y-=f),y&gt;m&amp;&amp;(m=y,v=p),d++}return v}function V(){var e=null!==this&amp;&amp;"object"===Ne.typeof(this)&amp;&amp;l(this);if(!e||!e["[[initializedDateTimeFormat]]"])throw new TypeError("`this` value for format() is not an initialized Intl.DateTimeFormat object.");if(void 0===e["[[boundFormat]]"]){var r=function(){var e=arguments.length&lt;=0||void 0===arguments[0]?void 0:arguments[0],r=void 0===e?Date.now():i(e);return ee(this,r)},t=Ue.call(r,this);e["[[boundFormat]]"]=t}return e["[[boundFormat]]"]}function J(){var e=arguments.length&lt;=0||void 0===arguments[0]?void 0:arguments[0],r=null!==this&amp;&amp;"object"===Ne.typeof(this)&amp;&amp;l(this);if(!r||!r["[[initializedDateTimeFormat]]"])throw new TypeError("`this` value for formatToParts() is not an initialized Intl.DateTimeFormat object.");var t=void 0===e?Date.now():i(e);return re(this,t)}function Q(e,r){if(!isFinite(r))throw new RangeError("Invalid valid date passed to format");var a=e.__getInternalProperties(Ke);n();for(var i=a["[[locale]]"],o=new mr.NumberFormat([i],{useGrouping:!1}),s=new mr.NumberFormat([i],{minimumIntegerDigits:2,useGrouping:!1}),l=te(r,a["[[calendar]]"],a["[[timeZone]]"]),c=a["[[pattern]]"],u=new t,g=0,f=c.indexOf("{"),m=0,v=a["[[dataLocale]]"],d=$e.DateTimeFormat["[[localeData]]"][v].calendars,h=a["[[calendar]]"];f!==-1;){var p=void 0;if(m=c.indexOf("}",f),m===-1)throw new Error("Unclosed pattern");f&gt;g&amp;&amp;Ge.call(u,{type:"literal",value:c.substring(g,f)});var y=c.substring(f+1,m);if(Dr.hasOwnProperty(y)){var b=a["[["+y+"]]"],w=l["[["+y+"]]"];if("year"===y&amp;&amp;w&lt;=0?w=1-w:"month"===y?w++:"hour"===y&amp;&amp;a["[[hour12]]"]===!0&amp;&amp;(w%=12,0===w&amp;&amp;a["[[hourNo0]]"]===!0&amp;&amp;(w=12)),"numeric"===b)p=T(o,w);else if("2-digit"===b)p=T(s,w),p.length&gt;2&amp;&amp;(p=p.slice(-2));else if(b in jr)switch(y){case"month":p=U(d,h,"months",b,l["[["+y+"]]"]);break;case"weekday":try{p=U(d,h,"days",b,l["[["+y+"]]"])}catch(e){throw new Error("Could not find weekday data for locale "+i)}break;case"timeZoneName":p="";break;case"era":try{p=U(d,h,"eras",b,l["[["+y+"]]"])}catch(e){throw new Error("Could not find era data for locale "+i)}break;default:p=l["[["+y+"]]"]}Ge.call(u,{type:y,value:p})}else if("ampm"===y){var x=l["[[hour]]"];p=U(d,h,"dayPeriods",x&gt;11?"pm":"am",null),Ge.call(u,{type:"dayPeriod",value:p})}else Ge.call(u,{type:"literal",value:c.substring(f,m+1)});g=m+1,f=c.indexOf("{",g)}return m&lt;c.length-1&amp;&amp;Ge.call(u,{type:"literal",value:c.substr(m+1)}),u}function ee(e,r){for(var t=Q(e,r),n="",a=0;t.length&gt;a;a++){var i=t[a];n+=i.value}return n}function re(e,r){for(var t=Q(e,r),n=[],a=0;t.length&gt;a;a++){var i=t[a];n.push({type:i.type,value:i.value})}return n}function te(e,t,n){var a=new Date(e),i="get"+(n||"");return new r({"[[weekday]]":a[i+"Day"](),"[[era]]":+(a[i+"FullYear"]()&gt;=0),"[[year]]":a[i+"FullYear"](),"[[month]]":a[i+"Month"](),"[[day]]":a[i+"Date"](),"[[hour]]":a[i+"Hours"](),"[[minute]]":a[i+"Minutes"](),"[[second]]":a[i+"Seconds"](),"[[inDST]]":!1})}function ne(e,r){if(!e.number)throw new Error("Object passed doesn't contain locale data for Intl.NumberFormat");var t=void 0,n=[r],a=r.split("-");for(a.length&gt;2&amp;&amp;4===a[1].length&amp;&amp;Ge.call(n,a[0]+"-"+a[2]);t=Be.call(n);)Ge.call($e.NumberFormat["[[availableLocales]]"],t),$e.NumberFormat["[[localeData]]"][t]=e.number,e.date&amp;&amp;(e.date.nu=e.number.nu,Ge.call($e.DateTimeFormat["[[availableLocales]]"],t),$e.DateTimeFormat["[[localeData]]"][t]=e.date);void 0===cr&amp;&amp;c(r)}var ae="function"==typeof Symbol&amp;&amp;"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&amp;&amp;"function"==typeof Symbol&amp;&amp;e.constructor===Symbol?"symbol":typeof e},ie=function(){var e="function"==typeof Symbol&amp;&amp;Symbol.for&amp;&amp;Symbol.for("react.element")||60103;return function(r,t,n,a){var i=r&amp;&amp;r.defaultProps,o=arguments.length-3;if(t||0===o||(t={}),t&amp;&amp;i)for(var s in i)void 0===t[s]&amp;&amp;(t[s]=i[s]);else t||(t=i||{});if(1===o)t.children=a;else if(o&gt;1){for(var l=Array(o),c=0;c&lt;o;c++)l[c]=arguments[c+3];t.children=l}return{$$typeof:e,type:r,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}}(),oe=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(a,i){try{var o=r[a](i),s=o.value}catch(e){return void t(e)}return o.done?void e(s):Promise.resolve(s).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}},se=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},le=function(){function e(e,r){for(var t=0;t&lt;r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&amp;&amp;(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&amp;&amp;e(r.prototype,t),n&amp;&amp;e(r,n),r}}(),ce=function(e,r){for(var t in r){var n=r[t];n.configurable=n.enumerable=!0,"value"in n&amp;&amp;(n.writable=!0),Object.defineProperty(e,t,n)}return e},ue=function(e,r){for(var t=Object.getOwnPropertyNames(r),n=0;n&lt;t.length;n++){var a=t[n],i=Object.getOwnPropertyDescriptor(r,a);i&amp;&amp;i.configurable&amp;&amp;void 0===e[a]&amp;&amp;Object.defineProperty(e,a,i)}return e},ge=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},fe=Object.assign||function(e){for(var r=1;r&lt;arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&amp;&amp;(e[n]=t[n])}return e},me=function e(r,t,n){null===r&amp;&amp;(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,t);if(void 0===a){var i=Object.getPrototypeOf(r);return null===i?void 0:e(i,t,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},ve=function(e,r){if("function"!=typeof r&amp;&amp;null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&amp;&amp;r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&amp;&amp;(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},de=function(e,r){return null!=r&amp;&amp;"undefined"!=typeof Symbol&amp;&amp;r[Symbol.hasInstance]?r[Symbol.hasInstance](e):e instanceof r},he=function(e){return e&amp;&amp;e.__esModule?e:{default:e}},pe=function(e){if(e&amp;&amp;e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&amp;&amp;(r[t]=e[t]);return r.default=e,r},ye=function(e,r){if(e!==r)throw new TypeError("Cannot instantiate an arrow function")},be=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},we=function(e,r){var t={};for(var n in e)r.indexOf(n)&gt;=0||Object.prototype.hasOwnProperty.call(e,n)&amp;&amp;(t[n]=e[n]);return t},xe=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&amp;&amp;"function"!=typeof r?e:r},je="undefined"==typeof global?self:global,De=function e(r,t,n,a){var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var o=Object.getPrototypeOf(r);null!==o&amp;&amp;e(o,t,n,a)}else if("value"in i&amp;&amp;i.writable)i.value=n;else{var s=i.set;void 0!==s&amp;&amp;s.call(a,n)}return n},ze=function(){function e(e,r){var t=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&amp;&amp;(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){a=!0,i=e}finally{try{!n&amp;&amp;s.return&amp;&amp;s.return()}finally{if(a)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ke=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var t,n=[],a=e[Symbol.iterator]();!(t=a.next()).done&amp;&amp;(n.push(t.value),!r||n.length!==r););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},Oe=function(e,r){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))},Fe=function(e,r){return e.raw=r,e},Se=function(e,r,t){if(e===t)throw new ReferenceError(r+" is not defined - temporal dead zone");return e},Ee={},Le=function(e){return Array.isArray(e)?e:Array.from(e)},Pe=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r&lt;e.length;r++)t[r]=e[r];return t}return Array.from(e)},Ne=Object.freeze({jsx:ie,asyncToGenerator:oe,classCallCheck:se,createClass:le,defineEnumerableProperties:ce,defaults:ue,defineProperty:ge,get:me,inherits:ve,interopRequireDefault:he,interopRequireWildcard:pe,newArrowCheck:ye,objectDestructuringEmpty:be,objectWithoutProperties:we,possibleConstructorReturn:xe,selfGlobal:je,set:De,slicedToArray:ze,slicedToArrayLoose:ke,taggedTemplateLiteral:Oe,taggedTemplateLiteralLoose:Fe,temporalRef:Se,temporalUndefined:Ee,toArray:Le,toConsumableArray:Pe,typeof:ae,extends:fe,instanceof:de}),Te=function(){var e=function(){};try{return Object.defineProperty(e,"a",{get:function(){return 1}}),Object.defineProperty(e,"prototype",{writable:!1}),1===e.a&amp;&amp;e.prototype instanceof Object}catch(e){return!1}}(),_e=!Te&amp;&amp;!Object.prototype.__defineGetter__,Me=Object.prototype.hasOwnProperty,Ie=Te?Object.defineProperty:function(e,r,t){"get"in t&amp;&amp;e.__defineGetter__?e.__defineGetter__(r,t.get):(!Me.call(e,r)||"value"in t)&amp;&amp;(e[r]=t.value)},Ae=Array.prototype.indexOf||function(e){var r=this;if(!r.length)return-1;for(var t=arguments[1]||0,n=r.length;t&lt;n;t++)if(r[t]===e)return t;return-1},Re=Object.create||function(e,r){function t(){}var n=void 0;t.prototype=e,n=new t;for(var a in r)Me.call(r,a)&amp;&amp;Ie(n,a,r[a]);return n},qe=Array.prototype.slice,Ce=Array.prototype.concat,Ge=Array.prototype.push,Ze=Array.prototype.join,Be=Array.prototype.shift,Ue=Function.prototype.bind||function(e){var r=this,t=qe.call(arguments,1);return 1===r.length?function(){return r.apply(e,Ce.call(t,qe.call(arguments)))}:function(){return r.apply(e,Ce.call(t,qe.call(arguments)))}},$e=Re(null),Ke=Math.random();r.prototype=Re(null),t.prototype=Re(null);var Ye="[a-z]{3}(?:-[a-z]{3}){0,2}",He="(?:[a-z]{2,3}(?:-"+Ye+")?|[a-z]{4}|[a-z]{5,8})",We="[a-z]{4}",Xe="(?:[a-z]{2}|\\d{3})",Ve="(?:[a-z0-9]{5,8}|\\d[a-z0-9]{3})",Je="[0-9a-wy-z]",Qe=Je+"(?:-[a-z0-9]{2,8})+",er="x(?:-[a-z0-9]{1,8})+",rr="(?:en-GB-oed|i-(?:ami|bnn|default|enochian|hak|klingon|lux|mingo|navajo|pwn|tao|tay|tsu)|sgn-(?:BE-FR|BE-NL|CH-DE))",tr="(?:art-lojban|cel-gaulish|no-bok|no-nyn|zh-(?:guoyu|hakka|min|min-nan|xiang))",nr="(?:"+rr+"|"+tr+")",ar=He+"(?:-"+We+")?(?:-"+Xe+")?(?:-"+Ve+")*(?:-"+Qe+")*(?:-"+er+")?",ir=RegExp("^(?:"+ar+"|"+er+"|"+nr+")$","i"),or=RegExp("^(?!x).*?-("+Ve+")-(?:\\w{4,8}-(?!x-))*\\1\\b","i"),sr=RegExp("^(?!x).*?-("+Je+")-(?:\\w+-(?!x-))*\\1\\b","i"),lr=RegExp("-"+Qe,"ig"),cr=void 0,ur={tags:{"art-lojban":"jbo","i-ami":"ami","i-bnn":"bnn","i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","no-bok":"nb","no-nyn":"nn","sgn-BE-FR":"sfb","sgn-BE-NL":"vgt","sgn-CH-DE":"sgg","zh-guoyu":"cmn","zh-hakka":"hak","zh-min-nan":"nan","zh-xiang":"hsn","sgn-BR":"bzs","sgn-CO":"csn","sgn-DE":"gsg","sgn-DK":"dsl","sgn-ES":"ssp","sgn-FR":"fsl","sgn-GB":"bfi","sgn-GR":"gss","sgn-IE":"isg","sgn-IT":"ise","sgn-JP":"jsl","sgn-MX":"mfs","sgn-NI":"ncs","sgn-NL":"dse","sgn-NO":"nsl","sgn-PT":"psr","sgn-SE":"swl","sgn-US":"ase","sgn-ZA":"sfs","zh-cmn":"cmn","zh-cmn-Hans":"cmn-Hans","zh-cmn-Hant":"cmn-Hant","zh-gan":"gan","zh-wuu":"wuu","zh-yue":"yue"},subtags:{BU:"MM",DD:"DE",FX:"FR",TP:"TL",YD:"YE",ZR:"CD",heploc:"alalc97",in:"id",iw:"he",ji:"yi",jw:"jv",mo:"ro",ayx:"nun",bjd:"drl",ccq:"rki",cjr:"mom",cka:"cmr",cmk:"xch",drh:"khk",drw:"prs",gav:"dev",hrr:"jal",ibi:"opa",kgh:"kml",lcq:"ppr",mst:"mry",myt:"mry",sca:"hle",tie:"ras",tkk:"twm",tlw:"weo",tnf:"prs",ybd:"rki",yma:"lrr"},extLang:{aao:["aao","ar"],abh:["abh","ar"],abv:["abv","ar"],acm:["acm","ar"],acq:["acq","ar"],acw:["acw","ar"],acx:["acx","ar"],acy:["acy","ar"],adf:["adf","ar"],ads:["ads","sgn"],aeb:["aeb","ar"],aec:["aec","ar"],aed:["aed","sgn"],aen:["aen","sgn"],afb:["afb","ar"],afg:["afg","sgn"],ajp:["ajp","ar"],apc:["apc","ar"],apd:["apd","ar"],arb:["arb","ar"],arq:["arq","ar"],ars:["ars","ar"],ary:["ary","ar"],arz:["arz","ar"],ase:["ase","sgn"],asf:["asf","sgn"],asp:["asp","sgn"],asq:["asq","sgn"],asw:["asw","sgn"],auz:["auz","ar"],avl:["avl","ar"],ayh:["ayh","ar"],ayl:["ayl","ar"],ayn:["ayn","ar"],ayp:["ayp","ar"],bbz:["bbz","ar"],bfi:["bfi","sgn"],bfk:["bfk","sgn"],bjn:["bjn","ms"],bog:["bog","sgn"],bqn:["bqn","sgn"],bqy:["bqy","sgn"],btj:["btj","ms"],bve:["bve","ms"],bvl:["bvl","sgn"],bvu:["bvu","ms"],bzs:["bzs","sgn"],cdo:["cdo","zh"],cds:["cds","sgn"],cjy:["cjy","zh"],cmn:["cmn","zh"],coa:["coa","ms"],cpx:["cpx","zh"],csc:["csc","sgn"],csd:["csd","sgn"],cse:["cse","sgn"],csf:["csf","sgn"],csg:["csg","sgn"],csl:["csl","sgn"],csn:["csn","sgn"],csq:["csq","sgn"],csr:["csr","sgn"],czh:["czh","zh"],czo:["czo","zh"],doq:["doq","sgn"],dse:["dse","sgn"],dsl:["dsl","sgn"],dup:["dup","ms"],ecs:["ecs","sgn"],esl:["esl","sgn"],esn:["esn","sgn"],eso:["eso","sgn"],eth:["eth","sgn"],fcs:["fcs","sgn"],fse:["fse","sgn"],fsl:["fsl","sgn"],fss:["fss","sgn"],gan:["gan","zh"],gds:["gds","sgn"],gom:["gom","kok"],gse:["gse","sgn"],gsg:["gsg","sgn"],gsm:["gsm","sgn"],gss:["gss","sgn"],gus:["gus","sgn"],hab:["hab","sgn"],haf:["haf","sgn"],hak:["hak","zh"],hds:["hds","sgn"],hji:["hji","ms"],hks:["hks","sgn"],hos:["hos","sgn"],hps:["hps","sgn"],hsh:["hsh","sgn"],hsl:["hsl","sgn"],hsn:["hsn","zh"],icl:["icl","sgn"],ils:["ils","sgn"],inl:["inl","sgn"],ins:["ins","sgn"],</span></p>
<p class="p1"><span class="s1">ise:["ise","sgn"],isg:["isg","sgn"],isr:["isr","sgn"],jak:["jak","ms"],jax:["jax","ms"],jcs:["jcs","sgn"],jhs:["jhs","sgn"],jls:["jls","sgn"],jos:["jos","sgn"],jsl:["jsl","sgn"],jus:["jus","sgn"],kgi:["kgi","sgn"],knn:["knn","kok"],kvb:["kvb","ms"],kvk:["kvk","sgn"],kvr:["kvr","ms"],kxd:["kxd","ms"],lbs:["lbs","sgn"],lce:["lce","ms"],lcf:["lcf","ms"],liw:["liw","ms"],lls:["lls","sgn"],lsg:["lsg","sgn"],lsl:["lsl","sgn"],lso:["lso","sgn"],lsp:["lsp","sgn"],lst:["lst","sgn"],lsy:["lsy","sgn"],ltg:["ltg","lv"],lvs:["lvs","lv"],lzh:["lzh","zh"],max:["max","ms"],mdl:["mdl","sgn"],meo:["meo","ms"],mfa:["mfa","ms"],mfb:["mfb","ms"],mfs:["mfs","sgn"],min:["min","ms"],mnp:["mnp","zh"],mqg:["mqg","ms"],mre:["mre","sgn"],msd:["msd","sgn"],msi:["msi","ms"],msr:["msr","sgn"],mui:["mui","ms"],mzc:["mzc","sgn"],mzg:["mzg","sgn"],mzy:["mzy","sgn"],nan:["nan","zh"],nbs:["nbs","sgn"],ncs:["ncs","sgn"],nsi:["nsi","sgn"],nsl:["nsl","sgn"],nsp:["nsp","sgn"],nsr:["nsr","sgn"],nzs:["nzs","sgn"],okl:["okl","sgn"],orn:["orn","ms"],ors:["ors","ms"],pel:["pel","ms"],pga:["pga","ar"],pks:["pks","sgn"],prl:["prl","sgn"],prz:["prz","sgn"],psc:["psc","sgn"],psd:["psd","sgn"],pse:["pse","ms"],psg:["psg","sgn"],psl:["psl","sgn"],pso:["pso","sgn"],psp:["psp","sgn"],psr:["psr","sgn"],pys:["pys","sgn"],rms:["rms","sgn"],rsi:["rsi","sgn"],rsl:["rsl","sgn"],sdl:["sdl","sgn"],sfb:["sfb","sgn"],sfs:["sfs","sgn"],sgg:["sgg","sgn"],sgx:["sgx","sgn"],shu:["shu","ar"],slf:["slf","sgn"],sls:["sls","sgn"],sqk:["sqk","sgn"],sqs:["sqs","sgn"],ssh:["ssh","ar"],ssp:["ssp","sgn"],ssr:["ssr","sgn"],svk:["svk","sgn"],swc:["swc","sw"],swh:["swh","sw"],swl:["swl","sgn"],syy:["syy","sgn"],tmw:["tmw","ms"],tse:["tse","sgn"],tsm:["tsm","sgn"],tsq:["tsq","sgn"],tss:["tss","sgn"],tsy:["tsy","sgn"],tza:["tza","sgn"],ugn:["ugn","sgn"],ugy:["ugy","sgn"],ukl:["ukl","sgn"],uks:["uks","sgn"],urk:["urk","ms"],uzn:["uzn","uz"],uzs:["uzs","uz"],vgt:["vgt","sgn"],vkk:["vkk","ms"],vkt:["vkt","ms"],vsi:["vsi","sgn"],vsl:["vsl","sgn"],vsv:["vsv","sgn"],wuu:["wuu","zh"],xki:["xki","sgn"],xml:["xml","sgn"],xmm:["xmm","ms"],xms:["xms","sgn"],yds:["yds","sgn"],ysl:["ysl","sgn"],yue:["yue","zh"],zib:["zib","sgn"],zlm:["zlm","ms"],zmi:["zmi","ms"],zsl:["zsl","sgn"],zsm:["zsm","ms"]}},gr=/^[A-Z]{3}$/,fr=/-u(?:-[0-9a-z]{2,8})+/gi,mr={};Object.defineProperty(mr,"getCanonicalLocales",{enumerable:!1,configurable:!0,writable:!0,value:k});var vr={BHD:3,BYR:0,XOF:0,BIF:0,XAF:0,CLF:4,CLP:0,KMF:0,DJF:0,XPF:0,GNF:0,ISK:0,IQD:3,JPY:0,JOD:3,KRW:0,KWD:3,LYD:3,OMR:3,PYG:0,RWF:0,TND:3,UGX:0,UYI:0,VUV:0,VND:0};Ie(mr,"NumberFormat",{configurable:!0,writable:!0,value:O}),Ie(mr.NumberFormat,"prototype",{writable:!1}),$e.NumberFormat={"[[availableLocales]]":[],"[[relevantExtensionKeys]]":["nu"],"[[localeData]]":{}},Ie(mr.NumberFormat,"supportedLocalesOf",{configurable:!0,writable:!0,value:Ue.call(function(e){if(!Me.call(this,"[[availableLocales]]"))throw new TypeError("supportedLocalesOf() is not a constructor");var r=n(),t=arguments[1],a=this["[[availableLocales]]"],i=d(e);return r(),j(a,i,t)},$e.NumberFormat)}),Ie(mr.NumberFormat.prototype,"format",{configurable:!0,get:E}),Object.defineProperty(mr.NumberFormat.prototype,"formatToParts",{configurable:!0,enumerable:!1,writable:!0,value:L});var dr={arab:["</span><span class="s2">٠</span><span class="s1">","</span><span class="s2">١</span><span class="s1">","</span><span class="s2">٢</span><span class="s1">","</span><span class="s2">٣</span><span class="s1">","</span><span class="s2">٤</span><span class="s1">","</span><span class="s2">٥</span><span class="s1">","</span><span class="s2">٦</span><span class="s1">","</span><span class="s2">٧</span><span class="s1">","</span><span class="s2">٨</span><span class="s1">","</span><span class="s2">٩</span><span class="s1">"],arabext:["</span><span class="s2">۰</span><span class="s1">","</span><span class="s2">۱</span><span class="s1">","</span><span class="s2">۲</span><span class="s1">","</span><span class="s2">۳</span><span class="s1">","</span><span class="s2">۴</span><span class="s1">","</span><span class="s2">۵</span><span class="s1">","</span><span class="s2">۶</span><span class="s1">","</span><span class="s2">۷</span><span class="s1">","</span><span class="s2">۸</span><span class="s1">","</span><span class="s2">۹</span><span class="s1">"],bali:["</span><span class="s3">᭐</span><span class="s1">","</span><span class="s3">᭑</span><span class="s1">","</span><span class="s3">᭒</span><span class="s1">","</span><span class="s3">᭓</span><span class="s1">","</span><span class="s3">᭔</span><span class="s1">","</span><span class="s3">᭕</span><span class="s1">","</span><span class="s3">᭖</span><span class="s1">","</span><span class="s3">᭗</span><span class="s1">","</span><span class="s3">᭘</span><span class="s1">","</span><span class="s3">᭙</span><span class="s1">"],beng:["</span><span class="s4">০</span><span class="s1">","</span><span class="s4">১</span><span class="s1">","</span><span class="s4">২</span><span class="s1">","</span><span class="s4">৩</span><span class="s1">","</span><span class="s4">৪</span><span class="s1">","</span><span class="s4">৫</span><span class="s1">","</span><span class="s4">৬</span><span class="s1">","</span><span class="s4">৭</span><span class="s1">","</span><span class="s4">৮</span><span class="s1">","</span><span class="s4">৯</span><span class="s1">"],deva:["</span><span class="s5">०</span><span class="s1">","</span><span class="s5">१</span><span class="s1">","</span><span class="s5">२</span><span class="s1">","</span><span class="s5">३</span><span class="s1">","</span><span class="s5">४</span><span class="s1">","</span><span class="s5">५</span><span class="s1">","</span><span class="s5">६</span><span class="s1">","</span><span class="s5">७</span><span class="s1">","</span><span class="s5">८</span><span class="s1">","</span><span class="s5">९</span><span class="s1">"],fullwide:["</span><span class="s6">０</span><span class="s1">","</span><span class="s6">１</span><span class="s1">","</span><span class="s6">２</span><span class="s1">","</span><span class="s6">３</span><span class="s1">","</span><span class="s6">４</span><span class="s1">","</span><span class="s6">５</span><span class="s1">","</span><span class="s6">６</span><span class="s1">","</span><span class="s6">７</span><span class="s1">","</span><span class="s6">８</span><span class="s1">","</span><span class="s6">９</span><span class="s1">"],gujr:["</span><span class="s7">૦</span><span class="s1">","</span><span class="s7">૧</span><span class="s1">","</span><span class="s7">૨</span><span class="s1">","</span><span class="s7">૩</span><span class="s1">","</span><span class="s7">૪</span><span class="s1">","</span><span class="s7">૫</span><span class="s1">","</span><span class="s7">૬</span><span class="s1">","</span><span class="s7">૭</span><span class="s1">","</span><span class="s7">૮</span><span class="s1">","</span><span class="s7">૯</span><span class="s1">"],guru:["</span><span class="s8">੦</span><span class="s1">","</span><span class="s8">੧</span><span class="s1">","</span><span class="s8">੨</span><span class="s1">","</span><span class="s8">੩</span><span class="s1">","</span><span class="s8">੪</span><span class="s1">","</span><span class="s8">੫</span><span class="s1">","</span><span class="s8">੬</span><span class="s1">","</span><span class="s8">੭</span><span class="s1">","</span><span class="s8">੮</span><span class="s1">","</span><span class="s8">੯</span><span class="s1">"],hanidec:["</span><span class="s6">〇</span><span class="s1">","</span><span class="s6">一</span><span class="s1">","</span><span class="s6">二</span><span class="s1">","</span><span class="s6">三</span><span class="s1">","</span><span class="s6">四</span><span class="s1">","</span><span class="s6">五</span><span class="s1">","</span><span class="s6">六</span><span class="s1">","</span><span class="s6">七</span><span class="s1">","</span><span class="s6">八</span><span class="s1">","</span><span class="s6">九</span><span class="s1">"],khmr:["</span><span class="s9">០</span><span class="s1">","</span><span class="s9">១</span><span class="s1">","</span><span class="s9">២</span><span class="s1">","</span><span class="s9">៣</span><span class="s1">","</span><span class="s9">៤</span><span class="s1">","</span><span class="s9">៥</span><span class="s1">","</span><span class="s9">៦</span><span class="s1">","</span><span class="s9">៧</span><span class="s1">","</span><span class="s9">៨</span><span class="s1">","</span><span class="s9">៩</span><span class="s1">"],knda:["</span><span class="s10">೦</span><span class="s1">","</span><span class="s10">೧</span><span class="s1">","</span><span class="s10">೨</span><span class="s1">","</span><span class="s10">೩</span><span class="s1">","</span><span class="s10">೪</span><span class="s1">","</span><span class="s10">೫</span><span class="s1">","</span><span class="s10">೬</span><span class="s1">","</span><span class="s10">೭</span><span class="s1">","</span><span class="s10">೮</span><span class="s1">","</span><span class="s10">೯</span><span class="s1">"],laoo:["</span><span class="s11">໐</span><span class="s1">","</span><span class="s11">໑</span><span class="s1">","</span><span class="s11">໒</span><span class="s1">","</span><span class="s11">໓</span><span class="s1">","</span><span class="s11">໔</span><span class="s1">","</span><span class="s11">໕</span><span class="s1">","</span><span class="s11">໖</span><span class="s1">","</span><span class="s11">໗</span><span class="s1">","</span><span class="s11">໘</span><span class="s1">","</span><span class="s11">໙</span><span class="s1">"],latn:["0","1","2","3","4","5","6","7","8","9"],limb:["</span><span class="s12">᥆</span><span class="s1">","</span><span class="s12">᥇</span><span class="s1">","</span><span class="s12">᥈</span><span class="s1">","</span><span class="s12">᥉</span><span class="s1">","</span><span class="s12">᥊</span><span class="s1">","</span><span class="s12">᥋</span><span class="s1">","</span><span class="s12">᥌</span><span class="s1">","</span><span class="s12">᥍</span><span class="s1">","</span><span class="s12">᥎</span><span class="s1">","</span><span class="s12">᥏</span><span class="s1">"],mlym:["</span><span class="s13">൦</span><span class="s1">","</span><span class="s13">൧</span><span class="s1">","</span><span class="s13">൨</span><span class="s1">","</span><span class="s13">൩</span><span class="s1">","</span><span class="s13">൪</span><span class="s1">","</span><span class="s13">൫</span><span class="s1">","</span><span class="s13">൬</span><span class="s1">","</span><span class="s13">൭</span><span class="s1">","</span><span class="s13">൮</span><span class="s1">","</span><span class="s13">൯</span><span class="s1">"],mong:["</span><span class="s14">᠐</span><span class="s1">","</span><span class="s14">᠑</span><span class="s1">","</span><span class="s14">᠒</span><span class="s1">","</span><span class="s14">᠓</span><span class="s1">","</span><span class="s14">᠔</span><span class="s1">","</span><span class="s14">᠕</span><span class="s1">","</span><span class="s14">᠖</span><span class="s1">","</span><span class="s14">᠗</span><span class="s1">","</span><span class="s14">᠘</span><span class="s1">","</span><span class="s14">᠙</span><span class="s1">"],mymr:["</span><span class="s15">၀</span><span class="s1">","</span><span class="s15">၁</span><span class="s1">","</span><span class="s15">၂</span><span class="s1">","</span><span class="s15">၃</span><span class="s1">","</span><span class="s15">၄</span><span class="s1">","</span><span class="s15">၅</span><span class="s1">","</span><span class="s15">၆</span><span class="s1">","</span><span class="s15">၇</span><span class="s1">","</span><span class="s15">၈</span><span class="s1">","</span><span class="s15">၉</span><span class="s1">"],orya:["</span><span class="s16">୦</span><span class="s1">","</span><span class="s16">୧</span><span class="s1">","</span><span class="s16">୨</span><span class="s1">","</span><span class="s16">୩</span><span class="s1">","</span><span class="s16">୪</span><span class="s1">","</span><span class="s16">୫</span><span class="s1">","</span><span class="s16">୬</span><span class="s1">","</span><span class="s16">୭</span><span class="s1">","</span><span class="s16">୮</span><span class="s1">","</span><span class="s16">୯</span><span class="s1">"],tamldec:["</span><span class="s17">௦</span><span class="s1">","</span><span class="s17">௧</span><span class="s1">","</span><span class="s17">௨</span><span class="s1">","</span><span class="s17">௩</span><span class="s1">","</span><span class="s17">௪</span><span class="s1">","</span><span class="s17">௫</span><span class="s1">","</span><span class="s17">௬</span><span class="s1">","</span><span class="s17">௭</span><span class="s1">","</span><span class="s17">௮</span><span class="s1">","</span><span class="s17">௯</span><span class="s1">"],telu:["</span><span class="s18">౦</span><span class="s1">","</span><span class="s18">౧</span><span class="s1">","</span><span class="s18">౨</span><span class="s1">","</span><span class="s18">౩</span><span class="s1">","</span><span class="s18">౪</span><span class="s1">","</span><span class="s18">౫</span><span class="s1">","</span><span class="s18">౬</span><span class="s1">","</span><span class="s18">౭</span><span class="s1">","</span><span class="s18">౮</span><span class="s1">","</span><span class="s18">౯</span><span class="s1">"],thai:["</span><span class="s19">๐</span><span class="s1">","</span><span class="s19">๑</span><span class="s1">","</span><span class="s19">๒</span><span class="s1">","</span><span class="s19">๓</span><span class="s1">","</span><span class="s19">๔</span><span class="s1">","</span><span class="s19">๕</span><span class="s1">","</span><span class="s19">๖</span><span class="s1">","</span><span class="s19">๗</span><span class="s1">","</span><span class="s19">๘</span><span class="s1">","</span><span class="s19">๙</span><span class="s1">"],tibt:["</span><span class="s20">༠</span><span class="s1">","</span><span class="s20">༡</span><span class="s1">","</span><span class="s20">༢</span><span class="s1">","</span><span class="s20">༣</span><span class="s1">","</span><span class="s20">༤</span><span class="s1">","</span><span class="s20">༥</span><span class="s1">","</span><span class="s20">༦</span><span class="s1">","</span><span class="s20">༧</span><span class="s1">","</span><span class="s20">༨</span><span class="s1">","</span><span class="s20">༩</span><span class="s1">"]};Ie(mr.NumberFormat.prototype,"resolvedOptions",{configurable:!0,writable:!0,value:function(){var e=void 0,t=new r,n=["locale","numberingSystem","style","currency","currencyDisplay","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","useGrouping"],a=null!==this&amp;&amp;"object"===Ne.typeof(this)&amp;&amp;l(this);if(!a||!a["[[initializedNumberFormat]]"])throw new TypeError("`this` value for resolvedOptions() is not an initialized Intl.NumberFormat object.");for(var i=0,o=n.length;i&lt;o;i++)Me.call(a,e="[["+n[i]+"]]")&amp;&amp;(t[n[i]]={value:a[e],writable:!0,configurable:!0,enumerable:!0});return Re({},t)}});var hr=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g,pr=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,yr=/[rqQASjJgwWIQq]/,br=["era","year","month","day","weekday","quarter"],wr=["hour","minute","second","hour12","timeZoneName"],xr={second:{numeric:"s","2-digit":"ss"},minute:{numeric:"m","2-digit":"mm"},year:{numeric:"y","2-digit":"yy"},day:{numeric:"d","2-digit":"dd"},month:{numeric:"L","2-digit":"LL",narrow:"LLLLL",short:"LLL",long:"LLLL"},weekday:{narrow:"ccccc",short:"ccc",long:"cccc"}},jr=Re(null,{narrow:{},short:{},long:{}});Ie(mr,"DateTimeFormat",{configurable:!0,writable:!0,value:$}),Ie($,"prototype",{writable:!1});var Dr={weekday:["narrow","short","long"],era:["narrow","short","long"],year:["2-digit","numeric"],month:["2-digit","numeric","narrow","short","long"],day:["2-digit","numeric"],hour:["2-digit","numeric"],minute:["2-digit","numeric"],second:["2-digit","numeric"],timeZoneName:["short","long"]};$e.DateTimeFormat={"[[availableLocales]]":[],"[[relevantExtensionKeys]]":["ca","nu"],"[[localeData]]":{}},Ie(mr.DateTimeFormat,"supportedLocalesOf",{configurable:!0,writable:!0,value:Ue.call(function(e){if(!Me.call(this,"[[availableLocales]]"))throw new TypeError("supportedLocalesOf() is not a constructor");var r=n(),t=arguments[1],a=this["[[availableLocales]]"],i=d(e);return r(),j(a,i,t)},$e.NumberFormat)}),Ie(mr.DateTimeFormat.prototype,"format",{configurable:!0,get:V}),Object.defineProperty(mr.DateTimeFormat.prototype,"formatToParts",{enumerable:!1,writable:!0,configurable:!0,value:J}),Ie(mr.DateTimeFormat.prototype,"resolvedOptions",{writable:!0,configurable:!0,value:function(){var e=void 0,t=new r,n=["locale","calendar","numberingSystem","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"],a=null!==this&amp;&amp;"object"===Ne.typeof(this)&amp;&amp;l(this);if(!a||!a["[[initializedDateTimeFormat]]"])throw new TypeError("`this` value for resolvedOptions() is not an initialized Intl.DateTimeFormat object.");for(var i=0,o=n.length;i&lt;o;i++)Me.call(a,e="[["+n[i]+"]]")&amp;&amp;(t[n[i]]={value:a[e],writable:!0,configurable:!0,enumerable:!0});return Re({},t)}});var zr=mr.__localeSensitiveProtos={Number:{},Date:{}};if(zr.Number.toLocaleString=function(){if("[object Number]"!==Object.prototype.toString.call(this))throw new TypeError("`this` value must be a number for Number.prototype.toLocaleString()");return T(new O(arguments[0],arguments[1]),this)},zr.Date.toLocaleString=function(){if("[object Date]"!==Object.prototype.toString.call(this))throw new TypeError("`this` value must be a Date instance for Date.prototype.toLocaleString()");var e=+this;if(isNaN(e))return"Invalid Date";var r=arguments[0],t=arguments[1];t=H(t,"any","all");var n=new $(r,t);return ee(n,e)},zr.Date.toLocaleDateString=function(){if("[object Date]"!==Object.prototype.toString.call(this))throw new TypeError("`this` value must be a Date instance for Date.prototype.toLocaleDateString()");var e=+this;if(isNaN(e))return"Invalid Date";var r=arguments[0],t=arguments[1];t=H(t,"date","date");var n=new $(r,t);return ee(n,e)},zr.Date.toLocaleTimeString=function(){if("[object Date]"!==Object.prototype.toString.call(this))throw new TypeError("`this` value must be a Date instance for Date.prototype.toLocaleTimeString()");var e=+this;if(isNaN(e))return"Invalid Date";var r=arguments[0],t=arguments[1];t=H(t,"time","time");var n=new $(r,t);return ee(n,e)},Ie(mr,"__applyLocaleSensitivePrototypes",{writable:!0,configurable:!0,value:function(){Ie(Number.prototype,"toLocaleString",{writable:!0,configurable:!0,value:zr.Number.toLocaleString}),Ie(Date.prototype,"toLocaleString",{writable:!0,configurable:!0,value:zr.Date.toLocaleString});for(var e in zr.Date)Me.call(zr.Date,e)&amp;&amp;Ie(Date.prototype,e,{writable:!0,configurable:!0,value:zr.Date[e]})}}),Ie(mr,"__addLocaleData",{value:function(e){if(!g(e.locale))throw new Error("Object passed doesn't identify itself with a valid language tag");ne(e,e.locale)}}),Ie(mr,"__disableRegExpRestore",{value:function(){$e.disableRegExpRestore=!0}}),"undefined"==typeof Intl)try{window.Intl=mr,mr.__applyLocaleSensitivePrototypes()}catch(e){}return mr});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// JSON</span></p>
<p class="p1"><span class="s1">/*! JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org */</span></p>
<p class="p1"><span class="s1">;(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Detect the `define` function exposed by asynchronous module loaders. The</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// strict `define` check is necessary for compatibility with `r.js`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var isLoader = typeof define === "function" &amp;&amp; define.amd;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// A set of types used to distinguish objects from primitives.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var objectTypes = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"function": true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"object": true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Detect the `exports` object exposed by CommonJS implementations.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var freeExports = objectTypes[typeof exports] &amp;&amp; exports &amp;&amp; !exports.nodeType &amp;&amp; exports;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Use the `global` object exposed by Node (including Browserify via</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// `insert-module-globals`), Narwhal, and Ringo as the default context,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// and the `window` object in browsers. Rhino exports a `global` function</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// instead.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var root = objectTypes[typeof window] &amp;&amp; window || this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>freeGlobal = freeExports &amp;&amp; objectTypes[typeof module] &amp;&amp; module &amp;&amp; !module.nodeType &amp;&amp; typeof global == "object" &amp;&amp; global;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (freeGlobal &amp;&amp; (freeGlobal["global"] === freeGlobal || freeGlobal["window"] === freeGlobal || freeGlobal["self"] === freeGlobal)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>root = freeGlobal;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Public: Initializes JSON 3 using the given `context` object, attaching the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// `stringify` and `parse` functions to the specified `exports` object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function runInContext(context, exports) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>context || (context = root["Object"]());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>exports || (exports = root["Object"]());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Native constructor aliases.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var Number = context["Number"] || root["Number"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>String = context["String"] || root["String"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Object = context["Object"] || root["Object"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Date = context["Date"] || root["Date"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>SyntaxError = context["SyntaxError"] || root["SyntaxError"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>TypeError = context["TypeError"] || root["TypeError"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Math = context["Math"] || root["Math"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>nativeJSON = context["JSON"] || root["JSON"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Delegate to the native `stringify` and `parse` implementations.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof nativeJSON == "object" &amp;&amp; nativeJSON) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>exports.stringify = nativeJSON.stringify;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>exports.parse = nativeJSON.parse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Convenience aliases.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var objectProto = Object.prototype,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>getClass = objectProto.toString,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>isProperty, forEach, undef;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Test the `Date#getUTC*` methods. Based on work by @Yaffle.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var isExtended = new Date(-3509827334573292);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// The `getUTCFullYear`, `Month`, and `Date` methods return nonsensical</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// results for certain dates in Opera &gt;= 10.53.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>isExtended = isExtended.getUTCFullYear() == -109252 &amp;&amp; isExtended.getUTCMonth() === 0 &amp;&amp; isExtended.getUTCDate() === 1 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Safari &lt; 2.0.2 stores the internal millisecond time value correctly,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// but clips the values returned by the date methods to the range of</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// signed 32-bit integers ([-2 ** 31, 2 ** 31 - 1]).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>isExtended.getUTCHours() == 10 &amp;&amp; isExtended.getUTCMinutes() == 37 &amp;&amp; isExtended.getUTCSeconds() == 6 &amp;&amp; isExtended.getUTCMilliseconds() == 708;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} catch (exception) {}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Internal: Determines whether the native `JSON.stringify` and `parse`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// implementations are spec-compliant. Based on work by Ken Snyder.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function has(name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (has[name] !== undef) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Return cached feature test result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return has[name];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var isSupported;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (name == "bug-string-char-index") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// IE &lt;= 7 doesn't support accessing string characters using square</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// bracket notation. IE 8 only supports this for primitives.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>isSupported = "a"[0] != "a";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (name == "json") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Indicates whether both `JSON.stringify` and `JSON.parse` are</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// supported.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>isSupported = has("json-stringify") &amp;&amp; has("json-parse");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var value, serialized = '{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Test `JSON.stringify`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (name == "json-stringify") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var stringify = exports.stringify, stringifySupported = typeof stringify == "function" &amp;&amp; isExtended;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (stringifySupported) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// A test function object with a custom `toJSON` method.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>(value = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}).toJSON = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>stringifySupported =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Firefox 3.1b1 and b2 serialize string, number, and boolean</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// primitives as object literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(0) === "0" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// FF 3.1b1, b2, and JSON 2 serialize wrapped primitives as object</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(new Number()) === "0" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(new String()) == '""' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// FF 3.1b1, 2 throw an error if the value is `null`, `undefined`, or</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// does not define a canonical JSON representation (this applies to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// objects with `toJSON` properties as well, *unless* they are nested</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// within an object or array).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(getClass) === undef &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// IE 8 serializes `undefined` as `"undefined"`. Safari &lt;= 5.1.7 and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// FF 3.1b3 pass this test.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(undef) === undef &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Safari &lt;= 5.1.7 and FF 3.1b3 throw `Error`s and `TypeError`s,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// respectively, if the value is omitted entirely.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify() === undef &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// FF 3.1b1, 2 throw an error if the given value is not a number,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// string, array, object, Boolean, or `null` literal. This applies to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// objects with custom `toJSON` methods as well, unless they are nested</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// inside object or array literals. YUI 3.0.0b1 ignores custom `toJSON`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// methods entirely.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(value) === "1" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify([value]) == "[1]" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Prototype &lt;= 1.6.1 serializes `[undefined]` as `"[]"` instead of</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// `"[null]"`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify([undef]) == "[null]" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// YUI 3.0.0b1 fails to serialize `null` literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(null) == "null" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// FF 3.1b1, 2 halts serialization if an array contains a function:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// `[1, true, getClass, 1]` serializes as "[1,true,],". FF 3.1b3</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// elides non-JSON values from objects and arrays, unless they</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// define custom `toJSON` methods.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify([undef, getClass, null]) == "[null,null,null]" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Simple serialization test. FF 3.1b1 uses Unicode escape sequences</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// where character escape codes are expected (e.g., `\b` =&gt; `\u0008`).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify({ "a": [value, true, false, null, "\x00\b\n\f\r\t"] }) == serialized &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// FF 3.1b1 and b2 ignore the `filter` and `width` arguments.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(null, value) === "1" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify([1, 2], null, 1) == "[\n 1,\n 2\n]" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// JSON 2, Prototype &lt;= 1.7, and older WebKit builds incorrectly</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// serialize extended years.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(new Date(-8.64e15)) == '"-271821-04-20T00:00:00.000Z"' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// The milliseconds are optional in ES 5, but required in 5.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(new Date(8.64e15)) == '"+275760-09-13T00:00:00.000Z"' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Firefox &lt;= 11.0 incorrectly serializes years prior to 0 as negative</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// four-digit years instead of six-digit years. Credits: @Yaffle.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(new Date(-621987552e5)) == '"-000001-01-01T00:00:00.000Z"' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Safari &lt;= 5.1.5 and Opera &gt;= 10.53 incorrectly serialize millisecond</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// values less than 1000. Credits: @Yaffle.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>stringify(new Date(-1)) == '"1969-12-31T23:59:59.999Z"';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (exception) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>stringifySupported = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>isSupported = stringifySupported;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Test `JSON.parse`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (name == "json-parse") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var parse = exports.parse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (typeof parse == "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// FF 3.1b1, b2 will throw an exception if a bare literal is provided.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Conforming implementations should also coerce the initial argument to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// a string prior to parsing.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (parse("0") === 0 &amp;&amp; !parse(false)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Simple parsing test.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>value = parse(serialized);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var parseSupported = value["a"].length == 5 &amp;&amp; value["a"][0] === 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (parseSupported) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Safari &lt;= 5.1.2 and FF 3.1b1 allow unescaped tabs in strings.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>parseSupported = !parse('"\t"');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>} catch (exception) {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (parseSupported) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// FF 4.0 and 4.0.1 allow leading `+` signs and leading</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// decimal points. FF 4.0, 4.0.1, and IE 9-10 also allow</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// certain octal literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>parseSupported = parse("01") !== 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} catch (exception) {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (parseSupported) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// FF 4.0, 4.0.1, and Rhino 1.7R3-R4 allow trailing decimal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// points. These environments, along with FF 3.1b1 and 2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// also allow trailing commas in JSON objects and arrays.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>parseSupported = parse("1.") !== 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} catch (exception) {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (exception) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>parseSupported = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>isSupported = parseSupported;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return has[name] = !!isSupported;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!has("json")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Common `[[Class]]` name aliases.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var functionClass = "[object Function]",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>dateClass = "[object Date]",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>numberClass = "[object Number]",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>stringClass = "[object String]",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>arrayClass = "[object Array]",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>booleanClass = "[object Boolean]";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Detect incomplete support for accessing string characters by index.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var charIndexBuggy = has("bug-string-char-index");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Define additional utility methods if the `Date` methods are buggy.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!isExtended) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var floor = Math.floor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// A mapping between the months of the year and the number of days between</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// January 1st and the first of the respective month.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var Months = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Calculates the number of days between the Unix epoch and the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// first day of the given month.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var getDay = function (year, month) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return Months[month] + 365 * (year - 1970) + floor((year - 1969 + (month = +(month &gt; 1))) / 4) - floor((year - 1901 + month) / 100) + floor((year - 1601 + month) / 400);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Internal: Determines if a property is a direct property of the given</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// object. Delegates to the native `Object#hasOwnProperty` method.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!(isProperty = objectProto.hasOwnProperty)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>isProperty = function (property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var members = {}, constructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if ((members.__proto__ = null, members.__proto__ = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// The *proto* property cannot be set multiple times in recent</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// versions of Firefox and SeaMonkey.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>"toString": 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, members).toString != getClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Safari &lt;= 2.0.3 doesn't implement `Object#hasOwnProperty`, but</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// supports the mutable *proto* property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>isProperty = function (property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Capture and break the object's prototype chain (see section 8.6.2</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// of the ES 5.1 spec). The parenthesized expression prevents an</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// unsafe transformation by the Closure Compiler.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>var original = this.__proto__, result = property in (this.__proto__ = null, this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Restore the original prototype chain.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this.__proto__ = original;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Capture a reference to the top-level `Object` constructor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>constructor = members.constructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Use the `constructor` property to simulate `Object#hasOwnProperty` in</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// other environments.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>isProperty = function (property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>var parent = (this.constructor || constructor).prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return property in this &amp;&amp; !(property in parent &amp;&amp; this[property] === parent[property]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>members = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return isProperty.call(this, property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Internal: Normalizes the `for...in` iteration algorithm across</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// environments. Each enumerated key is yielded to a `callback` function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>forEach = function (object, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var size = 0, Properties, members, property;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Tests for bugs in the current environment's `for...in` algorithm. The</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// `valueOf` property inherits the non-enumerable flag from</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// `Object.prototype` in older versions of IE, Netscape, and Mozilla.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>(Properties = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this.valueOf = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}).prototype.valueOf = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Iterate over a new instance of the `Properties` class.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>members = new Properties();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (property in members) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Ignore all properties inherited from `Object.prototype`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (isProperty.call(members, property)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>size++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Properties = members = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Normalize the iteration algorithm.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!size) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// A list of non-enumerable properties inherited from `Object.prototype`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>members = ["valueOf", "toString", "toLocaleString", "propertyIsEnumerable", "isPrototypeOf", "hasOwnProperty", "constructor"];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// IE &lt;= 8, Mozilla 1.0, and Netscape 6.2 ignore shadowed non-enumerable</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>forEach = function (object, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var isFunction = getClass.call(object) == functionClass, property, length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var hasProperty = !isFunction &amp;&amp; typeof object.constructor != "function" &amp;&amp; objectTypes[typeof object.hasOwnProperty] &amp;&amp; object.hasOwnProperty || isProperty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (property in object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Gecko &lt;= 1.0 enumerates the `prototype` property of functions under</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// certain conditions; IE does not.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (!(isFunction &amp;&amp; property == "prototype") &amp;&amp; hasProperty.call(object, property)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>callback(property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Manually invoke the callback for each non-enumerable property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (length = members.length; property = members[--length]; hasProperty.call(object, property) &amp;&amp; callback(property));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else if (size == 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Safari &lt;= 2.0.4 enumerates shadowed properties twice.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>forEach = function (object, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Create a set of iterated properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var members = {}, isFunction = getClass.call(object) == functionClass, property;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (property in object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Store each property name to prevent double enumeration. The</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// `prototype` property of functions is not enumerated due to cross-</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// environment inconsistencies.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (!(isFunction &amp;&amp; property == "prototype") &amp;&amp; !isProperty.call(members, property) &amp;&amp; (members[property] = 1) &amp;&amp; isProperty.call(object, property)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>callback(property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// No bugs detected; use the standard `for...in` algorithm.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>forEach = function (object, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var isFunction = getClass.call(object) == functionClass, property, isConstructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (property in object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (!(isFunction &amp;&amp; property == "prototype") &amp;&amp; isProperty.call(object, property) &amp;&amp; !(isConstructor = property === "constructor")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>callback(property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Manually invoke the callback for the `constructor` property due to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// cross-environment inconsistencies.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (isConstructor || isProperty.call(object, (property = "constructor"))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>callback(property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return forEach(object, callback);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Public: Serializes a JavaScript `value` as a JSON string. The optional</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// `filter` argument may specify either a function that alters how object and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// array members are serialized, or an array of strings and numbers that</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// indicates which properties should be serialized. The optional `width`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// argument may be either a string or number that specifies the indentation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// level of the output.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!has("json-stringify")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: A map of control characters and their escaped equivalents.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var Escapes = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>92: "\\\\",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>34: '\\"',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>8: "\\b",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>12: "\\f",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>10: "\\n",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>13: "\\r",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>9: "\\t"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Converts `value` into a zero-padded string such that its</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// length is at least equal to `width`. The `width` must be &lt;= 6.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var leadingZeroes = "000000";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var toPaddedString = function (width, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// The `|| 0` expression is necessary to work around a bug in</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Opera &lt;= 7.54u2 where `0 == -0`, but `String(-0) !== "0"`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return (leadingZeroes + (value || 0)).slice(-width);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Double-quotes a string `value`, replacing all ASCII control</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// characters (characters with code unit values between 0 and 31) with</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// their escaped equivalents. This is an implementation of the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// `Quote(value)` operation defined in ES 5.1 section 15.12.3.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var unicodePrefix = "\\u00";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var quote = function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var result = '"', index = 0, length = value.length, useCharIndex = !charIndexBuggy || length &gt; 10;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var symbols = useCharIndex &amp;&amp; (charIndexBuggy ? value.split("") : value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (; index &lt; length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var charCode = value.charCodeAt(index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// If the character is a control character, append its Unicode or</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// shorthand escape sequence; otherwise, append the character as-is.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>switch (charCode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>case 8: case 9: case 10: case 12: case 13: case 34: case 92:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>result += Escapes[charCode];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>default:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (charCode &lt; 32) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>result += unicodePrefix + toPaddedString(2, charCode.toString(16));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>result += useCharIndex ? symbols[index] : value.charAt(index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return result + '"';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Recursively serializes an object. Implements the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// `Str(key, holder)`, `JO(value)`, and `JA(value)` operations.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var serialize = function (property, object, callback, properties, whitespace, indentation, stack) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var value, className, year, month, date, time, hours, minutes, seconds, milliseconds, results, element, index, length, prefix, result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Necessary for host object support.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>value = object[property];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} catch (exception) {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (typeof value == "object" &amp;&amp; value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>className = getClass.call(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (className == dateClass &amp;&amp; !isProperty.call(value, "toJSON")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (value &gt; -1 / 0 &amp;&amp; value &lt; 1 / 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Dates are serialized according to the `Date#toJSON` method</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// specified in ES 5.1 section 15.9.5.44. See section 15.9.1.15</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// for the ISO 8601 date time string format.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (getDay) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Manually compute the year, month, date, hours, minutes,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// seconds, and milliseconds if the `getUTC*` methods are</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// buggy. Adapted from @Yaffle's `date-shim` project.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>date = floor(value / 864e5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>for (year = floor(date / 365.2425) + 1970 - 1; getDay(year + 1, 0) &lt;= date; year++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>for (month = floor((date - getDay(year, 0)) / 30.42); getDay(year, month + 1) &lt;= date; month++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>date = 1 + date - getDay(year, month);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// The `time` value specifies the time within the day (see ES</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// 5.1 section 15.9.1.2). The formula `(A % B + B) % B` is used</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// to compute `A modulo B`, as the `%` operator does not</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// correspond to the `modulo` operation for negative numbers.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>time = (value % 864e5 + 864e5) % 864e5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// The hours, minutes, seconds, and milliseconds are obtained by</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// decomposing the time within the day. See section 15.9.1.10.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>hours = floor(time / 36e5) % 24;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>minutes = floor(time / 6e4) % 60;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>seconds = floor(time / 1e3) % 60;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>milliseconds = time % 1e3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>year = value.getUTCFullYear();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>month = value.getUTCMonth();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>date = value.getUTCDate();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>hours = value.getUTCHours();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>minutes = value.getUTCMinutes();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>seconds = value.getUTCSeconds();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>milliseconds = value.getUTCMilliseconds();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Serialize extended years correctly.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>value = (year &lt;= 0 || year &gt;= 1e4 ? (year &lt; 0 ? "-" : "+") + toPaddedString(6, year &lt; 0 ? -year : year) : toPaddedString(4, year)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>"-" + toPaddedString(2, month + 1) + "-" + toPaddedString(2, date) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Months, dates, hours, minutes, and seconds should have two</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// digits; milliseconds should have three.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>"T" + toPaddedString(2, hours) + ":" + toPaddedString(2, minutes) + ":" + toPaddedString(2, seconds) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Milliseconds are optional in ES 5.0, but required in 5.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>"." + toPaddedString(3, milliseconds) + "Z";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>value = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (typeof value.toJSON == "function" &amp;&amp; ((className != numberClass &amp;&amp; className != stringClass &amp;&amp; className != arrayClass) || isProperty.call(value, "toJSON"))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Prototype &lt;= 1.6.1 adds non-standard `toJSON` methods to the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// `Number`, `String`, `Date`, and `Array` prototypes. JSON 3</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// ignores all `toJSON` methods on these objects unless they are</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// defined directly on an instance.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>value = value.toJSON(property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// If a replacement function was provided, call it to obtain the value</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// for serialization.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>value = callback.call(object, property, value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (value === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return "null";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>className = getClass.call(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (className == booleanClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Booleans are represented literally.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return "" + value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} else if (className == numberClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// JSON numbers must be finite. `Infinity` and `NaN` are serialized as</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// `"null"`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return value &gt; -1 / 0 &amp;&amp; value &lt; 1 / 0 ? "" + value : "null";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} else if (className == stringClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Strings are double-quoted and escaped.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return quote("" + value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Recursively serialize objects and arrays.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (typeof value == "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Check for cyclic structures. This is a linear search; performance</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// is inversely proportional to the number of unique nested objects.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (length = stack.length; length--;) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (stack[length] === value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Cyclic structures cannot be serialized by `JSON.stringify`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Add the object to the stack of traversed objects.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>stack.push(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>results = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Save the current indentation level and indent one additional level.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>prefix = indentation;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>indentation += whitespace;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (className == arrayClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Recursively serialize array elements.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>for (index = 0, length = value.length; index &lt; length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>element = serialize(index, value, callback, properties, whitespace, indentation, stack);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>results.push(element === undef ? "null" : element);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>result = results.length ? (whitespace ? "[\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "]" : ("[" + results.join(",") + "]")) : "[]";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Recursively serialize object members. Members are selected from</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// either a user-specified list of property names, or the object</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// itself.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>forEach(properties || value, function (property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var element = serialize(property, value, callback, properties, whitespace, indentation, stack);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (element !== undef) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// According to ES 5.1 section 15.12.3: "If `gap` {whitespace}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// is not the empty string, let `member` {quote(property) + ":"}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// be the concatenation of `member` and the `space` character."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// The "`space` character" refers to the literal space</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// character, not the `space` {width} argument provided to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// `JSON.stringify`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>results.push(quote(property) + ":" + (whitespace ? " " : "") + element);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>result = results.length ? (whitespace ? "{\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "}" : ("{" + results.join(",") + "}")) : "{}";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Remove the object from the traversed object stack.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>stack.pop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Public: `JSON.stringify`. See ES 5.1 section 15.12.3.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>exports.stringify = function (source, filter, width) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var whitespace, callback, properties, className;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (objectTypes[typeof filter] &amp;&amp; filter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if ((className = getClass.call(filter)) == functionClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>callback = filter;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (className == arrayClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Convert the property names array into a makeshift set.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>properties = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>for (var index = 0, length = filter.length, value; index &lt; length; value = filter[index++], ((className = getClass.call(value)), className == stringClass || className == numberClass) &amp;&amp; (properties[value] = 1));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (width) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if ((className = getClass.call(width)) == numberClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Convert the `width` to an integer and create a string containing</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// `width` number of space characters.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if ((width -= width % 1) &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (whitespace = "", width &gt; 10 &amp;&amp; (width = 10); whitespace.length &lt; width; whitespace += " ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (className == stringClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>whitespace = width.length &lt;= 10 ? width : width.slice(0, 10);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Opera &lt;= 7.54u2 discards the values associated with empty string keys</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// (`""`) only if they are used directly within an object member list</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// (e.g., `!("" in { "": 1})`).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return serialize("", (value = {}, value[""] = source, value), callback, properties, whitespace, "", []);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Public: Parses a JSON source string.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!has("json-parse")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var fromCharCode = String.fromCharCode;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: A map of escaped control characters and their unescaped</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// equivalents.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var Unescapes = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>92: "\\",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>34: '"',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>47: "/",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>98: "\b",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>116: "\t",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>110: "\n",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>102: "\f",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>114: "\r"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Stores the parser state.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var Index, Source;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Resets the parser state and throws a `SyntaxError`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var abort = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Index = Source = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>throw SyntaxError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Returns the next token, or `"$"` if the parser has reached</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// the end of the source string. A token may be a string, number, `null`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// literal, or Boolean literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var lex = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var source = Source, length = source.length, value, begin, position, isSigned, charCode;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>while (Index &lt; length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>charCode = source.charCodeAt(Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>switch (charCode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>case 9: case 10: case 13: case 32:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Skip whitespace tokens, including tabs, carriage returns, line</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// feeds, and space characters.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>Index++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>case 123: case 125: case 91: case 93: case 58: case 44:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Parse a punctuator token (`{`, `}`, `[`, `]`, `:`, or `,`) at</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// the current position.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>value = charIndexBuggy ? source.charAt(Index) : source[Index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>Index++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>case 34:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// `"` delimits a JSON string; advance to the next character and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// begin parsing the string. String tokens are prefixed with the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// sentinel `@` character to distinguish them from punctuators and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// end-of-string tokens.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (value = "@", Index++; Index &lt; length;) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>charCode = source.charCodeAt(Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (charCode &lt; 32) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Unescaped ASCII control characters (those with a code unit</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// less than the space character) are not permitted.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>} else if (charCode == 92) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// A reverse solidus (`\`) marks the beginning of an escaped</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// control character (including `"`, `\`, and `/`) or Unicode</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// escape sequence.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>charCode = source.charCodeAt(++Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>switch (charCode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>case 92: case 34: case 47: case 98: case 116: case 110: case 102: case 114:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Revive escaped control characters.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>value += Unescapes[charCode];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Index++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>case 117:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// `\u` marks the beginning of a Unicode escape sequence.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Advance to the first character and validate the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// four-digit code point.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>begin = ++Index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>for (position = Index + 4; Index &lt; position; Index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>charCode = source.charCodeAt(Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>// A valid sequence comprises four hexdigits (case-</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>// insensitive) that form a single hexadecimal value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>if (!(charCode &gt;= 48 &amp;&amp; charCode &lt;= 57 || charCode &gt;= 97 &amp;&amp; charCode &lt;= 102 || charCode &gt;= 65 &amp;&amp; charCode &lt;= 70)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>// Invalid Unicode escape sequence.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Revive the escaped character.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>value += fromCharCode("0x" + source.slice(begin, Index));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>default:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Invalid escape sequence.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (charCode == 34) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// An unescaped double-quote character marks the end of the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// string.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>charCode = source.charCodeAt(Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>begin = Index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Optimize for the common case where a string is valid.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>while (charCode &gt;= 32 &amp;&amp; charCode != 92 &amp;&amp; charCode != 34) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>charCode = source.charCodeAt(++Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Append the string as-is.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>value += source.slice(begin, Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (source.charCodeAt(Index) == 34) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Advance to the next character and return the revived string.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>Index++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Unterminated string.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>default:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Parse numbers and literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>begin = Index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Advance past the negative sign, if one is specified.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (charCode == 45) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>isSigned = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>charCode = source.charCodeAt(++Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Parse an integer or floating-point value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (charCode &gt;= 48 &amp;&amp; charCode &lt;= 57) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Leading zeroes are interpreted as octal literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (charCode == 48 &amp;&amp; ((charCode = source.charCodeAt(Index + 1)), charCode &gt;= 48 &amp;&amp; charCode &lt;= 57)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Illegal octal literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>isSigned = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Parse the integer component.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>for (; Index &lt; length &amp;&amp; ((charCode = source.charCodeAt(Index)), charCode &gt;= 48 &amp;&amp; charCode &lt;= 57); Index++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Floats cannot contain a leading decimal point; however, this</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// case is already accounted for by the parser.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (source.charCodeAt(Index) == 46) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>position = ++Index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Parse the decimal component.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>for (; position &lt; length &amp;&amp; ((charCode = source.charCodeAt(position)), charCode &gt;= 48 &amp;&amp; charCode &lt;= 57); position++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (position == Index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// Illegal trailing decimal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Index = position;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Parse exponents. The `e` denoting the exponent is</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// case-insensitive.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>charCode = source.charCodeAt(Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (charCode == 101 || charCode == 69) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>charCode = source.charCodeAt(++Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Skip past the sign following the exponent, if one is</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// specified.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (charCode == 43 || charCode == 45) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>Index++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Parse the exponential component.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>for (position = Index; position &lt; length &amp;&amp; ((charCode = source.charCodeAt(position)), charCode &gt;= 48 &amp;&amp; charCode &lt;= 57); position++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (position == Index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// Illegal empty exponent.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Index = position;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>// Coerce the parsed value to a JavaScript number.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return +source.slice(begin, Index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// A negative sign may only precede numbers.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (isSigned) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// `true`, `false`, and `null` literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (source.slice(Index, Index + 4) == "true") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>Index += 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else if (source.slice(Index, Index + 5) == "false") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>Index += 5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else if (source.slice(Index, Index + 4) == "null") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>Index += 4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Unrecognized token.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Return the sentinel `$` character if the parser has reached the end</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// of the source string.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return "$";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Parses a JSON `value` token.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var get = function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var results, hasMembers;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (value == "$") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Unexpected end of input.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (typeof value == "string") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if ((charIndexBuggy ? value.charAt(0) : value[0]) == "@") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Remove the sentinel `@` character.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return value.slice(1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Parse object and array literals.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (value == "[") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Parses a JSON array, returning a new JavaScript array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>results = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>for (;; hasMembers || (hasMembers = true)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>value = lex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// A closing square bracket marks the end of the array literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (value == "]") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// If the array literal contains elements, the current token</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// should be a comma separating the previous element from the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// next.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (hasMembers) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (value == ",") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>value = lex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (value == "]") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// Unexpected trailing `,` in array literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// A `,` must separate each array element.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Elisions and leading commas are not permitted.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (value == ",") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>results.push(get(value));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return results;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (value == "{") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>// Parses a JSON object, returning a new JavaScript object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>results = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>for (;; hasMembers || (hasMembers = true)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>value = lex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// A closing curly brace marks the end of the object literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (value == "}") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// If the object literal contains members, the current token</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// should be a comma separator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (hasMembers) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (value == ",") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>value = lex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (value == "}") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>// Unexpected trailing `,` in object literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// A `,` must separate each object member.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Leading commas are not permitted, object property names must be</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// double-quoted strings, and a `:` must separate each property</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// name and value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (value == "," || typeof value != "string" || (charIndexBuggy ? value.charAt(0) : value[0]) != "@" || lex() != ":") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>results[value.slice(1)] = get(lex());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return results;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Unexpected token encountered.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Updates a traversed object member.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var update = function (source, property, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var element = walk(source, property, callback);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (element === undef) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>delete source[property];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>source[property] = element;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Internal: Recursively traverses a parsed JSON object, invoking the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// `callback` function for each value. This is an implementation of the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// `Walk(holder, name)` operation defined in ES 5.1 section 15.12.2.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var walk = function (source, property, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var value = source[property], length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (typeof value == "object" &amp;&amp; value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// `forEach` can't be used to traverse an array in Opera &lt;= 8.54</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// because its `Object#hasOwnProperty` implementation returns `false`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// for array indices (e.g., `![1, 2, 3].hasOwnProperty("0")`).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (getClass.call(value) == arrayClass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>for (length = value.length; length--;) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>update(value, length, callback);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>forEach(value, function (property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>update(value, property, callback);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return callback.call(source, property, value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Public: `JSON.parse`. See ES 5.1 section 15.12.2.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>exports.parse = function (source, callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var result, value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Index = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Source = "" + source;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>result = get(lex());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// If a JSON string contains multiple tokens, it is invalid.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (lex() != "$") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>abort();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>// Reset the parser state.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Index = Source = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return callback &amp;&amp; getClass.call(callback) == functionClass ? walk((value = {}, value[""] = result, value), "", callback) : result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>exports["runInContext"] = runInContext;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return exports;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (freeExports &amp;&amp; !isLoader) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Export for CommonJS environments.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>runInContext(root, freeExports);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Export for web browsers and JavaScript engines.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var nativeJSON = root.JSON,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>previousJSON = root["JSON3"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>isRestored = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var JSON3 = runInContext(root, (root["JSON3"] = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Public: Restores the original value of the global `JSON` object and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// returns a reference to the `JSON3` object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"noConflict": function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!isRestored) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>isRestored = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>root.JSON = nativeJSON;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>root["JSON3"] = previousJSON;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>nativeJSON = previousJSON = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return JSON3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>root.JSON = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"parse": JSON3.parse,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"stringify": JSON3.stringify</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Export for asynchronous module loaders.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (isLoader) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>define(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return JSON3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}).call(this);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// MutationObserver</span></p>
<p class="p1"><span class="s1">/*!</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Shim for MutationObserver interface</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Author: Graeme Yeates (github.com/megawac)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Repository: https://github.com/megawac/MutationObserver.js</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* License: WTFPL V2, 2004 (wtfpl.net).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Though credit and staring the repo will make me feel pretty, you can modify and redistribute as you please.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Attempts to follow spec (http:// www.w3.org/TR/dom/#mutation-observers) as closely as possible for native javascript</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* See https://github.com/WebKit/webkit/blob/master/Source/WebCore/dom/MutationObserver.cpp for current webkit source c++ implementation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* prefix bugs:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>- https://bugs.webkit.org/show_bug.cgi?id=85161</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>- https://bugzilla.mozilla.org/show_bug.cgi?id=749920</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Don't use WebKitMutationObserver as Safari (6.0.5-6.1) use a buggy implementation</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">window.MutationObserver = window.MutationObserver || (function(undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"use strict";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {function(Array.&lt;MutationRecord&gt;, MutationObserver)} listener</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function MutationObserver(listener) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @type {Array.&lt;Object&gt;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._watched = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/** @private */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._listener = listener;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Start a recursive timeout function to check all items being observed for mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @type {MutationObserver} observer</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function startMutationChecker(observer) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>(function check() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var mutations = observer.takeRecords();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (mutations.length) { // fire away</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// calling the listener with context is not spec but currently consistent with FF and WebKit</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>observer._listener(mutations, observer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/** @private */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>observer._timeout = setTimeout(check, MutationObserver._period);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>})();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Period to check for mutations (~32 times/sec)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @type {number}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @expose</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>MutationObserver._period = 30 /*ms+runtime*/ ;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Exposed API</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @expose</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @final</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>MutationObserver.prototype = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* see http:// dom.spec.whatwg.org/#dom-mutationobserver-observe</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* not going to throw here but going to follow the current spec config sets</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Node|null} $target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Object|null} config : MutationObserverInit configuration dictionary</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @expose</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @return undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>observe: function($target, config) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* Using slightly different names so closure can go ham</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @type {!Object} : A custom mutation config</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var settings = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>attr: !! (config.attributes || config.attributeFilter || config.attributeOldValue),</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// some browsers enforce that subtree must be set with childList, attributes or characterData.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// We don't care as spec doesn't specify this rule.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>kids: !! config.childList,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>descendents: !! config.subtree,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>charData: !! (config.characterData || config.characterDataOldValue)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var watched = this._watched;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// remove already observed target element from pool</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (var i = 0; i &lt; watched.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (watched[i].tar === $target) watched.splice(i, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (config.attributeFilter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                 </span>* converts to a {key: true} dict for faster lookup</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                 </span>* @type {Object.&lt;String,Boolean&gt;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                 </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>settings.afilter = reduce(config.attributeFilter, function(a, b) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>a[b] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, {});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>watched.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>tar: $target,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>fn: createMutationSearcher($target, settings)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// reconnect if not connected</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!this._timeout) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>startMutationChecker(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Finds mutations since last check and empties the "record queue" i.e. mutations will only be found once</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @expose</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @return {Array.&lt;MutationRecord&gt;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>takeRecords: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var mutations = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var watched = this._watched;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (var i = 0; i &lt; watched.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>watched[i].fn(mutations);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return mutations;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @expose</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @return undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>disconnect: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this._watched = []; // clear the stuff being observed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>clearTimeout(this._timeout); // ready for garbage collection</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/** @private */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this._timeout = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Simple MutationRecord pseudoclass. No longer exposing as its not fully compliant</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Object} data</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {Object} a MutationRecord</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function MutationRecord(data) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var settings = { // technically these should be on proto so hasOwnProperty will return false for non explicitly props</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>type: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>target: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>addedNodes: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>removedNodes: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>previousSibling: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>nextSibling: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>attributeName: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>attributeNamespace: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oldValue: null</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (var prop in data) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (has(settings, prop) &amp;&amp; data[prop] !== undefined) settings[prop] = data[prop];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return settings;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Creates a func to find all the mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} $target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {!Object} config : A custom mutation config</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function createMutationSearcher($target, config) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/** type {Elestuct} */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var $oldstate = clone($target, config); // create the cloned datastructure</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* consumes array of mutations we can push to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Array.&lt;MutationRecord&gt;} mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return function(mutations) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var olen = mutations.length, dirty;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (config.charData &amp;&amp; $target.nodeType === 3 &amp;&amp; $target.nodeValue !== $oldstate.charData) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>mutations.push(new MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>type: "characterData",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>target: $target,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>oldValue: $oldstate.charData <span class="Apple-converted-space">         </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Alright we check base level changes in attributes... easy</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (config.attr &amp;&amp; $oldstate.attr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>findAttributeMutations(mutations, $target, $oldstate.attr, config.afilter);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// check childlist or subtree for mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (config.kids || config.descendents) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>dirty = searchSubtree(mutations, $target, $oldstate, config);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// reclone data structure if theres changes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (dirty || mutations.length !== olen) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>/** type {Elestuct} */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>$oldstate = clone($target, config);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/* attributes + attributeFilter helpers */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Check if the environment has the attribute bug (#4) which cause</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// element.attributes.style to always be null.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var hasAttributeBug = document.createElement("i");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>hasAttributeBug.style.top = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>hasAttributeBug = hasAttributeBug.attributes.style.value != "null";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Gets an attribute value in an environment without attribute bug</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} el</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Attr} attr</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {String} an attribute value</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function getAttributeSimple(el, attr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// There is a potential for a warning to occur here if the attribute is a</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// custom attribute in IE&lt;9 with a custom .toString() method. This is</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// just a warning and doesn't affect execution (see #21)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return attr.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Gets an attribute value with special hack for style attribute (see #4)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} el</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Attr} attr</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {String} an attribute value</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function getAttributeWithStyleHack(el, attr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// As with getAttributeSimple there is a potential warning for custom attribtues in IE7.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return attr.name !== "style" ? attr.value : el.style.cssText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var getAttributeValue = hasAttributeBug ? getAttributeSimple : getAttributeWithStyleHack;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* fast helper to check to see if attributes object of an element has changed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* doesnt handle the textnode case</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Array.&lt;MutationRecord&gt;} mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} $target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Object.&lt;string, string&gt;} $oldstate : Custom attribute clone data structure from clone</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Object} filter</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function findAttributeMutations(mutations, $target, $oldstate, filter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var checked = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var attributes = $target.attributes;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var attr;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var i = attributes.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>while (i--) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>attr = attributes[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>name = attr.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!filter || has(filter, name)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (getAttributeValue($target, attr) !== $oldstate[name]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// The pushing is redundant but gzips very nicely</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>type: "attributes",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>target: $target,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>attributeName: name,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>oldValue: $oldstate[name],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>attributeNamespace: attr.namespaceURI // in ie&lt;8 it incorrectly will return undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>checked[name] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (name in $oldstate) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!(checked[name])) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>target: $target,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>type: "attributes",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>attributeName: name,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>oldValue: $oldstate[name]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* searchSubtree: array of mutations so far, element, element clone, bool</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* synchronous dfs comparision of two nodes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* This function is applied to any observed element with childList or subtree specified</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Sorry this is kind of confusing as shit, tried to comment it a bit...</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* codereview.stackexchange.com/questions/38351 discussion of an earlier version of this func</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Array} mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} $target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {!Object} $oldstate : A custom cloned node from clone()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {!Object} config : A custom mutation config</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function searchSubtree(mutations, $target, $oldstate, config) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Track if the tree is dirty and has to be recomputed (#14).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var dirty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Helper to identify node rearrangment and stuff...</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* There is no gaurentee that the same node will be identified for both added and removed nodes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* if the positions have been shuffled.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* conflicts array will be emptied by end of operation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function resolveConflicts(conflicts, node, $kids, $oldkids, numAddedNodes) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// the distance between the first conflicting node and the last</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var distance = conflicts.length - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// prevents same conflict being resolved twice consider when two nodes switch places.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// only one should be given a mutation event (note -~ is used as a math.ceil shorthand)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var counter = -~((distance - numAddedNodes) / 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var $cur;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var oldstruct;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var conflict;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>while ((conflict = conflicts.pop())) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>$cur = $kids[conflict.i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oldstruct = $oldkids[conflict.j];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// attempt to determine if there was node rearrangement... won't gaurentee all matches</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// also handles case where added/removed nodes cause nodes to be identified as conflicts</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (config.kids &amp;&amp; counter &amp;&amp; Math.abs(conflict.i - conflict.j) &gt;= distance) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>type: "childList",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>target: node,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>addedNodes: [$cur],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>removedNodes: [$cur],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// haha don't rely on this please</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>nextSibling: $cur.nextSibling,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>previousSibling: $cur.previousSibling</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>counter--; // found conflict</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Alright we found the resorted nodes now check for other types of mutations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (config.attr &amp;&amp; oldstruct.attr) findAttributeMutations(mutations, $cur, oldstruct.attr, config.afilter);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (config.charData &amp;&amp; $cur.nodeType === 3 &amp;&amp; $cur.nodeValue !== oldstruct.charData) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>type: "characterData",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>target: $cur,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>oldValue: oldstruct.charData</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// now look @ subtree</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (config.descendents) findMutations($cur, oldstruct);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Main worker. Finds and adds mutations if there are any</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Node} node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {!Object} old : A cloned data structure using internal clone</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function findMutations(node, old) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var $kids = node.childNodes;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var $oldkids = old.kids;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var klen = $kids.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// $oldkids will be undefined for text and comment nodes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var olen = $oldkids ? $oldkids.length : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// if (!olen &amp;&amp; !klen) return; // both empty; clearly no changes</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// we delay the intialization of these for marginal performance in the expected case (actually quite signficant on large subtrees when these would be otherwise unused)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// map of checked element of ids to prevent registering the same conflict twice</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// array of potential conflicts (ie nodes that may have been re arranged)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var conflicts;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var id; // element id from getElementId helper</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var idx; // index of a moved or inserted element</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var oldstruct;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// current and old nodes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var $cur;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var $old;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// track the number of added nodes so we can resolve conflicts more accurately</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var numAddedNodes = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// iterate over both old and current child nodes at the same time</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var i = 0, j = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// while there is still anything left in $kids or $oldkids (same as i &lt; $kids.length || j &lt; $oldkids.length;)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>while( i &lt; klen || j &lt; olen ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// current and old nodes at the indexs</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>$cur = $kids[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oldstruct = $oldkids[j];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>$old = oldstruct &amp;&amp; oldstruct.node;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if ($cur === $old) { // expected case - optimized for this case</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// check attributes as specified by config</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (config.attr &amp;&amp; oldstruct.attr) /* oldstruct.attr instead of textnode check */findAttributeMutations(mutations, $cur, oldstruct.attr, config.afilter);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// check character data if node is a comment or textNode and it's being observed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (config.charData &amp;&amp; oldstruct.charData !== undefined &amp;&amp; $cur.nodeValue !== oldstruct.charData) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>type: "characterData",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>target: $cur,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>oldValue: oldstruct.charData</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// resolve conflicts; it will be undefined if there are no conflicts - otherwise an array</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (conflicts) resolveConflicts(conflicts, node, $kids, $oldkids, numAddedNodes);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// recurse on next level of children. Avoids the recursive call when there are no children left to iterate</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (config.descendents &amp;&amp; ($cur.childNodes.length || oldstruct.kids &amp;&amp; oldstruct.kids.length)) findMutations($cur, oldstruct);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>i++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>j++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else { // (uncommon case) lookahead until they are the same again or the end of children</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>dirty = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (!map) { // delayed initalization (big perf benefit)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>map = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>conflicts = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if ($cur) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// check id is in the location map otherwise do a indexOf search</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (!(map[id = getElementId($cur)])) { // to prevent double checking</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>// mark id as found</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>map[id] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>// custom indexOf using comparitor checking oldkids[i].node === $cur</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>if ((idx = indexOfCustomNode($oldkids, $cur, j)) === -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>if (config.kids) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>type: "childList",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>target: node,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>addedNodes: [$cur], // $cur is a new node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>nextSibling: $cur.nextSibling,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>previousSibling: $cur.previousSibling</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>numAddedNodes++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>conflicts.push({ // add conflict</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>i: i,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>j: idx</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>i++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if ($old &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>// special case: the changes may have been resolved: i and j appear congurent so we can continue using the expected case</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>$old !== $kids[i]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (!(map[id = getElementId($old)])) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>map[id] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>if ((idx = indexOf($kids, $old, i)) === -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>if (config.kids) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>mutations.push(MutationRecord({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>type: "childList",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>target: old.node,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>removedNodes: [$old],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>nextSibling: $oldkids[j + 1], // praise no indexoutofbounds exception</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>previousSibling: $oldkids[j - 1]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>numAddedNodes--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>conflicts.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>i: idx,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>j: j</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>j++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}// end uncommon case</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}// end loop</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// resolve any remaining conflicts</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (conflicts) resolveConflicts(conflicts, node, $kids, $oldkids, numAddedNodes);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>findMutations($target, $oldstate);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return dirty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Utility</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Cones a element into a custom data structure designed for comparision. https://gist.github.com/megawac/8201012</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} $target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {!Object} config : A custom mutation config</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {!Object} : Cloned data structure</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function clone($target, config) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var recurse = true; // set true so childList we'll always check the first level</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return (function copy($target) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var elestruct = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>/** @type {Node} */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>node: $target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Store current character data of target text or comment node if the config requests</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// those properties to be observed.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (config.charData &amp;&amp; ($target.nodeType === 3 || $target.nodeType === 8)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>elestruct.charData = $target.nodeValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// its either a element, comment, doc frag or document node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Add attr only if subtree is specified or top level and avoid if</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// attributes is a document object (#13).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (config.attr &amp;&amp; recurse &amp;&amp; $target.nodeType === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>* clone live attribute list to an object structure {name: val}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>* @type {Object.&lt;string, string&gt;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>elestruct.attr = reduce($target.attributes, function(memo, attr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (!config.afilter || config.afilter[attr.name]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>memo[attr.name] = getAttributeValue($target, attr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return memo;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}, {});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// whether we should iterate the children of $target node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (recurse &amp;&amp; ((config.kids || config.charData) || (config.attr &amp;&amp; config.descendents)) ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>/** @type {Array.&lt;!Object&gt;} : Array of custom clone */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>elestruct.kids = map($target.childNodes, copy);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recurse = config.descendents;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return elestruct;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>})($target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* indexOf an element in a collection of custom nodes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {NodeList} set</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {!Object} $node : A custom cloned node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {number} idx : index to start the loop</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {number}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function indexOfCustomNode(set, $node, idx) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return indexOf(set, $node, idx, JSCompiler_renameProperty("node"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// using a non id (eg outerHTML or nodeValue) is extremely naive and will run into issues with nodes that may appear the same like &lt;li&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var counter = 1; // don't use 0 as id (falsy)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/** @const */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var expando = "mo_id";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Attempt to uniquely id an element for hashing. We could optimize this for legacy browsers but it hopefully wont be called enough to be a concern</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Node} $ele</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {(string|number)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function getElementId($ele) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return $ele.id || ($ele[expando] = $ele[expando] || counter++);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} catch (o_O) { // ie &lt;8 will throw if you set an unknown property on a text node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return $ele.nodeValue; // naive</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (shitie) { // when text node is removed: https://gist.github.com/megawac/8355978 :(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return counter++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* **map** Apply a mapping function to each item of a set</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Array|NodeList} set</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Function} iterator</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function map(set, iterator) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var results = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (var index = 0; index &lt; set.length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>results[index] = iterator(set[index], index, set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return results;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* **Reduce** builds up a single result from a list of values</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Array|NodeList|NamedNodeMap} set</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Function} iterator</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {*} [memo] Initial value of the memo.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function reduce(set, iterator, memo) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (var index = 0; index &lt; set.length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>memo = iterator(memo, set[index], index, set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return memo;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* **indexOf** find index of item in collection.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Array|NodeList} set</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Object} item</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {number} idx</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {string} [prop] Property on set item to compare to item</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function indexOf(set, item, idx, prop) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (/*idx = ~~idx*/; idx &lt; set.length; idx++) {// start idx is always given as this is internal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if ((prop ? set[idx][prop] : set[idx]) === item) return idx;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {Object} obj</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @param {(string|number)} prop</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* @return {boolean}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function has(obj, prop) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return obj[prop] !== undefined; // will be nicely inlined by gcc</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// GCC hack see http:// stackoverflow.com/a/23202438/1517919</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function JSCompiler_renameProperty(a) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return MutationObserver;</span></p>
<p class="p1"><span class="s1">})(void 0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Node.prototype.contains</span></p>
<p class="p1"><span class="s1">(function() {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function contains(node) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(0 in arguments)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('1 argument is required');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>do {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this === node) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} while (node = node &amp;&amp; node.parentNode);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// IE</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if ('HTMLElement' in this &amp;&amp; 'contains' in HTMLElement.prototype) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete HTMLElement.prototype.contains;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if ('Node' in this) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Node.prototype.contains = contains;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.contains = Element.prototype.contains = contains;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.defineProperty</span></p>
<p class="p1"><span class="s1">(function (nativeDefineProperty) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var supportsAccessors = Object.prototype.hasOwnProperty('__defineGetter__');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ERR_ACCESSORS_NOT_SUPPORTED = 'Getters &amp; setters cannot be defined on this javascript engine';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ERR_VALUE_ACCESSORS = 'A property cannot both have accessors and be writable or have a value';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - This does not use CreateMethodProperty because our CreateMethodProperty function uses Object.defineProperty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object['defineProperty'] = function defineProperty(object, property, descriptor) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Where native support exists, assume it</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (nativeDefineProperty &amp;&amp; (object === window || object === document || object === Element.prototype || object instanceof Element)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return nativeDefineProperty(object, property, descriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (object === null || !(object instanceof Object || typeof object === 'object')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Object.defineProperty called on non-object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(descriptor instanceof Object)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Property description must be an object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var propertyString = String(property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var hasValueOrWritable = 'value' in descriptor || 'writable' in descriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var getterType = 'get' in descriptor &amp;&amp; typeof descriptor.get;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var setterType = 'set' in descriptor &amp;&amp; typeof descriptor.set;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// handle descriptor.get</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (getterType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (getterType !== 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Getter must be a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsAccessors) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (hasValueOrWritable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(ERR_VALUE_ACCESSORS);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.__defineGetter__.call(object, propertyString, descriptor.get);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>object[propertyString] = descriptor.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// handle descriptor.set</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (setterType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (setterType !== 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Setter must be a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsAccessors) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (hasValueOrWritable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(ERR_VALUE_ACCESSORS);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.__defineSetter__.call(object, propertyString, descriptor.set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// OK to define value unconditionally - if a getter has been specified as well, an error would be thrown above</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ('value' in descriptor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>object[propertyString] = descriptor.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return object;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}(Object.defineProperty));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _DOMTokenList</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1">Copyright (c) 2016, John Gardner</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">var _DOMTokenList = (function() { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var dpSupport = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var defineGetter = function (object, name, fn, configurable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Object.defineProperty)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(object, name, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false === dpSupport ? true : !!configurable,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: fn</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else object.__defineGetter__(name, fn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>/** Ensure the browser allows Object.defineProperty to be used on native JavaScript objects. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineGetter({}, "support");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>dpSupport = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var _DOMTokenList = function (el, prop) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var tokens = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var tokenMap = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var length = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var maxLength = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var addIndexGetter = function (i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineGetter(that, i, function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return tokens[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, false);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var reindex = function () {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Define getter functions for array-like access to the tokenList's contents. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (length &gt;= maxLength)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (; maxLength &lt; length; ++maxLength) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>addIndexGetter(maxLength);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Helper function called at the start of each class method. Internal use only. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var preop = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var error;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var args = arguments;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var rSpace = /\s+/;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Validate the token/s passed to an instance method, if any. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (args.length)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (i = 0; i &lt; args.length; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (rSpace.test(args[i])) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>error = new SyntaxError('String "' + args[i] + '" ' + "contains" + ' an invalid character');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>error.code = 5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>error.name = "InvalidCharacterError";</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw error;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Split the new value apart by whitespace*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof el[prop] === "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokens = ("" + el[prop].baseVal).replace(/^\s+|\s+$/g, "").split(rSpace);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokens = ("" + el[prop]).replace(/^\s+|\s+$/g, "").split(rSpace);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Avoid treating blank strings as single-item token lists */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ("" === tokens[0]) tokens = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Repopulate the internal token lists */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokenMap = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (i = 0; i &lt; tokens.length; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokenMap[tokens[i]] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = tokens.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>reindex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Populate our internal token list if the targeted attribute of the subject element isn't empty. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Return the number of tokens in the underlying string. Read-only. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineGetter(that, "length", function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Override the default toString/toLocaleString methods to return a space-delimited list of tokens when typecast. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.toLocaleString =</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.toString = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return tokens.join(" ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.item = function (idx) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return tokens[idx];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.contains = function (token) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return !!tokenMap[token];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.add = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop.apply(that, args = arguments);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var args, token, i = 0, l = args.length; i &lt; l; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>token = args[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!tokenMap[token]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokens.push(token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokenMap[token] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Update the targeted attribute of the attached element if the token list's changed. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (length !== tokens.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = tokens.length &gt;&gt;&gt; 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof el[prop] === "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>el[prop].baseVal = tokens.join(" ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>el[prop] = tokens.join(" ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>reindex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.remove = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop.apply(that, args = arguments);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Build a hash of token names to compare against when recollecting our token list. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var args, ignore = {}, i = 0, t = []; i &lt; args.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ignore[args[i]] = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete tokenMap[args[i]];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Run through our tokens list and reassign only those that aren't defined in the hash declared above. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (i = 0; i &lt; tokens.length; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!ignore[tokens[i]]) t.push(tokens[i]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokens = t;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = t.length &gt;&gt;&gt; 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Update the targeted attribute of the attached element. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof el[prop] === "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>el[prop].baseVal = tokens.join(" ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>el[prop] = tokens.join(" ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>reindex();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.toggle = function (token, force) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>preop.apply(that, [token]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Token state's being forced. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (undefined !== force) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (force) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.add(token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.remove(token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Token already exists in tokenList. Remove it, and return FALSE. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (tokenMap[token]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.remove(token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Otherwise, add the token and return TRUE. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that.add(token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return that;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return _DOMTokenList;</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// DOMTokenList</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nativeImpl = "DOMTokenList" in global &amp;&amp; global.DOMTokenList;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>!nativeImpl ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>!!document.createElementNS &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>!!document.createElementNS('http://www.w3.org/2000/svg', 'svg') &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>!(document.createElementNS("http://www.w3.org/2000/svg", "svg").classList instanceof DOMTokenList)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.DOMTokenList = _DOMTokenList;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Add second argument to native DOMTokenList.toggle() if necessary</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = document.createElement('span');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!('classList' in e)) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.toggle('x', false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!e.classList.contains('x')) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.constructor.prototype.toggle = function toggle(token /*, force*/) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var force = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (force === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var add = !this.contains(token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this[add ? 'add' : 'remove'](token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return add;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>force = !!force;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this[force ? 'add' : 'remove'](token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return force;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Add multiple arguments to native DOMTokenList.add() if necessary</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = document.createElement('span');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!('classList' in e)) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.add('a', 'b');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e.classList.contains('b')) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var native = e.classList.constructor.prototype.add;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.constructor.prototype.add = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var args = arguments;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var l = arguments.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; l; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>native.call(this, args[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Add multiple arguments to native DOMTokenList.remove() if necessary</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = document.createElement('span');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!('classList' in e)) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.add('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.add('b');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.remove('a', 'b');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!e.classList.contains('b')) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var native = e.classList.constructor.prototype.remove;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.classList.constructor.prototype.remove = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var args = arguments;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var l = arguments.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; l; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>native.call(this, args[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.CreateDataProperty</span></p>
<p class="p1"><span class="s1">// 7.3.4. CreateDataProperty ( O, P, V )</span></p>
<p class="p1"><span class="s1">// NOTE</span></p>
<p class="p1"><span class="s1">// This abstract operation creates a property whose attributes are set to the same defaults used for properties created by the ECMAScript language assignment operator.</span></p>
<p class="p1"><span class="s1">// Normally, the property will not already exist. If it does exist and is not configurable or if O is not extensible, [[DefineOwnProperty]] will return false.</span></p>
<p class="p1"><span class="s1">function CreateDataProperty(O, P, V) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let newDesc be the PropertyDescriptor{ [[Value]]: V, [[Writable]]: true, [[Enumerable]]: true, [[Configurable]]: true }.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var newDesc = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: V,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return ? O.[[DefineOwnProperty]](P, newDesc).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(O, P, newDesc);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.CreateDataPropertyOrThrow</span></p>
<p class="p1"><span class="s1">/* global CreateDataProperty */</span></p>
<p class="p1"><span class="s1">// 7.3.6. CreateDataPropertyOrThrow ( O, P, V )</span></p>
<p class="p1"><span class="s1">function CreateDataPropertyOrThrow(O, P, V) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let success be ? CreateDataProperty(O, P, V).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var success = CreateDataProperty(O, P, V);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If success is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!success) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Cannot assign value `' + Object.prototype.toString.call(V) + '` to property `' + Object.prototype.toString.call(P) + '` on object `' + Object.prototype.toString.call(O) + '`');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return success.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return success;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.FlattenIntoArray</span></p>
<p class="p1"><span class="s1">/* globals ToString, HasProperty, Get, Call, IsArray, ToLength, CreateDataPropertyOrThrow */</span></p>
<p class="p1"><span class="s1">// 22.1.3.10.1 FlattenIntoArray(target, source, sourceLen, start, depth [ , mapperFunction, thisArg ])</span></p>
<p class="p1"><span class="s1">function FlattenIntoArray(target, source, sourceLen, start, depth /* , mapperFunction, thisArg */ ) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var mapperFunction = arguments[5];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var thisArg = arguments[6];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 1. Let targetIndex be start.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var targetIndex = start;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 2. Let sourceIndex be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var sourceIndex = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 3. Repeat, while sourceIndex &lt; sourceLen</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>while (sourceIndex &lt; sourceLen) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// a. Let P be ! ToString(sourceIndex).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var P = ToString(sourceIndex);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// b. Let exists be ? HasProperty(source, P).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var exists = HasProperty(source, P);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// c. If exists is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (exists === true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// i. Let element be ? Get(source, P).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var element = Get(source, P);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// ii. If mapperFunction is present, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (5 in arguments) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 1. Assert: thisArg is present.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 2. Set element to ? Call(mapperFunction, thisArg , « element, sourceIndex, source »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>element = Call(mapperFunction, thisArg, [element, sourceIndex, source]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// iii. Let shouldFlatten be false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var shouldFlatten = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// iv. If depth &gt; 0, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (depth &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 1. Set shouldFlatten to ? IsArray(element).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>shouldFlatten = IsArray(element);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// v. If shouldFlatten is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (shouldFlatten === true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 1. Let elementLen be ? ToLength(? Get(element, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var elementLen = ToLength(Get(element, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 2. Set targetIndex to ? FlattenIntoArray(target, element, elementLen, targetIndex, depth - 1).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>targetIndex = FlattenIntoArray(target, element, elementLen, targetIndex, depth - 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// vi. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 1. If targetIndex ≥ 253-1, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (targetIndex &gt;= (Math.pow(2, 53) - 1)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>throw new TypeError("targetIndex is greater than or equal to 2^53-1");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 2. Perform ? CreateDataPropertyOrThrow(target, ! ToString(targetIndex), element).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>CreateDataPropertyOrThrow(target, ToString(targetIndex), element);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// 3. Increase targetIndex by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>targetIndex += 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// d. Increase sourceIndex by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>sourceIndex += 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 4. Return targetIndex.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return targetIndex;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">// _ESAbstract.CreateIterResultObject</span></p>
<p class="p1"><span class="s1">/* global Type, CreateDataProperty */</span></p>
<p class="p1"><span class="s1">// 7.4.7. CreateIterResultObject ( value, done )</span></p>
<p class="p1"><span class="s1">function CreateIterResultObject(value, done) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(done) is Boolean.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(done) !== 'boolean') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let obj be ObjectCreate(%ObjectPrototype%).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var obj = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Perform CreateDataProperty(obj, "value", value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateDataProperty(obj, "value", value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Perform CreateDataProperty(obj, "done", done).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateDataProperty(obj, "done", done);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return obj.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return obj;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.CreateMethodProperty</span></p>
<p class="p1"><span class="s1">// 7.3.5. CreateMethodProperty ( O, P, V )</span></p>
<p class="p1"><span class="s1">function CreateMethodProperty(O, P, V) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Assert: IsPropertyKey(P) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let newDesc be the PropertyDescriptor{[[Value]]: V, [[Writable]]: true, [[Enumerable]]: false, [[Configurable]]: true}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var newDesc = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: V,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return ? O.[[DefineOwnProperty]](P, newDesc).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(O, P, newDesc);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.isArray</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsArray */</span></p>
<p class="p1"><span class="s1">// 22.1.2.2. Array.isArray ( arg )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array, 'isArray', function isArray(arg) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Return ? IsArray(arg).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return IsArray(arg);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.copyWithin</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, HasProperty, ToInteger */</span></p>
<p class="p1"><span class="s1">// 22.1.3.3 Array.prototype.copyWithin ( target, start [ , end ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'copyWithin', function copyWithin(target, start /* [ , end ] */ ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var end = arguments[2];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.1 Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (this === null || this === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Cannot call method on ' + this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var o = Object(this);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.2 Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToInteger(o.length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>len = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>len = Math.pow(2, 53) - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>len = Math.min(len, Math.pow(2, 53) - 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>len = Math.max(len, 0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.3 Let relativeTarget be ? ToInteger(target).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var relativeTarget = ToInteger(target);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.4 If relativeTarget &lt; 0, let to be max((len + relativeTarget), 0); else let to be min(relativeTarget, len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var to;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (relativeTarget &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>to = Math.max(len + relativeTarget, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>to = Math.min(relativeTarget, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.5 Let relativeStart be ? ToInteger(start).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var relativeStart = ToInteger(start);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.6 If relativeStart &lt; 0, let from be max((len + relativeStart), 0); else let from be min(relativeStart, len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var from;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (relativeStart &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>from = Math.max(len + relativeStart, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>from = Math.min(relativeStart, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.7 If end is undefined, let relativeEnd be len; else let relativeEnd be ? ToInteger(end).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var relativeEnd;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (end === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>relativeEnd = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>relativeEnd = ToInteger(end);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.8 If relativeEnd &lt; 0, let final be max((len + relativeEnd), 0); else let final be min(relativeEnd, len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var final;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (relativeEnd &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>final = Math.max(len + relativeEnd, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>final = Math.min(relativeEnd, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.9 Let count be min(final-from, len-to).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var count = Math.min(final - from, len - to);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.10 If from&lt;to and to&lt;from+count, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var direction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (from &lt; to &amp;&amp; to &lt; from + count) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.10.a Let direction be -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>direction = -1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.10.b Let from be from + count - 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>from = from + count - 1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.10.c Let to be to + count - 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>to = to + count - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.11 Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.11.a Let direction be 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>direction = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.12 Repeat, while count &gt; 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (count &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.a Let fromKey be ! ToString(from).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var fromKey = String(from);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.b Let toKey be ! ToString(to).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var toKey = String(to);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.c Let fromPresent be ? HasProperty(O, fromKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var fromPresent = HasProperty(o, fromKey);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.d If fromPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (fromPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.d.i Let fromVal be ? Get(O, fromKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var fromVal = o[fromKey];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.d.ii Perform ? Set(O, toKey, fromVal, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>o[toKey] = fromVal;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.e Else fromPresent is false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.e.i Perform ? DeletePropertyOrThrow(O, toKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete o[toKey];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.f Let from be from + direction.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>from = from + direction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.g Let to be to + direction.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>to = to + direction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 22.1.3.3.12.h Let count be count - 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>count = count - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.3.3.13 Return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return o;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.every</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, HasProperty, IsCallable, ToBoolean, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.5. Array.prototype.every ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'every', function every(callbackfn /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let testResult be ToBoolean(? Call(callbackfn, T, « kValue, k, O »)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var testResult = ToBoolean(Call(callbackfn, T, [kValue, k, O]));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If testResult is false, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (testResult === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.fill</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Get, ToInteger, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.6. Array.prototype.fill ( value [ , start [ , end ] ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'fill', function fill(value /* [ , start [ , end ] ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var start = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var end = arguments[2];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let relativeStart be ? ToInteger(start).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var relativeStart = ToInteger(start);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If relativeStart &lt; 0, let k be max((len + relativeStart), 0); else let k be min(relativeStart, len)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = relativeStart &lt; 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If end is undefined, let relativeEnd be len; else let relativeEnd be ? ToInteger(end).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var relativeEnd = end === undefined ? len : ToInteger(end);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. If relativeEnd &lt; 0, let final be max((len + relativeEnd), 0); else let final be min(relativeEnd, len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var final = relativeEnd &lt; 0 ? Math.max((len + relativeEnd), 0) : Math.min(relativeEnd, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Repeat, while k &lt; final</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; final) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Perform ? Set(O, Pk, value, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>O[Pk] = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return O;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.find</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, IsCallable, ToBoolean, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.8 Array.prototype.find ( predicate [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'find', function find( predicate /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(predicate) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(predicate) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(predicate + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var testResult = ToBoolean(Call(predicate, T, [kValue, k, O ]));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If testResult is true, return kValue.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (testResult) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return kValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.findIndex</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, IsCallable, ToBoolean, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.9. Array.prototype.findIndex ( predicate [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'findIndex', function findIndex(predicate /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(predicate) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(predicate) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(predicate + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var testResult = ToBoolean(Call(predicate, T, [kValue, k, O]));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If testResult is true, return k.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (testResult) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.forEach</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, HasProperty, IsCallable, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.10. Array.prototype.forEach ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'forEach', function forEach(callbackfn /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - If O is a String object, split it into an array in order to iterate correctly.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// We will use arrayLike in place of O when we are iterating through the list.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var arraylike = O instanceof String ? O.split('') : O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Perform ? Call(callbackfn, T, « kValue, k, O »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Call(callbackfn, T, [kValue, k, O]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// NodeList.prototype.forEach</span></p>
<p class="p1"><span class="s1">NodeList.prototype.forEach = Array.prototype.forEach;</span></p>
<p class="p1"><span class="s1">// Array.prototype.includes</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Get, SameValueZero, ToInteger, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.11. Array.prototype.includes ( searchElement [ , fromIndex ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'includes', function includes(searchElement /* [ , fromIndex ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If len is 0, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let n be ? ToInteger(fromIndex). (If fromIndex is undefined, this step produces the value 0.)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var n = ToInteger(arguments[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If n ≥ 0, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (n &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let k be n.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = n;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Else n &lt; 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let k be len + n.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = len + n;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If k &lt; 0, let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (k &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let elementK be the result of ? Get(O, ! ToString(k)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var elementK = Get(O, ToString(k));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If SameValueZero(searchElement, elementK) is true, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (SameValueZero(searchElement, elementK)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.indexOf</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Get, HasProperty, ToInteger, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.12. Array.prototype.indexOf ( searchElement [ , fromIndex ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'indexOf', function indexOf(searchElement /* [ , fromIndex ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If len is 0, return -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let n be ? ToInteger(fromIndex). (If fromIndex is undefined, this step produces the value 0.)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var n = ToInteger(arguments[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If n ≥ len, return -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (n &gt;= len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. If n ≥ 0, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (n &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If n is -0, let k be +0; else let k be n.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = n === -0 ? 0 : n;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Else n &lt; 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let k be len + n.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = len + n;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If k &lt; 0, let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (k &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let kPresent be ? HasProperty(O, ! ToString(k)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(O, ToString(k));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let elementK be ? Get(O, ! ToString(k)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var elementK = Get(O, ToString(k));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let same be the result of performing Strict Equality Comparison searchElement === elementK.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var same = searchElement === elementK;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If same is true, return k.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (same) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Return -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.after</span></p>
<p class="p1"><span class="s1">Document.prototype.after = Element.prototype.after = function after() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (this.parentNode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var args = Array.prototype.slice.call(arguments),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viableNextSibling = this.nextSibling,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>idx = viableNextSibling ? args.indexOf(viableNextSibling) : -1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (idx !== -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viableNextSibling = viableNextSibling.nextSibling;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!viableNextSibling) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>idx = args.indexOf(viableNextSibling);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.parentNode.insertBefore(_mutation(arguments), viableNextSibling);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Not all UAs support the Text constructor.<span class="Apple-converted-space">  </span>Polyfill on the Text constructor only where it exists</span></p>
<p class="p1"><span class="s1">// TODO: Add a polyfill for the Text constructor, and make it a dependency of this polyfill.</span></p>
<p class="p1"><span class="s1">if ("Text" in this) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Text.prototype.after = Element.prototype.after;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.before</span></p>
<p class="p1"><span class="s1">Document.prototype.before = Element.prototype.before = function before() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (this.parentNode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var args = Array.prototype.slice.call(arguments),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viablePreviousSibling = this.previousSibling,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>idx = viablePreviousSibling ? args.indexOf(viablePreviousSibling) : -1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (idx !== -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viablePreviousSibling = viablePreviousSibling.previousSibling;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!viablePreviousSibling) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>idx = args.indexOf(viablePreviousSibling);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.parentNode.insertBefore(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_mutation(arguments),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viablePreviousSibling ? viablePreviousSibling.nextSibling : this.parentNode.firstChild</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Not all UAs support the Text constructor.<span class="Apple-converted-space">  </span>Polyfill on the Text constructor only where it exists</span></p>
<p class="p1"><span class="s1">// TODO: Add a polyfill for the Text constructor, and make it a dependency of this polyfill.</span></p>
<p class="p1"><span class="s1">if ("Text" in this) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Text.prototype.before = Element.prototype.before;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.lastIndexOf</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Get, HasProperty, ToInteger, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.15. Array.prototype.lastIndexOf ( searchElement [ , fromIndex ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'lastIndexOf', function lastIndexOf(searchElement /* [ , fromIndex ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If len is 0, return -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If fromIndex is present, let n be ? ToInteger(fromIndex); else let n be len-1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var n = arguments.length &gt; 1 ? ToInteger(arguments[1]) : len - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If n ≥ 0, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (n &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If n is -0, let k be +0; else let k be min(n, len - 1).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = n === -0 ? 0 : Math.min(n, len - 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Else n &lt; 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let k be len + n.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = len + n;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Repeat, while k ≥ 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let kPresent be ? HasProperty(O, ! ToString(k)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(O, ToString(k));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let elementK be ? Get(O, ! ToString(k)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var elementK = Get(O, ToString(k));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let same be the result of performing Strict Equality Comparison searchElement === elementK.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var same = searchElement === elementK;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If same is true, return k.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (same) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Decrease k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Return -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.reduce</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, HasProperty, IsCallable, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.19. Array.prototype.reduce ( callbackfn [ , initialValue ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'reduce', function reduce(callbackfn /* [ , initialValue ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - If O is a String object, split it into an array in order to iterate correctly.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// We will use arrayLike in place of O when we are iterating through the list.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var arraylike = O instanceof String ? O.split('') : O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(arraylike, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If len is 0 and initialValue is not present, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var initialValue = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len === 0 &amp;&amp; arguments.length &lt; 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Reduce of empty array with no initial value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let accumulator be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var accumulator = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If initialValue is present, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (arguments.length &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Set accumulator to initialValue.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>accumulator = initialValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Else initialValue is not present,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let kPresent be false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Repeat, while kPresent is false and k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (kPresent === false &amp;&amp; k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Set accumulator to ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var accumulator = Get(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iv. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Reduce of empty array with no initial value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Set accumulator to ? Call(callbackfn, undefined, « accumulator, kValue, k, O »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>accumulator = Call(callbackfn, undefined, [accumulator, kValue, k, O]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Return accumulator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return accumulator;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.reduceRight</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, HasProperty, IsCallable, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.20. Array.prototype.reduceRight ( callbackfn [ , initialValue ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'reduceRight', function reduceRight(callbackfn /* [ , initialValue ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - If O is a String object, split it into an array in order to iterate correctly.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// We will use arrayLike in place of O when we are iterating through the list.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var arraylike = O instanceof String ? O.split('') : O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(arraylike, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If len is 0 and initialValue is not present, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var initialValue = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (len === 0 &amp;&amp; arguments.length &lt; 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Reduce of empty array with no initial value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be len-1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = len - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let accumulator be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var accumulator = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If initialValue is present, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (arguments.length &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Set accumulator to initialValue.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>accumulator = initialValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8.Else initialValue is not present,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let kPresent be false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Repeat, while kPresent is false and k ≥ 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (kPresent === false &amp;&amp; k &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Set accumulator to ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>accumulator = Get(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iv. Decrease k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Reduce of empty array with no initial value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Repeat, while k ≥ 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(arraylike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Set accumulator to ? Call(callbackfn, undefined, « accumulator, kValue, k, O »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>accumulator = Call(callbackfn, undefined, [accumulator, kValue, k, O]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Decrease k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10 Return accumulator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return accumulator;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.some</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, HasProperty, IsCallable, ToBoolean, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.3.24. Array.prototype.some ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'some', function some(callbackfn /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let testResult be ToBoolean(? Call(callbackfn, T, « kValue, k, O »)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var testResult = ToBoolean(Call(callbackfn, T, [kValue, k, O]));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If testResult is true, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (testResult) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Function.prototype.bind</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsCallable */</span></p>
<p class="p1"><span class="s1">// 19.2.3.2. Function.prototype.bind ( thisArg, ...args )</span></p>
<p class="p1"><span class="s1">// https://github.com/es-shims/es5-shim/blob/d6d7ff1b131c7ba14c798cafc598bb6780d37d3b/es5-shim.js#L182</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Function.prototype, 'bind', function bind(that) { // .length is 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// add necessary es5-shim utilities</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var $Array = Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var $Object = Object;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ArrayPrototype = $Array.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var Empty = function Empty() { };</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var array_slice = ArrayPrototype.slice;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var array_concat = ArrayPrototype.concat;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var array_push = ArrayPrototype.push;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var max = Math.max;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// /add necessary es5-shim utilities</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let Target be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var target = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If IsCallable(Target) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!IsCallable(target)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Function.prototype.bind called on incompatible ' + target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let A be a new (possibly empty) internal list of all of the</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>argument values provided after thisArg (arg1, arg2 etc), in order.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// XXX slicedArgs will stand in for "A" if used</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var args = array_slice.call(arguments, 1); // for normal call</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let F be a new native ECMAScript object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 11. Set the [[Prototype]] internal property of F to the standard</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>built-in Function prototype object as specified in 15.3.3.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 12. Set the [[Call]] internal property of F as described in</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>15.3.4.5.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 13. Set the [[Construct]] internal property of F as described in</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>15.3.4.5.2.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 14. Set the [[HasInstance]] internal property of F as described in</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>15.3.4.5.3.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var bound;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var binder = function () {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this instanceof bound) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 15.3.4.5.2 [[Construct]]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// When the [[Construct]] internal method of a function object,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// F that was created using the bind function is called with a</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// list of arguments ExtraArgs, the following steps are taken:</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let target be the value of F's [[TargetFunction]]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>internal property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If target has no [[Construct]] internal method, a</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>TypeError exception is thrown.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let boundArgs be the value of F's [[BoundArgs]] internal</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let args be a new list containing the same values as the</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>list boundArgs in the same order followed by the same</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>values as the list ExtraArgs in the same order.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Return the result of calling the [[Construct]] internal</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>method of target providing args as the arguments.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var result = target.apply(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>array_concat.call(args, array_slice.call(arguments))</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ($Object(result) === result) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 15.3.4.5.1 [[Call]]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// When the [[Call]] internal method of a function object, F,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// which was created using the bind function is called with a</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// this value and a list of arguments ExtraArgs, the following</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// steps are taken:</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let boundArgs be the value of F's [[BoundArgs]] internal</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Let boundThis be the value of F's [[BoundThis]] internal</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let target be the value of F's [[TargetFunction]] internal</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let args be a new list containing the same values as the</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>list boundArgs in the same order followed by the same</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>values as the list ExtraArgs in the same order.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Return the result of calling the [[Call]] internal method</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>of target providing boundThis as the this value and</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>providing args as the arguments.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// equiv: target.call(this, ...boundArgs, ...args)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return target.apply(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>that,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>array_concat.call(args, array_slice.call(arguments))</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 15. If the [[Class]] internal property of Target is "Function", then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">    </span>a. Let L be the length property of Target minus the length of A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">    </span>b. Set the length own property of F to either 0 or L, whichever is</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">      </span>larger.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 16. Else set the length own property of F to 0.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var boundLength = max(0, target.length - args.length);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 17. Set the attributes of the length own property of F to the values</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>specified in 15.3.5.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var boundArgs = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; boundLength; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>array_push.call(boundArgs, '$' + i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// XXX Build a dynamic function with desired amount of arguments is the only</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// way to set the length property of a function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// In environments where Content Security Policies enabled (Chrome extensions,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// for ex.) all use of eval or Function costructor throws an exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// However in all of these environments Function.prototype.bind exists</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// and so this code will never be executed.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>bound = Function('binder', 'return function (' + boundArgs.join(',') + '){ return binder.apply(this, arguments); }')(binder);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (target.prototype) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Empty.prototype = target.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bound.prototype = new Empty();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Clean up dangling references.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Empty.prototype = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// TODO</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 18. Set the [[Extensible]] internal property of F to true.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// TODO</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 19. Let thrower be the [[ThrowTypeError]] function Object (13.2.3).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 20. Call the [[DefineOwnProperty]] internal method of F with</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>arguments "caller", PropertyDescriptor {[[Get]]: thrower, [[Set]]:</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>thrower, [[Enumerable]]: false, [[Configurable]]: false}, and</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 21. Call the [[DefineOwnProperty]] internal method of F with</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>arguments "arguments", PropertyDescriptor {[[Get]]: thrower,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>[[Set]]: thrower, [[Enumerable]]: false, [[Configurable]]: false},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// <span class="Apple-converted-space">  </span>and false.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// TODO</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// NOTE Function objects created using Function.prototype.bind do not</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// have a prototype property or the [[Code]], [[FormalParameters]], and</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// [[Scope]] internal properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// XXX can't delete prototype in pure-js.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22. Return F.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return bound;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.acosh</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.3. Math.acosh ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'acosh', function acosh(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is less than 1, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &lt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is 1, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.log(x + Math.sqrt(x * x - 1));</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.asinh</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.5. Math.asinh ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'asinh', function asinh(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +0, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -0, the result is -0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -∞, the result is -∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.log(x + Math.sqrt(x * x + 1));</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.atanh</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.7. Math.atanh ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'atanh', function atanh(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is less than -1, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &lt; -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is greater than 1, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -1, the result is -∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +1, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +0, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -0, the result is -0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.log((1 + x) / (1 - x)) / 2;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.cbrt</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.9. Math.cbrt ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'cbrt', function cbrt(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +0, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -0, the result is -0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -∞, the result is -∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var y = Math.pow(Math.abs(x), 1 / 3);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return x &lt; 0 ? -y : y;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.clz32</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToUint32 */</span></p>
<p class="p1"><span class="s1">// 20.2.2.11. Math.clz32 ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'clz32', function clz32(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let n be ToUint32(x).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var n = ToUint32(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let p be the number of leading zero bits in the 32-bit binary representation of n.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var p = n ? 32 - n.toString(2).length : 32;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return p.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return p;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.cosh</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.1. 3Math.cosh ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'cosh', function cosh(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +0, the result is 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -0, the result is 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>x = Math.abs(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &gt; 709) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var y = Math.exp(0.5 * x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return y / 2 * y;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var y = Math.exp(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return (y + 1 / y) / 2;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.expm1</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.15. Math.expm1 ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'expm1', function expm1(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +0, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -0, the result is -0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === 0 &amp;&amp; 1/x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -∞, the result is -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &gt; -1e-6 &amp;&amp; x &lt; 1e-6) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return x + x * x / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Math.exp(x) - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.fround</span></p>
<p class="p1"><span class="s1">/* global Float32Array, CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.17 Math.fround ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'fround', function (x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If x is NaN, return NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If x is one of +0, -0, +∞, -∞, return x.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1 / x === +Infinity || 1 / x === -Infinity || x === +Infinity || x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return x;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let x32 be the result of converting x to a value in IEEE 754-2008 binary32 format using roundTiesToEven.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let x64 be the result of converting x32 to a value in IEEE 754-2008 binary64 format.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return the ECMAScript Number value corresponding to x64.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return (new Float32Array([x]))[0];</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.hypot</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.18. Math.hypot ( value1, value2, ...values )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'hypot', function hypot(value1, value2) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If no arguments are passed, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (arguments.length === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var y = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var max = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; arguments.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// If any argument is +∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arguments[i] === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// If any argument is -∞, the result is +∞.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arguments[i] === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Infinity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// If no argument is +∞ or -∞, and any argument is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// If all arguments are either +0 or -0, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - The two conditions above are handled in the math.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var arg = Math.abs(Number(arguments[i]));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arg &gt; max) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>y = y * Math.pow(max / arg, 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>max = arg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arg !== 0 || max !== 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>y = y + Math.pow(arg / max, 2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return max * Math.sqrt(y);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.imul</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToUint32 */</span></p>
<p class="p1"><span class="s1">// 20.2.2.19. Math.imul ( x, y )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'imul', function imul(x, y) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let a be ToUint32(x).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var a = ToUint32(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let b be ToUint32(y).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var b = ToUint32(y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var UINT16 = 0xffff;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var aHigh = a &gt;&gt;&gt; 16 &amp; UINT16;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var aLow = UINT16 &amp; a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var bHigh = b &gt;&gt;&gt; 16 &amp; UINT16;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var bLow = UINT16 &amp; b;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// the shift by 0 fixes the sign on the high part</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// the final |0 converts the unsigned value into a signed value</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return aLow * bLow + (aHigh * bLow + aLow * bHigh &lt;&lt; 16 &gt;&gt;&gt; 0) | 0;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p1"><span class="s1">// Math.log10</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.22. Math.log10 ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'log10', function log10(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.log(x) / Math.LN10;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.log1p</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.21. Math.log1p ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'log1p', function log1p(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>x = Number(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (-1 &lt; x &amp;&amp; x &lt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - For numbers in the range −1 &lt; x &lt; 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Because we are using log, the precision of the result will be identical to log(1).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// To fix this we avoid using log and use the Taylor Series expansion of log.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// This series converges when |x| &lt; 1. As we can not sum to infinity,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// we instead sum the first 300 parts of the series to give a close approximation.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// |x|&lt;1, log(1+x) = x - x^2/2 + x^3/3 - ... + (-1)^(n-1)*x^n/n + ...</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var y = x;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 2; i &lt;= 300; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>y += Math.pow((-1), (i - 1)) * Math.pow(x, i) / i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return y;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.log(1 + x);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p1"><span class="s1">// Math.log2</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.23. Math.log2 ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'log2', function log2(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Math.log(x) / Math.LN2;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.sign</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.29. Math.sign ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'sign', function sign(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var x = Number(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is NaN, the result is NaN.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(x)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return NaN;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is -0, the result is -0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1 / x === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is +0, the result is +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1 / x === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is negative and not -0, the result is -1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// If x is positive and not +0, the result is +1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (x &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.sinh</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.31. Math.sinh ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'sinh', function sinh(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var s = (x &lt; 0) ? -1 : 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var absx = Math.abs(x);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (absx &lt; 22) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (absx &lt; Math.pow(2, -28)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return x;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var t = Math.exp(absx) - 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (absx &lt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return (s * (2 * t - t * t / (t + 1)))/2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return (s * (t + t / (t + 1)))/2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (absx &lt; 709.7822265625) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return (s * Math.exp(absx))/2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var w = Math.exp(0.5 * absx);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var t = (s * w)/2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return t * w;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.tanh</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.2.2.34. Math.tanh ( x )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'tanh', function tanh(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var y;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return x === Infinity ? 1 : x === -Infinity ? -1 : (y = Math.exp(2 * x), (y - 1) / (y + 1));</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Math.trunc</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Math, 'trunc', function trunc(x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return x &lt; 0 ? Math.ceil(x) : Math.floor(x);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.isFinite</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 20.1.2.2. Number.isFinite ( number )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Number, 'isFinite', function isFinite(number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If Type(number) is not Number, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(number) !== 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If number is NaN, +∞, or -∞, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Otherwise, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - We use isFinite as it implements steps 2 and 3.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return that.isFinite(number);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.isInteger</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToInteger, Type */</span></p>
<p class="p1"><span class="s1">// 20.1.2.3. Number.isInteger ( number )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Number, 'isInteger', function isInteger(number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(number) is not Number, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(number) !== 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If number is NaN, +∞, or -∞, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(number) || number === Infinity || number === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let integer be ToInteger(number).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var integer = ToInteger(number);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If integer is not equal to number, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (integer !== number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Otherwise, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.isNaN</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var that = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 20.1.2.4. Number.isNaN ( number )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Number, 'isNaN', function isNaN(number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If Type(number) is not Number, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(number) !== 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If number is NaN, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (that.isNaN(number)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.isSafeInteger</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type, ToInteger */</span></p>
<p class="p1"><span class="s1">// 20.1.2.5. Number.isSafeInteger ( number )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Number, 'isSafeInteger', function isSafeInteger(number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(number) is not Number, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(number) !== 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If number is NaN, +∞, or -∞, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isNaN(number) || number === Infinity || number === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let integer be ToInteger(number).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var integer = ToInteger(number);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If integer is not equal to number, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (integer !== number) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If abs(integer) ≤ 2^53-1, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Math.abs(integer) &lt;= (Math.pow(2, 53) - 1)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.parseFloat</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.1.2.12. Number.parseFloat ( string )</span></p>
<p class="p1"><span class="s1">// The value of the Number.parseFloat data property is the same built-in function object that is the value of the<span class="Apple-converted-space">  </span>parseFloat property of the global object defined in 18.2.4.</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Number, 'parseFloat', parseFloat);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.parseInt</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 20.1.2.13. Number.parseInt ( string, radix )</span></p>
<p class="p1"><span class="s1">// The value of the Number.parseInt data property is the same built-in function object that is the value of the<span class="Apple-converted-space">  </span>parseInt property of the global object defined in 18.2.5.</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Number, 'parseInt', parseInt);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.classList</span></p>
<p class="p1"><span class="s1">/*</span></p>
<p class="p1"><span class="s1">Copyright (c) 2016, John Gardner</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var dpSupport = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var defineGetter = function (object, name, fn, configurable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Object.defineProperty)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(object, name, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false === dpSupport ? true : !!configurable,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: fn</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else object.__defineGetter__(name, fn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>/** Ensure the browser allows Object.defineProperty to be used on native JavaScript objects. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineGetter({}, "support");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>dpSupport = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>/** Polyfills a property with a DOMTokenList */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var addProp = function (o, name, attr) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineGetter(o.prototype, name, function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var tokenList;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var THIS = this,</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Prevent this from firing twice for some reason. What the hell, IE. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gibberishProperty = "__defineGetter__" + "DEFINE_PROPERTY" + name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(THIS[gibberishProperty]) return tokenList;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>THIS[gibberishProperty] = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * IE8 can't define properties on native JavaScript objects, so we'll use a dumb hack instead.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> *</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * What this is doing is creating a dummy element ("reflection") inside a detached phantom node ("mirror")</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * that serves as the target of Object.defineProperty instead. While we could simply use the subject HTML</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * element instead, this would conflict with element types which use indexed properties (such as forms and</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * select lists).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (false === dpSupport) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var visage;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var mirror = addProp.mirror || document.createElement("div");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var reflections = mirror.childNodes;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var l = reflections.length;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; l; ++i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (reflections[i]._R === THIS) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>visage = reflections[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/** Couldn't find an element's reflection inside the mirror. Materialise one. */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>visage || (visage = mirror.appendChild(document.createElement("div")));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>tokenList = DOMTokenList.call(visage, THIS, attr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else tokenList = new DOMTokenList(THIS, attr);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineGetter(THIS, name, function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return tokenList;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete THIS[gibberishProperty];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return tokenList;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>addProp(global.Element, "classList", "className");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>addProp(global.HTMLElement, "classList", "className");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>addProp(global.HTMLLinkElement, "relList", "rel");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>addProp(global.HTMLAnchorElement, "relList", "rel");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>addProp(global.HTMLAreaElement, "relList", "rel");</span></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.placeholder</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Element.prototype, 'placeholder', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>get: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this.getAttribute('placeholder');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>set: function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!value || !/^(input|textarea)$/i.test(this.nodeName) || (/^(input)$/i.test(this.nodeName) &amp;&amp; !/^(email|number|password|search|tel|text|url|)$/i.test(this.getAttribute('type')))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element = this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xInput = document.createElement('ms-input'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholder = xInput.appendChild(document.createElement('ms-placeholder')),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xInputRuntimeStyle = xInput.runtimeStyle,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle = xPlaceholder.runtimeStyle,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elementCurrentStyle = element.currentStyle;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholder.appendChild(document.createTextNode(value));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xInputRuntimeStyle.display = 'inline-block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xInputRuntimeStyle.fontSize = elementCurrentStyle.fontSize;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xInputRuntimeStyle.margin = elementCurrentStyle.margin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xInputRuntimeStyle.width = elementCurrentStyle.width;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.parentNode.insertBefore(xInput, element).appendChild(element);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.backgroundColor = 'transparent';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.fontFamily = elementCurrentStyle.fontFamily;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.fontSize = elementCurrentStyle.fontSize;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.fontWeight = elementCurrentStyle.fontWeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.margin = '2px 0 0 2px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.padding = elementCurrentStyle.padding;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.position = 'absolute';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.display = element.value ? 'none' : 'inline-block';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.runtimeStyle.margin = '0';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholder.attachEvent('onclick', function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.attachEvent('onkeypress', function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.attachEvent('onkeyup', function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholderRuntimeStyle.display = element.value ? 'none' : 'inline-block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(element, 'placeholder', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return xPlaceholder.innerHTML;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xPlaceholder.innerHTML = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">document.attachEvent('onreadystatechange', function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (document.readyState === 'complete') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var elements = document.querySelectorAll('input,textarea'), index = 0, length = elements.length; index &lt; length; ++index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (elements[index].placeholder) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elements[index].placeholder = elements[index].placeholder;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Function.prototype.name</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>accessorName = 'name',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>fnNameMatchRegex = /^\s*function\s+([^\(\s]*)\s*/,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>$Function = Function,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>FunctionName = 'Function',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>FunctionProto = $Function.prototype,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>FunctionProtoCtor = FunctionProto.constructor,</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>getFunctionName = function(fn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var match, name;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (fn === $Function || fn === FunctionProtoCtor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>name = FunctionName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else if (fn !== FunctionProto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>match = ('' + fn).match(fnNameMatchRegex);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>name = match &amp;&amp; match[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return name || '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(FunctionProto, accessorName, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function Function$name() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fn = this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fnName = getFunctionName(fn);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Since named function definitions have immutable names, also memoize the</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// output by defining the `name` property directly on this Function</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// instance so the accessor function will not need to be invoked again.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (fn !== FunctionProto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(fn, accessorName, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: fnName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return fnName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.Epsilon</span></p>
<p class="p1"><span class="s1">// 20.1.2.1. Number.EPSILON</span></p>
<p class="p1"><span class="s1">// The value of Number.EPSILON is the difference between 1 and the smallest value greater than 1 that is representable as a Number value, which is approximately 2.2204460492503130808472633361816 x 10-16.</span></p>
<p class="p1"><span class="s1">// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Number, 'EPSILON', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>value: Math.pow(2, -52)</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.MAX_SAFE_INTEGER</span></p>
<p class="p1"><span class="s1">// 20.1.2.6. Number.MAX_SAFE_INTEGER</span></p>
<p class="p1"><span class="s1">// The value of Number.MAX_SAFE_INTEGER is 9007199254740991 (2^53-1).</span></p>
<p class="p1"><span class="s1">// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Number, 'MAX_SAFE_INTEGER', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>value: Math.pow(2, 53) - 1</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Number.MIN_SAFE_INTEGER</span></p>
<p class="p1"><span class="s1">// 20.1.2.8. Number.MIN_SAFE_INTEGER</span></p>
<p class="p1"><span class="s1">// The value of Number.MIN_SAFE_INTEGER is -9007199254740991 (-(253-1)).</span></p>
<p class="p1"><span class="s1">// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Number, 'MIN_SAFE_INTEGER', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>value: -(Math.pow(2, 53) - 1)</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.freeze</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 19.1.2.6. Object.freeze ( O )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'freeze', function freeze(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This feature cannot be implemented fully as a polyfill.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// We choose to silently fail which allows "securable" code</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// to "gracefully" degrade to working but insecure code.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return O;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.getOwnPropertyDescriptor</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var call = Function.prototype.call;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var prototypeOfObject = Object.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var owns = call.bind(prototypeOfObject.hasOwnProperty);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var lookupGetter;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var lookupSetter;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var supportsAccessors;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if ((supportsAccessors = owns(prototypeOfObject, "__defineGetter__"))) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>lookupGetter = call.bind(prototypeOfObject.__lookupGetter__);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>lookupSetter = call.bind(prototypeOfObject.__lookupSetter__);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function doesGetOwnPropertyDescriptorWork(object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>object.sentinel = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>return Object.getOwnPropertyDescriptor(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>object,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>"sentinel"</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>).value === 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>} catch (exception) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// returns falsy</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// check whether getOwnPropertyDescriptor works if it's given. Otherwise,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// shim partially.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Object.defineProperty) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>var getOwnPropertyDescriptorWorksOnObject =</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>doesGetOwnPropertyDescriptorWork({});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>var getOwnPropertyDescriptorWorksOnDom = typeof document == "undefined" ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>doesGetOwnPropertyDescriptorWork(document.createElement("div"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>if (!getOwnPropertyDescriptorWorksOnDom ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>!getOwnPropertyDescriptorWorksOnObject</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>var getOwnPropertyDescriptorFallback = Object.getOwnPropertyDescriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!Object.getOwnPropertyDescriptor || getOwnPropertyDescriptorFallback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>var ERR_NON_OBJECT = "Object.getOwnPropertyDescriptor called on a non-object: ";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>CreateMethodProperty(Object, 'getOwnPropertyDescriptor', function getOwnPropertyDescriptor(object, property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>if ((typeof object != "object" &amp;&amp; typeof object != "function") || object === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>throw new TypeError(ERR_NON_OBJECT + object);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// make a valiant attempt to use the real getOwnPropertyDescriptor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// for I8's DOM elements.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>if (getOwnPropertyDescriptorFallback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>return getOwnPropertyDescriptorFallback.call(Object, object, property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>} catch (exception) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>// try the shim if the real one doesn't work</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// If object does not owns property return undefined immediately.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>if (!owns(object, property)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// If object has a property then it's for sure both `enumerable` and</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// `configurable`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>var descriptor = { enumerable: true, configurable: true };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// If JS engine supports accessor properties then property may be a</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// getter or setter.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>if (supportsAccessors) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>// Unfortunately `__lookupGetter__` will return a getter even</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>// if object has own non getter property along with a same named</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>// inherited getter. To avoid misbehavior we temporary remove</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>// `__proto__` so that `__lookupGetter__` will return getter only</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>// if it's owned by an object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>var prototype = object.__proto__;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>object.__proto__ = prototypeOfObject;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>var getter = lookupGetter(object, property);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>var setter = lookupSetter(object, property);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>// Once we have getter and setter we can put values back.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>object.__proto__ = prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>if (getter || setter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>if (getter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                    </span>descriptor.get = getter;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>if (setter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                    </span>descriptor.set = setter;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>// If it was accessor property we're done and return here</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>// in order to avoid adding `value` to the descriptor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">                </span>return descriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// If we got this far we know that object has an own property that is</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>// not an accessor so we set it as a value and return descriptor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>descriptor.value = object[property];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>descriptor.writable = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>return descriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.EnumerableOwnProperties</span></p>
<p class="p1"><span class="s1">/* globals Type, Get */</span></p>
<p class="p1"><span class="s1">// 7.3.21. EnumerableOwnProperties ( O, kind )</span></p>
<p class="p1"><span class="s1">function EnumerableOwnProperties(O, kind) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: Type(O) is Object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let ownKeys be ? O.[[OwnPropertyKeys]]().</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ownKeys = Object.keys(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let properties be a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var properties = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. For each element key of ownKeys in List order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var length = ownKeys.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var key = ownKeys[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If Type(key) is String, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(key) === 'string') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let desc be ? O.[[GetOwnProperty]](key).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var desc = Object.getOwnPropertyDescriptor(O, key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. If desc is not undefined and desc.[[Enumerable]] is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (desc &amp;&amp; desc.enumerable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If kind is "key", append key to properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kind === 'key') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>properties.push(key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let value be ? Get(O, key).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var value = Get(O, key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If kind is "value", append value to properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kind === 'value') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>properties.push(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Assert: kind is "key+value".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let entry be CreateArrayFromList(« key, value »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entry = [key, value];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Append entry to properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>properties.push(entry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Order the elements of properties so they are in the same relative order as would be produced by the Iterator that would be returned if the EnumerateObjectProperties internal method were invoked with O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Return properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return properties;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.entries</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, EnumerableOwnProperties, ToObject */</span></p>
<p class="p1"><span class="s1">// 19.1.2.5. Object.entries ( O )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'entries', function entries(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let obj be ? ToObject(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var obj = ToObject(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let nameList be ? EnumerableOwnProperties(obj, "key+value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nameList = EnumerableOwnProperties(obj, "key+value");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return CreateArrayFromList(nameList).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - nameList is already an array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return nameList;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Element.prototype.dataset</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Element.prototype, 'dataset', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>get: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var element = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var attributes = this.attributes;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var map = {};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; attributes.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var attribute = attributes[i];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (attribute &amp;&amp; attribute.name &amp;&amp; (/^data-\w[\w\-]*$/).test(attribute.name)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var name = attribute.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var value = attribute.value;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var propName = name.substr(5).replace(/-./g, function (prop) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return prop.charAt(1).toUpperCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(map, propName, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}.bind({value: value || ''}),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: function setter(name, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof value !== 'undefined') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.setAttribute(name, value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.removeAttribute(name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}.bind(element, name)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.getOwnPropertyNames</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">var toString = ({}).toString;</span></p>
<p class="p1"><span class="s1">var split = ''.split;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'getOwnPropertyNames', function getOwnPropertyNames(object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var buffer = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var key;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Non-enumerable properties cannot be discovered but can be checked for by name.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Define those used internally by JS to allow an incomplete solution</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var commonProps = ['length', "name", "arguments", "caller", "prototype", "observe", "unobserve"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (typeof object === 'undefined' || object === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Cannot convert undefined or null to object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io fallback for non-array-like strings which exist in some ES3 user-agents (IE 8)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>object = toString.call(object) == '[object String]' ? split.call(object, '') : Object(object);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Enumerable properties only</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (key in object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Object.prototype.hasOwnProperty.call(object, key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>buffer.push(key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Check for and add the common non-enumerable properties</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i=0, s=commonProps.length; i&lt;s; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (commonProps[i] in object) buffer.push(commonProps[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return buffer;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.getPrototypeOf</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// Based on: https://github.com/es-shims/es5-shim/blob/master/es5-sham.js</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// https://github.com/es-shims/es5-shim/issues#issue/2</span></p>
<p class="p1"><span class="s1">// http://ejohn.org/blog/objectgetprototypeof/</span></p>
<p class="p1"><span class="s1">// recommended by fschaefer on github</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// sure, and webreflection says ^_^</span></p>
<p class="p1"><span class="s1">// ... this will nerever possibly return null</span></p>
<p class="p1"><span class="s1">// ... Opera Mini breaks here with infinite loops</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'getPrototypeOf', function getPrototypeOf(object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (object !== Object(object)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Object.getPrototypeOf called on non-object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var proto = object.__proto__;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (proto || proto === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return proto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else if (typeof object.constructor == 'function' &amp;&amp; object instanceof object.constructor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return object.constructor.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} else if (object instanceof Object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Object.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Correctly return null for Objects created with `Object.create(null)`</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// (shammed or native) or `{ __proto__: null}`.<span class="Apple-converted-space">  </span>Also returns null for</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// cross-realm objects on browsers that lack `__proto__` support (like</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE &lt;11), but that's the best we can do.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.is</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, SameValue */</span></p>
<p class="p1"><span class="s1">// 19.1.2.12. Object.is ( value1, value2 )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'is', function is(value1, value2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Return SameValue(value1, value2).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return SameValue(value1, value2);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.isExtensible</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function (nativeIsExtensible) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 19.1.2.13 Object.isExtensible ( O )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CreateMethodProperty(Object, 'isExtensible', function isExtensible(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 1. If Type(O) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Type(O) !== "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 2. Return ? IsExtensible(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return nativeIsExtensible ? nativeIsExtensible(O) : true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}(Object.isExtensible));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.isFrozen</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p1"><span class="s1">(function (nativeIsFrozen) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 19.1.2.14 Object.isFrozen ( O )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CreateMethodProperty(Object, 'isFrozen', function isFrozen(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 1. If Type(O) is not Object, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Type(O) !== "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 2. Return ? TestIntegrityLevel(O, "frozen").</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return nativeIsFrozen ? nativeIsFrozen(O) : false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}(Object.isFrozen));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.isSealed</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p1"><span class="s1">(function (nativeisSealed) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 19.1.2.15 Object.isSealed ( O )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CreateMethodProperty(Object, 'isSealed', function isSealed(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 1. If Type(O) is not Object, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Type(O) !== "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 2. Return ? TestIntegrityLevel(O, "sealed").</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return nativeisSealed ? nativeisSealed(O) : false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}(Object.isSealed));<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">// Object.keys</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, "keys", (function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// modified from https://github.com/es-shims/object-keys</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var has = Object.prototype.hasOwnProperty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var toStr = Object.prototype.toString;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var isEnumerable = Object.prototype.propertyIsEnumerable;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var hasDontEnumBug = !isEnumerable.call({ toString: null }, 'toString');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var hasProtoEnumBug = isEnumerable.call(function () {}, 'prototype');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var dontEnums = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'toString',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'toLocaleString',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'valueOf',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'hasOwnProperty',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'isPrototypeOf',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'propertyIsEnumerable',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'constructor'</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var equalsConstructorPrototype = function (o) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var ctor = o.constructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return ctor &amp;&amp; ctor.prototype === o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var excludedKeys = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$console: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$external: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$frame: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$frameElement: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$frames: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$innerHeight: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$innerWidth: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$outerHeight: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$outerWidth: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$pageXOffset: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$pageYOffset: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$parent: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$scrollLeft: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$scrollTop: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$scrollX: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$scrollY: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$self: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$webkitIndexedDB: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$webkitStorageInfo: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$window: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var hasAutomationEqualityBug = (function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* global window */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof window === 'undefined') { return false; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var k in window) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!excludedKeys['$' + k] &amp;&amp; has.call(window, k) &amp;&amp; window[k] !== null &amp;&amp; typeof window[k] === 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>equalsConstructorPrototype(window[k]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var equalsConstructorPrototypeIfNotBuggy = function (o) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* global window */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof window === 'undefined' || !hasAutomationEqualityBug) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return equalsConstructorPrototype(o);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return equalsConstructorPrototype(o);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function isArgumentsObject(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var str = toStr.call(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var isArgs = str === '[object Arguments]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!isArgs) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>isArgs = str !== '[object Array]' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value !== null &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>typeof value === 'object' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>typeof value.length === 'number' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value.length &gt;= 0 &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>toStr.call(value.callee) === '[object Function]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return isArgs;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return function keys(object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var isFunction = toStr.call(object) === '[object Function]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var isArguments = isArgumentsObject(object);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var isString = toStr.call(object) === '[object String]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var theKeys = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (object === undefined || object === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Cannot convert undefined or null to object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var skipProto = hasProtoEnumBug &amp;&amp; isFunction;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (isString &amp;&amp; object.length &gt; 0 &amp;&amp; !has.call(object, 0)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; object.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theKeys.push(String(i));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (isArguments &amp;&amp; object.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var j = 0; j &lt; object.length; ++j) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theKeys.push(String(j));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var name in object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(skipProto &amp;&amp; name === 'prototype') &amp;&amp; has.call(object, name)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theKeys.push(String(name));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (hasDontEnumBug) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var skipConstructor = equalsConstructorPrototypeIfNotBuggy(object);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var k = 0; k &lt; dontEnums.length; ++k) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(skipConstructor &amp;&amp; dontEnums[k] === 'constructor') &amp;&amp; has.call(object, dontEnums[k])) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>theKeys.push(dontEnums[k]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return theKeys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}()));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.assign</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Get, ToObject */</span></p>
<p class="p1"><span class="s1">// 19.1.2.1 Object.assign ( target, ...sources )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'assign', function assign(target, source) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let to be ? ToObject(target).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var to = ToObject(target);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If only one argument was passed, return to.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (arguments.length === 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return to;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let sources be the List of argument values starting with the second argument</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var sources = Array.prototype.slice.call(arguments, 1);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. For each element nextSource of sources, in ascending index order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var index1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var index2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var from;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (index1 = 0; index1 &lt; sources.length; index1++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextSource = sources[index1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If nextSource is undefined or null, let keys be a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (nextSource === undefined || nextSource === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keys = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let from be ! ToObject(nextSource).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>from = ToObject(nextSource);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let keys be ? from.[[OwnPropertyKeys]]().</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/*</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>This step in our polyfill is not complying with the specification.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[[OwnPropertyKeys]] is meant to return ALL keys, including non-enumerable and symbols.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>TODO: When we have Reflect.ownKeys, use that instead as it is the userland equivalent of [[OwnPropertyKeys]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keys = Object.keys(from);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. For each element nextKey of keys in List order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (index2 = 0; index2 &lt; keys.length; index2++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextKey = keys[index2];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let desc be ? from.[[GetOwnProperty]](nextKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var desc = Object.getOwnPropertyDescriptor(from, nextKey);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. If desc is not undefined and desc.[[Enumerable]] is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (desc !== undefined &amp;&amp; desc.enumerable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let propValue be ? Get(from, nextKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var propValue = Get(from, nextKey);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Perform ? Set(to, nextKey, propValue, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>to[nextKey] = propValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return to.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return to;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.defineProperties</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Get, ToObject, Type */</span></p>
<p class="p1"><span class="s1">// 19.1.2.3. Object.defineProperties ( O, Properties )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'defineProperties', function defineProperties(O, Properties) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(O) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(O) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Object.defineProperties called on non-object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let props be ? ToObject(Properties).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var props = ToObject(Properties);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let keys be ? props.[[OwnPropertyKeys]]().</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>/*</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Polyfill.io - This step in our polyfill is not complying with the specification.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[[OwnPropertyKeys]] is meant to return ALL keys, including non-enumerable and symbols.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>TODO: When we have Reflect.ownKeys, use that instead as it is the userland equivalent of [[OwnPropertyKeys]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var keys = Object.keys(props);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let descriptors be a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var descriptors = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. For each element nextKey of keys in List order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; keys.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextKey = keys[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let propDesc be ? props.[[GetOwnProperty]](nextKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var propDesc = Object.getOwnPropertyDescriptor(props, nextKey);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If propDesc is not undefined and propDesc.[[Enumerable]] is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (propDesc !== undefined &amp;&amp; propDesc.enumerable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let descObj be ? Get(props, nextKey).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var descObj = Get(props, nextKey);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let desc be ? ToPropertyDescriptor(descObj).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - We skip this step because Object.defineProperty deals with it.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// TODO: Implement this step?</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var desc = descObj;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Append the pair (a two element List) consisting of nextKey and desc to the end of descriptors.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>descriptors.push([nextKey, desc]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. For each pair from descriptors in list order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; descriptors.length; i++){</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let P be the first element of pair.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var P = descriptors[i][0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let desc be the second element of pair.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var desc = descriptors[i][1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Perform ? DefinePropertyOrThrow(O, P, desc).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(O, P, desc);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return O;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// location.origin</span></p>
<p class="p1"><span class="s1">try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(window.location, 'origin', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : ''),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">} catch(e) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// IE9 is throwing "Object doesn't support this action" when attempting defineProperty on window.location, so provide an alternative</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>window.location.origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.create</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'create', function create(O, properties) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If Type(O) is neither Object nor Null, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(O) !== 'object' &amp;&amp; Type(O) !== 'null') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Object prototype may only be an Object or null');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let obj be ObjectCreate(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var obj = new Function('e', 'function Object() {}Object.prototype=e;return new Object')(O);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>obj.constructor.prototype = O;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If Properties is not undefined, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1 in arguments) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Return ? ObjectDefineProperties(obj, Properties).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Object.defineProperties(obj, properties);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return obj;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.GetIterator</span></p>
<p class="p1"><span class="s1">/* global GetMethod, Symbol, Call, Type, GetV */</span></p>
<p class="p1"><span class="s1">// 7.4.1. GetIterator ( obj [ , method ] )</span></p>
<p class="p1"><span class="s1">// The abstract operation GetIterator with argument obj and optional argument method performs the following steps:</span></p>
<p class="p1"><span class="s1">function GetIterator(obj /*, method */) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If method is not present, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Set method to ? GetMethod(obj, @@iterator).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var method = arguments.length &gt; 1 ? arguments[1] : GetMethod(obj, Symbol.iterator);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let iterator be ? Call(method, obj).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var iterator = Call(method, obj);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If Type(iterator) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(iterator) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('bad iterator');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let nextMethod be ? GetV(iterator, "next").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nextMethod = GetV(iterator, "next");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let iteratorRecord be Record {[[Iterator]]: iterator, [[NextMethod]]: nextMethod, [[Done]]: false}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var iteratorRecord = Object.create(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>iteratorRecord['[[Iterator]]'] = iterator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>iteratorRecord['[[NextMethod]]'] = nextMethod;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>iteratorRecord['[[Done]]'] = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Return iteratorRecord.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return iteratorRecord;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.OrdinaryCreateFromConstructor</span></p>
<p class="p1"><span class="s1">/* global GetPrototypeFromConstructor */</span></p>
<p class="p1"><span class="s1">// 9.1.13. OrdinaryCreateFromConstructor ( constructor, intrinsicDefaultProto [ , internalSlotsList ] )</span></p>
<p class="p1"><span class="s1">function OrdinaryCreateFromConstructor(constructor, intrinsicDefaultProto) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var internalSlotsList = arguments[2] || {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: intrinsicDefaultProto is a String value that is this specification's name of an intrinsic object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The corresponding object must be an intrinsic that is intended to be used as the[[Prototype]] value of an object.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let proto be ? GetPrototypeFromConstructor(constructor, intrinsicDefaultProto).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var proto = GetPrototypeFromConstructor(constructor, intrinsicDefaultProto);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return ObjectCreate(proto, internalSlotsList).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We do not pass internalSlotsList to Object.create because Object.create does not use the default ordinary object definitions specified in 9.1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var obj = Object.create(proto);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var name in internalSlotsList) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Object.prototype.hasOwnProperty.call(internalSlotsList, name)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(obj, name, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: internalSlotsList[name]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return obj;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.Construct</span></p>
<p class="p1"><span class="s1">/* global IsConstructor, OrdinaryCreateFromConstructor, Call */</span></p>
<p class="p1"><span class="s1">// 7.3.13. Construct ( F [ , argumentsList [ , newTarget ]] )</span></p>
<p class="p1"><span class="s1">function Construct(F /* [ , argumentsList [ , newTarget ]] */) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. If newTarget is not present, set newTarget to F.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var newTarget = arguments.length &gt; 2 ? arguments[2] : F;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If argumentsList is not present, set argumentsList to a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var argumentsList = arguments.length &gt; 1 ? arguments[1] : [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Assert: IsConstructor(F) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!IsConstructor(F)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('F must be a constructor.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Assert: IsConstructor(newTarget) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!IsConstructor(newTarget)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('newTarget must be a constructor.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Return ? F.[[Construct]](argumentsList, newTarget).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - If newTarget is the same as F, it is equivalent to new F(...argumentsList).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (newTarget === F) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new (Function.prototype.bind.apply(F, [null].concat(argumentsList)))();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - This is mimicking section 9.2.2 step 5.a.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var obj = OrdinaryCreateFromConstructor(newTarget, Object.prototype);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Call(F, obj, argumentsList);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ESAbstract.ArraySpeciesCreate</span></p>
<p class="p1"><span class="s1">/* global IsArray, ArrayCreate, Get, Type, IsConstructor, Construct */</span></p>
<p class="p1"><span class="s1">// 9.4.2.3. ArraySpeciesCreate ( originalArray, length )</span></p>
<p class="p1"><span class="s1">function ArraySpeciesCreate(originalArray, length) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Assert: length is an integer Number ≥ 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. If length is -0, set length to +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (1/length === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let isArray be ? IsArray(originalArray).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var isArray = IsArray(originalArray);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If isArray is false, return ? ArrayCreate(length).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isArray === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return ArrayCreate(length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let C be ? Get(originalArray, "constructor").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var C = Get(originalArray, 'constructor');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We skip this section as not sure how to make a cross-realm normal Array, a same-realm Array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. If IsConstructor(C) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// if (IsConstructor(C)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let thisRealm be the current Realm Record.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let realmC be ? GetFunctionRealm(C).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If thisRealm and realmC are not the same Realm Record, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. If SameValue(C, realmC.[[Intrinsics]].[[%Array%]]) is true, set C to undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// }</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If Type(C) is Object, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Type(C) === 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Set C to ? Get(C, @@species).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>C = 'Symbol' in this &amp;&amp; 'species' in this.Symbol ? Get(C, this.Symbol.species) : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If C is null, set C to undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (C === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>C = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. If C is undefined, return ? ArrayCreate(length).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (C === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return ArrayCreate(length);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. If IsConstructor(C) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!IsConstructor(C)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('C must be a constructor');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Return ? Construct(C, « length »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Construct(C, [length]);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.filter</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject, ToLength, Get, IsCallable, ArraySpeciesCreate, ToString, HasProperty, ToBoolean, Call, CreateDataPropertyOrThrow */</span></p>
<p class="p1"><span class="s1">// 22.1.3.7. Array.prototype.filter ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'filter', function filter(callbackfn /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let A be ? ArraySpeciesCreate(O, 0).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var A = ArraySpeciesCreate(O, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Let to be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var to = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let selected be ToBoolean(? Call(callbackfn, T, « kValue, k, O »)).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var selected = ToBoolean(Call(callbackfn, T, [kValue, k, O]));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. If selected is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (selected) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Perform ? CreateDataPropertyOrThrow(A, ! ToString(to), kValue)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateDataPropertyOrThrow(A, ToString(to), kValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Increase to by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>to = to + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return A;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.flat</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject, ToLength, Get, ToInteger, ArraySpeciesCreate, FlattenIntoArray */</span></p>
<p class="p1"><span class="s1">// 22.1.3.10 Array.prototype.flat( [ depth ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'flat', function flat() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"use strict";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var depth = arguments[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 2. Let sourceLen be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var sourceLen = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 3. Let depthNum be 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var depthNum = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 4. If depth is not undefined, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (depth !== void 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// a. Set depthNum to ? ToInteger(depth).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>depthNum = ToInteger(depth);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 5. Let A be ? ArraySpeciesCreate(O, 0).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var A = ArraySpeciesCreate(O,0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 6. Perform ? FlattenIntoArray(A, O, sourceLen, 0, depthNum).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>FlattenIntoArray(A, O, sourceLen, 0, depthNum);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 7. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return A;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p1"><span class="s1">// Array.prototype.flatMap</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject, ToLength, Get, IsCallable, ArraySpeciesCreate, FlattenIntoArray */</span></p>
<p class="p1"><span class="s1">// 22.1.3.11 Array.prototype.flatMap ( mapperFunction [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'flatMap', function flatMap(mapperFunction /* , thisArg */ ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"use strict";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 2. Let sourceLen be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var sourceLen = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 3. If IsCallable(mapperFunction) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (IsCallable(mapperFunction) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throw new TypeError('mapperFunction is not callable.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var T;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (1 in arguments) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>T = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>T = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 5. Let A be ? ArraySpeciesCreate(O, 0).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var A = ArraySpeciesCreate(O, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 6. Perform ? FlattenIntoArray(A, O, sourceLen, 0, 1, mapperFunction, T).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>FlattenIntoArray(A, O, sourceLen, 0, 1, mapperFunction, T);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 7. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return A;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.map</span></p>
<p class="p1"><span class="s1">/* global ArraySpeciesCreate, Call, CreateDataPropertyOrThrow, CreateMethodProperty, Get, HasProperty, IsCallable, ToLength, ToObject, ToString */</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject, ToLength, Get, ArraySpeciesCreate, ToString, HasProperty, Call, CreateDataPropertyOrThrow */</span></p>
<p class="p1"><span class="s1">// 22.1.3.16. Array.prototype.map ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'map', function map(callbackfn /* [ , thisArg ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let len be ? ToLength(? Get(O, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = ToLength(Get(O, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsCallable(callbackfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callbackfn + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let A be ? ArraySpeciesCreate(O, len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var A = ArraySpeciesCreate(O, len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kPresent be ? HasProperty(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kPresent = HasProperty(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If kPresent is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (kPresent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let kValue be ? Get(O, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(O, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let mappedValue be ? Call(callbackfn, T, « kValue, k, O »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var mappedValue = Call(callbackfn, T, [kValue, k, O]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Perform ? CreateDataPropertyOrThrow(A, Pk, mappedValue).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateDataPropertyOrThrow(A, Pk, mappedValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return A;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.of</span></p>
<p class="p1"><span class="s1">/* global ArrayCreate, Construct, CreateDataPropertyOrThrow, CreateMethodProperty, IsConstructor, ToString */</span></p>
<p class="p1"><span class="s1">// 22.1.2.3. Array.of ( ...items )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array, 'of', function of() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let len be the actual number of arguments passed to this function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = arguments.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let items be the List of arguments passed to this function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var items = arguments;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let C be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var C = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If IsConstructor(C) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (IsConstructor(C)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let A be ? Construct(C, « len »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var A = Construct(C, [len]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let A be ? ArrayCreate(len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var A = ArrayCreate(len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let kValue be items[k].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = items[k];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Perform ? CreateDataPropertyOrThrow(A, Pk, kValue).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateDataPropertyOrThrow(A, Pk, kValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = k + 1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Perform ? Set(A, "length", len, true)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>A["length"] = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return A;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.preventExtensions</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">(function (nativePreventExtensions) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// 19.1.2.17 Object.preventExtensions ( O )</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CreateMethodProperty(Object, 'preventExtensions', function preventExtensions(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 1. If Type(O) is not Object, return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (TypeError(O) !== "object") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 2. Let status be ? O.[[PreventExtensions]]().</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (nativePreventExtensions) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>nativePreventExtensions(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 3. If status is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 4. Return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}(Object.preventExtensions));<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">// Object.seal</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Type */</span></p>
<p class="p1"><span class="s1">// 19.1.2.19 Object.seal ( O )</span></p>
<p class="p1"><span class="s1">(function(originalObjectSeal) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CreateMethodProperty(Object, 'seal', function seal(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 1. If Type(O) is not Object, return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (Type(O) === 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 2. Let status be ? SetIntegrityLevel(O, "sealed").</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 3. If status is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// 4. Return O.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return originalObjectSeal ? originalObjectSeal(O) : O;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}(Object.seal));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.setPrototypeOf</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// ES6-shim 0.16.0 (c) 2013-2014 Paul Miller (http://paulmillr.com)</span></p>
<p class="p1"><span class="s1">// ES6-shim may be freely distributed under the MIT license.</span></p>
<p class="p1"><span class="s1">// For more details and documentation:</span></p>
<p class="p1"><span class="s1">// https://github.com/paulmillr/es6-shim/</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>// NOTE:<span class="Apple-converted-space">  </span>This versions needs object ownership</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//<span class="Apple-converted-space">        </span>because every promoted object needs to be reassigned</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//<span class="Apple-converted-space">        </span>otherwise uncompatible browsers cannot work as expected</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// NOTE:<span class="Apple-converted-space">  </span>This might need es5-shim or polyfills upfront</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//<span class="Apple-converted-space">        </span>because it's based on ES5 API.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//<span class="Apple-converted-space">        </span>(probably just an IE &lt;= 8 problem)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// NOTE:<span class="Apple-converted-space">  </span>nodejs is fine in version 0.8, 0.10, and future versions.</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Object.setPrototypeOf) { return; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>/*jshint proto: true */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// @author<span class="Apple-converted-space">    </span>Andrea Giammarchi - @WebReflection</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var getOwnPropertyNames = Object.getOwnPropertyNames;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var create = Object.create;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var defineProperty = Object.defineProperty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var getPrototypeOf = Object.getPrototypeOf;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var objProto = Object.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var copyDescriptors = function (target, source) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// define into target descriptors from source</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>getOwnPropertyNames(source).forEach(function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineProperty(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>target,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>key,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>getOwnPropertyDescriptor(source, key)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// used as fallback when no promotion is possible</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var createAndCopy = function setPrototypeOf(origin, proto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return copyDescriptors(create(proto), origin);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var set, sPOf;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// this might fail for various reasons</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ignore if Chrome cought it at runtime</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set = getOwnPropertyDescriptor(objProto, '__proto__').set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set.call({}, null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// setter not poisoned, it can promote</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Firefox, Chrome</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sPOf = function setPrototypeOf(origin, proto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set.call(origin, proto);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return origin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// do one or more feature detections</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set = { __proto__: null };</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// if proto does not work, needs to fallback</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// some Opera, Rhino, ducktape</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (set instanceof Object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sPOf = createAndCopy;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// verify if null objects are buggy</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* eslint-disable no-proto */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set.__proto__ = objProto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* eslint-enable no-proto */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// if null objects are buggy</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// nodejs 0.8 to 0.10</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (set instanceof Object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sPOf = function setPrototypeOf(origin, proto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// use such bug to promote</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* eslint-disable no-proto */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>origin.__proto__ = proto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* eslint-enable no-proto */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return origin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// try to use proto or fallback</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Safari, old Firefox, many others</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sPOf = function setPrototypeOf(origin, proto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// if proto is not null</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (getPrototypeOf(origin)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// use __proto__ to promote</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* eslint-disable no-proto */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>origin.__proto__ = proto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/* eslint-enable no-proto */</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return origin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// otherwise unable to promote: fallback</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return createAndCopy(origin, proto);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Object, 'setPrototypeOf', sPOf);</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Object.values</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject */</span></p>
<p class="p1"><span class="s1">// 19.1.2.21. Object.values ( O )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Object, 'values', function values(O) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let obj be ? ToObject(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var obj = ToObject(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let nameList be ? EnumerableOwnProperties(obj, "value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nameList = Object.keys(obj).map(function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return obj[key];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return CreateArrayFromList(nameList).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - nameList is already an array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return nameList;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// performance.now</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">var startTime = Date.now();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">if (!global.performance) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.performance = {};</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">global.performance.now = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return Date.now() - startTime;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Promise</span></p>
<p class="p1"><span class="s1">!function(n){function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e={};t.m=n,t.c=e,t.i=function(n){return n},t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var e=n&amp;&amp;n.__esModule?function(){return n["default"]}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=100)}({100:/*!***********************!*\</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>!*** ./src/global.js ***!</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>\***********************/</span></p>
<p class="p1"><span class="s1">function(n,t,e){(function(n){var t=e(/*! ./yaku */5);try{n.Promise=t,window.Promise=t}catch(r){}}).call(t,e(/*! ./../~/webpack/buildin/global.js */2))},2:/*!***********************************!*\</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>!*** (webpack)/buildin/global.js ***!</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>\***********************************/</span></p>
<p class="p1"><span class="s1">function(n,t){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(r){"object"==typeof window&amp;&amp;(e=window)}n.exports=e},5:/*!*********************!*\</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>!*** ./src/yaku.js ***!</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>\*********************/</span></p>
<p class="p1"><span class="s1">function(n,t,e){(function(t){!function(){"use strict";function e(){return rn[q][B]||D}function r(n){return n&amp;&amp;"object"==typeof n}function o(n){return"function"==typeof n}function i(n,t){return n instanceof t}function u(n){return i(n,M)}function c(n,t,e){if(!t(n))throw h(e)}function f(){try{return R.apply(S,arguments)}catch(n){return nn.e=n,nn}}function s(n,t){return R=n,S=t,f}function a(n,t){function e(){for(var e=0;e&lt;o;)t(r[e],r[e+1]),r[e++]=P,r[e++]=P;o=0,r.length&gt;n&amp;&amp;(r.length=n)}var r=A(n),o=0;return function(n,t){r[o++]=n,r[o++]=t,2===o&amp;&amp;rn.nextTick(e)}}function l(n,t){var e,r,u,c,f=0;if(!n)throw h(Q);var a=n[rn[q][z]];if(o(a))r=a.call(n);else{if(!o(n.next)){if(i(n,A)){for(e=n.length;f&lt;e;)t(n[f],f++);return f}throw h(Q)}r=n}for(;!(u=r.next()).done;)if((c=s(t)(u.value,f++))===nn)throw o(r[G])&amp;&amp;r[G](),c.e;return f}function h(n){return new TypeError(n)}function v(n){return(n?"":V)+(new M).stack}function _(n,t){var e="on"+n.toLowerCase(),r=O[e];H&amp;&amp;H.listeners(n).length?n===Z?H.emit(n,t._v,t):H.emit(n,t):r?r({reason:t._v,promise:t}):rn[n](t._v,t)}function p(n){return n&amp;&amp;n._s}function d(n){if(p(n))return new n(tn);var t,e,r;return t=new n(function(n,o){if(t)throw h();e=n,r=o}),c(e,o),c(r,o),t}function w(n,t){var e=!1;return function(r){e||(e=!0,L&amp;&amp;(n[N]=v(!0)),t===Y?k(n,r):x(n,t,r))}}function y(n,t,e,r){return o(e)&amp;&amp;(t._onFulfilled=e),o(r)&amp;&amp;(n[J]&amp;&amp;_(X,n),t._onRejected=r),L&amp;&amp;(t._p=n),n[n._c++]=t,n._s!==$&amp;&amp;on(n,t),t}function m(n){if(n._umark)return!0;n._umark=!0;for(var t,e=0,r=n._c;e&lt;r;)if(t=n[e++],t._onRejected||m(t))return!0}function j(n,t){function e(n){return r.push(n.replace(/^\s+|\s+$/g,""))}var r=[];return L&amp;&amp;(t[N]&amp;&amp;e(t[N]),function o(n){n&amp;&amp;K in n&amp;&amp;(o(n._next),e(n[K]+""),o(n._p))}(t)),(n&amp;&amp;n.stack?n.stack:n)+("\n"+r.join("\n")).replace(en,"")}function g(n,t){return n(t)}function x(n,t,e){var r=0,o=n._c;if(n._s===$)for(n._s=t,n._v=e,t===U&amp;&amp;(L&amp;&amp;u(e)&amp;&amp;(e.longStack=j(e,n)),un(n));r&lt;o;)on(n,n[r++]);return n}function k(n,t){if(t===n&amp;&amp;t)return x(n,U,h(W)),n;if(t!==C&amp;&amp;(o(t)||r(t))){var e=s(b)(t);if(e===nn)return x(n,U,e.e),n;o(e)?(L&amp;&amp;p(t)&amp;&amp;(n._next=t),p(t)?T(n,t,e):rn.nextTick(function(){T(n,t,e)})):x(n,Y,t)}else x(n,Y,t);return n}function b(n){return n.then}function T(n,t,e){var r=s(e,t)(function(e){t&amp;&amp;(t=C,k(n,e))},function(e){t&amp;&amp;(t=C,x(n,U,e))});r===nn&amp;&amp;t&amp;&amp;(x(n,U,r.e),t=C)}var P,R,S,C=null,F="object"==typeof self,O=F?self:t,E=O.Promise,H=O.process,I=O.console,L=!1,A=Array,M=Error,U=1,Y=2,$=3,q="Symbol",z="iterator",B="species",D=q+"("+B+")",G="return",J="_uh",K="_pt",N="_st",Q="Invalid argument",V="\nFrom previous ",W="Chaining cycle detected for promise",X="rejectionHandled",Z="unhandledRejection",nn={e:C},tn=function(){},en=/^.+\/node_modules\/yaku\/.+\n?/gm,rn=function(n){var t,e=this;if(!r(e)||e._s!==P)throw h("Invalid this");if(e._s=$,L&amp;&amp;(e[K]=v()),n!==tn){if(!o(n))throw h(Q);t=s(n)(w(e,Y),w(e,U)),t===nn&amp;&amp;x(e,U,t.e)}};rn["default"]=rn,function(n,t){for(var e in t)n[e]=t[e]}(rn.prototype,{then:function(n,t){if(this._s===undefined)throw h();return y(this,d(rn.speciesConstructor(this,rn)),n,t)},"catch":function(n){return this.then(P,n)},"finally":function(n){return this.then(function(t){return rn.resolve(n()).then(function(){return t})},function(t){return rn.resolve(n()).then(function(){throw t})})},_c:0,_p:C}),rn.resolve=function(n){return p(n)?n:k(d(this),n)},rn.reject=function(n){return x(d(this),U,n)},rn.race=function(n){var t=this,e=d(t),r=function(n){x(e,Y,n)},o=function(n){x(e,U,n)},i=s(l)(n,function(n){t.resolve(n).then(r,o)});return i===nn?t.reject(i.e):e},rn.all=function(n){function t(n){x(o,U,n)}var e,r=this,o=d(r),i=[];return(e=s(l)(n,function(n,u){r.resolve(n).then(function(n){i[u]=n,--e||x(o,Y,i)},t)}))===nn?r.reject(e.e):(e||x(o,Y,[]),o)},rn.Symbol=O[q]||{},s(function(){Object.defineProperty(rn,e(),{get:function(){return this}})})(),rn.speciesConstructor=function(n,t){var r=n.constructor;return r?r[e()]||t:t},rn.unhandledRejection=function(n,t){I&amp;&amp;I.error("Uncaught (in promise)",L?t.longStack:j(n,t))},rn.rejectionHandled=tn,rn.enableLongStackTrace=function(){L=!0},rn.nextTick=F?function(n){E?new E(function(n){n()}).then(n):setTimeout(n)}:H.nextTick,rn._s=1;var on=a(999,function(n,t){var e,r;return(r=n._s!==U?t._onFulfilled:t._onRejected)===P?void x(t,n._s,n._v):(e=s(g)(r,n._v))===nn?void x(t,U,e.e):void k(t,e)}),un=a(9,function(n){m(n)||(n[J]=1,_(Z,n))});try{n.exports=rn}catch(cn){O.Yaku=rn}}()}).call(t,e(/*! ./../~/webpack/buildin/global.js */2))}});</span></p>
<p class="p1"><span class="s1">// Promise.prototype.finally</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsCallable, SpeciesConstructor, Type, Promise */</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Based on https://github.com/tc39/proposal-promise-finally/blob/master/polyfill.js</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var then = Function.prototype.bind.call(Function.prototype.call, Promise.prototype.then);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var getPromise = function (C, handler) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new C(function (resolve) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>resolve(handler());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Promise.prototype.finally ( onFinally )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Promise.prototype, 'finally', function (onFinally) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let promise be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var promise = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(promise) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(promise) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method %PromisePrototype%.finally called on incompatible receiver ' + Object.prototype.toString.call(promise));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let C be ? SpeciesConstructor(promise, %Promise%).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var C = SpeciesConstructor(promise, Promise);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Assert: IsConstructor(C) is true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If IsCallable(onFinally) is false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsCallable(onFinally) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let thenFinally be onFinally.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var thenFinally = onFinally;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let catchFinally be onFinally.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var catchFinally = onFinally;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let thenFinally be a new built-in function object as defined in ThenFinally Function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var thenFinally = function (x) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return then(getPromise(C, onFinally), function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return x;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let catchFinally be a new built-in function object as defined in CatchFinally Function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var catchFinally = function (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return then(getPromise(C, onFinally), function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw e;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Set thenFinally and catchFinally's [[Constructor]] internal slots to C.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Set thenFinally and catchFinally's [[OnFinally]] internal slots to onFinally.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return ? Invoke(promise, "then", « thenFinally, catchFinally »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return then(promise, thenFinally, catchFinally);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// RegExp.prototype.flags</span></p>
<p class="p1"><span class="s1">/* global Get, ToBoolean, Type */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(RegExp.prototype, 'flags', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.1 Let R be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var R = this;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.2 If Type(R) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(R) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method called on incompatible type: must be an object.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.3 Let result be the empty String.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var result = '';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.4 Let global be ToBoolean(? Get(R, "global")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var global = ToBoolean(Get(R, 'global'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.5 If global is true, append the code unit 0x0067 (LATIN SMALL LETTER G) as the last code unit of result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result += 'g';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.6 Let ignoreCase be ToBoolean(? Get(R, "ignoreCase")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var ignoreCase = ToBoolean(Get(R, 'ignoreCase'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.7 If ignoreCase is true, append the code unit 0x0069 (LATIN SMALL LETTER I) as the last code unit of result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (ignoreCase) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result += 'i';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.8 Let multiline be ToBoolean(? Get(R, "multiline")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var multiline = ToBoolean(Get(R, 'multiline'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.9 If multiline is true, append the code unit 0x006D (LATIN SMALL LETTER M) as the last code unit of result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (multiline) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result += 'm';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.10 Let unicode be ToBoolean(? Get(R, "unicode")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var unicode = ToBoolean(Get(R, 'unicode'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.11 If unicode is true, append the code unit 0x0075 (LATIN SMALL LETTER U) as the last code unit of result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (unicode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result += 'u';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.12 Let sticky be ToBoolean(? Get(R, "sticky")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var sticky = ToBoolean(Get(R, 'sticky'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.13 If sticky is true, append the code unit 0x0079 (LATIN SMALL LETTER Y) as the last code unit of result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (sticky) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result += 'y';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 21.2.5.3.14 Return result.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// requestAnimationFrame</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var rafPrefix;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// do not inject RAF in order to avoid broken performance</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nowOffset = Date.now();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// use performance api if exist, otherwise use Date.now.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Date.now polyfill required.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var pnow = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (global.performance &amp;&amp; typeof global.performance.now === 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return global.performance.now();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// fallback</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Date.now() - nowOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if ('mozRequestAnimationFrame' in global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>rafPrefix = 'moz';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else if ('webkitRequestAnimationFrame' in global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>rafPrefix = 'webkit';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (rafPrefix) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.requestAnimationFrame = function (callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>return global[rafPrefix + 'RequestAnimationFrame'](function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-converted-space">        </span>callback(pnow());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.cancelAnimationFrame = global[rafPrefix + 'CancelAnimationFrame'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var lastTime = Date.now();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.requestAnimationFrame = function (callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof callback !== 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(callback + ' is not a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>currentTime = Date.now(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delay = 16 + lastTime - currentTime;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (delay &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delay = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>lastTime = currentTime;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return setTimeout(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>lastTime = Date.now();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>callback(pnow());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, delay);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.cancelAnimationFrame = function (id) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>clearTimeout(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// setImmediate</span></p>
<p class="p1"><span class="s1">(function (global, undef) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"use strict";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (global.setImmediate) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var nextHandle = 1; // Spec says greater than zero</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var tasksByHandle = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var currentlyRunningATask = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var doc = global.document;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var setImmediatePolyfill;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function addFromSetImmediateArguments(args) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tasksByHandle[nextHandle] = partiallyApplied.apply(undef, args);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return nextHandle++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// This function accepts the same arguments as setImmediate, but</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// returns a function that requires no arguments.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function partiallyApplied(handler) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var args = [].slice.call(arguments, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (typeof handler === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>handler.apply(undef, args);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>(new Function("" + handler))();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function runIfPresent(handle) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// From the spec: "Wait until any invocations of this algorithm started before this one have completed."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// So if we're currently running a task, we'll need to delay this invocation.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (currentlyRunningATask) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// "too much recursion" error.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setTimeout(partiallyApplied(runIfPresent, handle), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var task = tasksByHandle[handle];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (task) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>currentlyRunningATask = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>task();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>clearImmediate(handle);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>currentlyRunningATask = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function clearImmediate(handle) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>delete tasksByHandle[handle];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function installNextTickImplementation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setImmediatePolyfill = function setImmediate(handler) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var handle = addFromSetImmediateArguments(arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>process.nextTick(partiallyApplied(runIfPresent, handle));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return handle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function canUsePostMessage() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// The test against `importScripts` prevents this implementation from being installed inside a web worker,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// where `global.postMessage` means something completely different and can't be used for this purpose.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (global.postMessage &amp;&amp; !global.importScripts) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var postMessageIsAsynchronous = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var oldOnMessage = global.onmessage;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>global.onmessage = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>postMessageIsAsynchronous = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>global.postMessage("", "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>global.onmessage = oldOnMessage;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return postMessageIsAsynchronous;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function installPostMessageImplementation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Installs an event handler on `global` for the `message` event: see</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// * https://developer.mozilla.org/en/DOM/window.postMessage</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var messagePrefix = "setImmediate$" + Math.random() + "$";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var onGlobalMessage = function(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (event.source === global &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>typeof event.data === "string" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>event.data.indexOf(messagePrefix) === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>runIfPresent(+event.data.slice(messagePrefix.length));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (global.addEventListener) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>global.addEventListener("message", onGlobalMessage, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>global.attachEvent("onmessage", onGlobalMessage);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setImmediatePolyfill = function setImmediate(handler) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var handle = addFromSetImmediateArguments(arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>global.postMessage(messagePrefix + handle, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return handle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function installMessageChannelImplementation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var channel = new MessageChannel();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>channel.port1.onmessage = function(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var handle = event.data;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>runIfPresent(handle);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setImmediatePolyfill = function setImmediate(handler) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var handle = addFromSetImmediateArguments(arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>channel.port2.postMessage(handle);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return handle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function installReadyStateChangeImplementation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var html = doc.documentElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setImmediatePolyfill = function setImmediate(handler) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var handle = addFromSetImmediateArguments(arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Create a &lt;script&gt; element; its readystatechange event will be fired asynchronously once it is inserted</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var script = doc.createElement("script");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>script.onreadystatechange = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>runIfPresent(handle);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>script.onreadystatechange = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>html.removeChild(script);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>script = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>html.appendChild(script);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return handle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function installSetTimeoutImplementation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setImmediatePolyfill = function setImmediate(handler) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var handle = addFromSetImmediateArguments(arguments);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setTimeout(partiallyApplied(runIfPresent, handle), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return handle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var attachTo = Object.getPrototypeOf &amp;&amp; Object.getPrototypeOf(global);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>attachTo = attachTo &amp;&amp; attachTo.setTimeout ? attachTo : global;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Don't get fooled by e.g. browserify environments.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if ({}.toString.call(global.process) === "[object process]") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// For Node.js before 0.9</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>installNextTickImplementation();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (canUsePostMessage()) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// For non-IE10 modern browsers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>installPostMessageImplementation();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (global.MessageChannel) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// For web workers, where supported</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>installMessageChannelImplementation();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (doc &amp;&amp; "onreadystatechange" in doc.createElement("script")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// For IE 6–8</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>installReadyStateChangeImplementation();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// For older browsers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>installSetTimeoutImplementation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>attachTo.setImmediate = setImmediatePolyfill;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>attachTo.clearImmediate = clearImmediate;</span></p>
<p class="p1"><span class="s1">}(this)); // eslint-disable-line no-undef</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.fromCodePoint</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsArray, SameValue, ToInteger, ToNumber, UTF16Encoding */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// 21.1.2.2. String.fromCodePoint ( ...codePoints )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String, 'fromCodePoint', function fromCodePoint(_) { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - List to store the characters whilst iterating over the code points.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var result = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let codePoints be a List containing the arguments passed to this function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var codePoints = arguments;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let length be the number of elements in codePoints.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var length = arguments.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let elements be a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var elements = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let nextIndex be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nextIndex = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Repeat, while nextIndex &lt; length</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>while (nextIndex &lt; length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - We reset the elements List as we store the partial results in the result List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var elements = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let next be codePoints[nextIndex].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var next = codePoints[nextIndex];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let nextCP be ? ToNumber(next).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextCP = ToNumber(next);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If SameValue(nextCP, ToInteger(nextCP)) is false, throw a RangeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (SameValue(nextCP, ToInteger(nextCP)) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new RangeError('Invalid code point ' + Object.prototype.toString.call(nextCP));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If nextCP &lt; 0 or nextCP &gt; 0x10FFFF, throw a RangeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (nextCP &lt; 0 || nextCP &gt; 0x10FFFF) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new RangeError('Invalid code point ' + Object.prototype.toString.call(nextCP));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Append the elements of the UTF16Encoding of nextCP to the end of elements.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - UTF16Encoding can return a single codepoint or a list of multiple codepoints.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var cp = UTF16Encoding(nextCP);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsArray(cp)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elements = elements.concat(cp);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>elements.push(cp);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// f. Let nextIndex be nextIndex + 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nextIndex = nextIndex + 1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - Retrieving the characters whilst iterating enables the function to work in a memory efficient and performant way.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result.push(String.fromCharCode.apply(null, elements));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Return the String value whose elements are, in order, the elements in the List elements. If length is 0, the empty string is returned.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return length === 0 ? '' : result.join('');</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.codePointAt</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, RequireObjectCoercible, ToInteger, ToString, UTF16Decode */</span></p>
<p class="p1"><span class="s1">// 21.1.3.3. String.prototype.codePointAt ( pos )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'codePointAt', function codePointAt(pos) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let position be ? ToInteger(pos).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var position = ToInteger(pos);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let size be the length of S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var size = S.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If position &lt; 0 or position ≥ size, return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (position &lt; 0 || position &gt;= size) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let first be the numeric value of the code unit at index position within the String S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var first = String.prototype.charCodeAt.call(S, position);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If first &lt; 0xD800 or first &gt; 0xDBFF or position+1 = size, return first.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (first &lt; 0xD800 || first &gt; 0xDBFF || position + 1 === size) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return first;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Let second be the numeric value of the code unit at index position+1 within the String S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var second = String.prototype.charCodeAt.call(S, position + 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. If second &lt; 0xDC00 or second &gt; 0xDFFF, return first.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (second &lt; 0xDC00 || second &gt; 0xDFFF) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return first;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Return UTF16Decode(first, second).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 21.1.3.3.10 Return UTF16Decode(first, second).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return UTF16Decode(first, second);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.endsWith</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsRegExp, RequireObjectCoercible, ToInteger, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.6. String.prototype.endsWith ( searchString [ , endPosition ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'endsWith', function endsWith(searchString /* [ , endPosition ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var endPosition = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let isRegExp be ? IsRegExp(searchString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var isRegExp = IsRegExp(searchString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If isRegExp is true, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isRegExp) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('First argument to String.prototype.endsWith must not be a regular expression');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let searchStr be ? ToString(searchString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var searchStr = ToString(searchString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let len be the length of S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = S.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. If endPosition is undefined, let pos be len, else let pos be ? ToInteger(endPosition).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var pos = endPosition === undefined ? len : ToInteger(endPosition);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Let end be min(max(pos, 0), len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var end = Math.min(Math.max(pos, 0), len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Let searchLength be the length of searchStr.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var searchLength = searchStr.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Let start be end - searchLength.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var start = end - searchLength;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 11. If start is less than 0, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (start &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 12. If the sequence of elements of S starting at start of length searchLength is the same as the full element sequence of searchStr, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (S.substr(start, searchLength) === searchStr) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span> }</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 13. Otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.includes</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsRegExp, RequireObjectCoercible, ToInteger, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.7. String.prototype.includes ( searchString [ , position ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'includes', function includes(searchString /* [ , position ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var position = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let isRegExp be ? IsRegExp(searchString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var isRegExp = IsRegExp(searchString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If isRegExp is true, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isRegExp) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('First argument to String.prototype.includes must not be a regular expression');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let searchStr be ? ToString(searchString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var searchStr = ToString(searchString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let pos be ? ToInteger(position). (If position is undefined, this step produces the value 0.)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var pos = ToInteger(position);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Let len be the length of S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = S.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Let start be min(max(pos, 0), len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var start = Math.min(Math.max(pos, 0), len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Let searchLen be the length of searchStr.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// var searchLength = searchStr.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. If there exists any integer k not smaller than start such that k + searchLen is not greater than len, and for all nonnegative integers j less than searchLen, the code unit at index k+j within S is the same as the code unit at index j within searchStr, return true; but if there is no such integer k, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return String.prototype.indexOf.call(S, searchStr, start) !== -1;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.padEnd</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, RequireObjectCoercible, ToLength, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.13. String.prototype.padEnd( maxLength [ , fillString ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'padEnd', function padEnd(maxLength /* [ , fillString ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var fillString = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let intMaxLength be ? ToLength(maxLength).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var intMaxLength = ToLength(maxLength);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let stringLength be the length of S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var stringLength = S.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If intMaxLength is not greater than stringLength, return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (intMaxLength &lt;= stringLength) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. If fillString is undefined, let filler be the String value consisting solely of the code unit 0x0020 (SPACE).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (fillString === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var filler = ' ';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Else, let filler be ? ToString(fillString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var filler = ToString(fillString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. If filler is the empty String, return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (filler === '') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Let fillLen be intMaxLength - stringLength.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var fillLen = intMaxLength - stringLength;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Let truncatedStringFiller be the String value consisting of repeated concatenations of filler truncated to length fillLen.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var truncatedStringFiller = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; fillLen; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>truncatedStringFiller += filler;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>truncatedStringFiller = truncatedStringFiller.substr(0, fillLen);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 11. Return the string-concatenation of S and truncatedStringFiller.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return S + truncatedStringFiller;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.padStart</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, RequireObjectCoercible, ToLength, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.14. String.prototype.padStart( maxLength [ , fillString ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'padStart', function padStart(maxLength /* [ , fillString ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var fillString = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let intMaxLength be ? ToLength(maxLength).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var intMaxLength = ToLength(maxLength);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Let stringLength be the length of S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var stringLength = S.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If intMaxLength is not greater than stringLength, return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (intMaxLength &lt;= stringLength) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. If fillString is undefined, let filler be the String value consisting solely of the code unit 0x0020 (SPACE).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (fillString === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var filler = ' ';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Else, let filler be ? ToString(fillString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var filler = ToString(fillString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. If filler is the empty String, return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (filler === '') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Let fillLen be intMaxLength - stringLength.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var fillLen = intMaxLength - stringLength;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. Let truncatedStringFiller be the String value consisting of repeated concatenations of filler truncated to length fillLen.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var truncatedStringFiller = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; fillLen; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>truncatedStringFiller += filler;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>truncatedStringFiller = truncatedStringFiller.substr(0, fillLen);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 11. Return the string-concatenation of truncatedStringFiller and S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return truncatedStringFiller + S;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.repeat</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, RequireObjectCoercible, ToInteger, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.15String.prototype.repeat ( count )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'repeat', function repeat(count) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let n be ? ToInteger(count).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var n = ToInteger(count);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If n &lt; 0, throw a RangeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (n &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new RangeError('Invalid count value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. If n is +∞, throw a RangeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (n === Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new RangeError('Invalid count value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let T be the String value that is made from n copies of S appended together. If n is 0, T is the empty String.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = n === 0 ? '' : new Array(n + 1).join(S);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Return T.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return T;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.startsWith</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, IsRegExp, RequireObjectCoercible, ToInteger, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.20. String.prototype.startsWith ( searchString [ , position ] )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'startsWith', function startsWith(searchString /* [ , position ] */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'use strict';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var position = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let isRegExp be ? IsRegExp(searchString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var isRegExp = IsRegExp(searchString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. If isRegExp is true, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (isRegExp) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('First argument to String.prototype.startsWith must not be a regular expression');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 5. Let searchStr be ? ToString(searchString).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var searchStr = ToString(searchString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 6. Let pos be ? ToInteger(position). (If position is undefined, this step produces the value 0.)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var pos = ToInteger(position);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 7. Let len be the length of S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = S.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 8. Let start be min(max(pos, 0), len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var start = Math.min(Math.max(pos, 0), len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 9. Let searchLength be the length of searchStr.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var searchLength = searchStr.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 10. If searchLength+start is greater than len, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (searchLength + start &gt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 11. If the sequence of elements of S starting at start of length searchLength is the same as the full element sequence of searchStr, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (S.substr(start).indexOf(searchString) === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 12. Otherwise, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.trim</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, RequireObjectCoercible, ToString */</span></p>
<p class="p1"><span class="s1">// 21.1.3.27. String.prototype.trim ( )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, 'trim', function trim() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Let T be the String value that is a copy of S with both leading and trailing white space removed. The definition of white space is the union of WhiteSpace and LineTerminator. When determining whether a Unicode code point is in Unicode general category “Space_Separator” (“Zs”), code unit sequences are interpreted as UTF-16 encoded code point sequences as specified in 6.1.4.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var T = String.prototype.replace.call(S, /^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+|[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/g, '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 4. Return T.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return T;</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol</span></p>
<p class="p1"><span class="s1">// A modification of https://github.com/WebReflection/get-own-property-symbols</span></p>
<p class="p1"><span class="s1">// (C) Andrea Giammarchi - MIT Licensed</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function (Object, GOPS, global) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var<span class="Apple-tab-span">	</span>setDescriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var id = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var random = '' + Math.random();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var prefix = '__\x01symbol:';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var prefixLength = prefix.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var internalSymbol = '__\x01symbol@@' + random;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var DP = 'defineProperty';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var DPies = 'defineProperties';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var GOPN = 'getOwnPropertyNames';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var GOPD = 'getOwnPropertyDescriptor';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var PIE = 'propertyIsEnumerable';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ObjectProto = Object.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var hOP = ObjectProto.hasOwnProperty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var pIE = ObjectProto[PIE];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var toString = ObjectProto.toString;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var concat = Array.prototype.concat;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var cachedWindowNames = typeof window === 'object' ? Object.getOwnPropertyNames(window) : [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var nGOPN = Object[GOPN];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var gOPN = function getOwnPropertyNames (obj) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (toString.call(obj) === '[object Window]') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return nGOPN(obj);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE bug where layout engine calls userland gOPN for cross-domain `window` objects</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return concat.call([], cachedWindowNames);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return nGOPN(obj);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var gOPD = Object[GOPD];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var create = Object.create;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var keys = Object.keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var freeze = Object.freeze || Object;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var defineProperty = Object[DP];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var $defineProperties = Object[DPies];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var descriptor = gOPD(Object, GOPN);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var addInternalIfNeeded = function (o, uid, enumerable) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!hOP.call(o, internalSymbol)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineProperty(o, internalSymbol, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>o[internalSymbol] = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>o[internalSymbol]['@@' + uid] = enumerable;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var createWithSymbols = function (proto, descriptors) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var self = create(proto);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>gOPN(descriptors).forEach(function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (propertyIsEnumerable.call(descriptors, key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$defineProperty(self, key, descriptors[key]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return self;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var copyAsNonEnumerable = function (descriptor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var newDescriptor = create(descriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>newDescriptor.enumerable = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return newDescriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var get = function get(){};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var onlyNonSymbols = function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return name != internalSymbol &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>!hOP.call(source, name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var onlySymbols = function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return name != internalSymbol &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>hOP.call(source, name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var propertyIsEnumerable = function propertyIsEnumerable(key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var uid = '' + key;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return onlySymbols(uid) ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>hOP.call(this, uid) &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this[internalSymbol]['@@' + uid]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>) : pIE.call(this, key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var setAndGetSymbol = function (uid) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var descriptor = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: get,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setDescriptor(this, uid, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: value</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>addInternalIfNeeded(this, uid, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineProperty(ObjectProto, uid, descriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ObjectProto[uid] = descriptor.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return freeze(source[uid] = defineProperty(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object(uid),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'constructor',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sourceConstructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var Symbol = function Symbol() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var description = arguments[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this instanceof Symbol) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Symbol is not a constructor');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return setAndGetSymbol(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>prefix.concat(description || '', random, ++id)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var source = create(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var sourceConstructor = {value: Symbol};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var sourceMap = function (uid) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return source[uid];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var $defineProperty = function defineProp(o, key, descriptor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var uid = '' + key;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (onlySymbols(uid)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setDescriptor(o, uid, descriptor.enumerable ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>copyAsNonEnumerable(descriptor) : descriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>addInternalIfNeeded(o, uid, !!descriptor.enumerable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineProperty(o, key, descriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var onlyInternalSymbols = function (obj) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return hOP.call(obj, internalSymbol) &amp;&amp; hOP.call(obj[internalSymbol], '@@' + name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var $getOwnPropertySymbols = function getOwnPropertySymbols(o) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return gOPN(o).filter(o === ObjectProto ? onlyInternalSymbols(o) : onlySymbols).map(sourceMap);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = $defineProperty;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Object, DP, descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = $getOwnPropertySymbols;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Object, GOPS, descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function getOwnPropertyNames(o) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return gOPN(o).filter(onlyNonSymbols);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Object, GOPN, descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function defineProperties(o, descriptors) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var symbols = $getOwnPropertySymbols(descriptors);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (symbols.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keys(descriptors).concat(symbols).forEach(function (uid) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (propertyIsEnumerable.call(descriptors, uid)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$defineProperty(o, uid, descriptors[uid]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>$defineProperties(o, descriptors);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Object, DPies, descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = propertyIsEnumerable;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(ObjectProto, PIE, descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = Symbol;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(global, 'Symbol', descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// defining `Symbol.for(key)`</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var uid = prefix.concat(prefix, key, random);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return uid in ObjectProto ? source[uid] : setAndGetSymbol(uid);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Symbol, 'for', descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// defining `Symbol.keyFor(symbol)`</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function (symbol) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (onlyNonSymbols(symbol))</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(symbol + ' is not a symbol');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return hOP.call(source, symbol) ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>symbol.slice(prefixLength * 2, -random.length) :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>void 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Symbol, 'keyFor', descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function getOwnPropertyDescriptor(o, key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var descriptor = gOPD(o, key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (descriptor &amp;&amp; onlySymbols(key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>descriptor.enumerable = propertyIsEnumerable.call(o, key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return descriptor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Object, GOPD, descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function (proto, descriptors) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return arguments.length === 1 || typeof descriptors === "undefined" ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>create(proto) :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>createWithSymbols(proto, descriptors);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(Object, 'create', descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>descriptor.value = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var str = toString.call(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return (str === '[object String]' &amp;&amp; onlySymbols(this)) ? '[object Symbol]' : str;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>defineProperty(ObjectProto, 'toString', descriptor);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>setDescriptor = function (o, key, descriptor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var protoDescriptor = gOPD(ObjectProto, key);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete ObjectProto[key];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineProperty(o, key, descriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (o !== ObjectProto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>defineProperty(ObjectProto, key, protoDescriptor);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(Object, 'getOwnPropertySymbols', this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.hasInstance</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'hasInstance', { value: Symbol('hasInstance') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.isConcatSpreadable</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'isConcatSpreadable', { value: Symbol('isConcatSpreadable') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.iterator</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'iterator', { value: Symbol('iterator') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.match</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'match', { value: Symbol('match') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.replace</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'replace', { value: Symbol('replace') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.search</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'search', { value: Symbol('search') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.species</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'species', { value: Symbol('species') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Map</span></p>
<p class="p1"><span class="s1">/* global CreateIterResultObject, CreateMethodProperty, GetIterator, IsCallable, IteratorClose, IteratorStep, IteratorValue, OrdinaryCreateFromConstructor, SameValueZero, Type, Symbol */</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var supportsGetters = (function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var a = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(a, 't', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return !!a.t;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Deleted map items mess with iterator pointers, so rather than removing them mark them as deleted. Can't use undefined or null since those both valid keys so use a private symbol.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var undefMarker = Symbol('undef');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.1.1 Map ( [ iterable ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var Map = function Map(/* iterable */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If NewTarget is undefined, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof Map)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Constructor Map requires "new"');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Let map be ? OrdinaryCreateFromConstructor(NewTarget, "%MapPrototype%", « [[MapData]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var map = OrdinaryCreateFromConstructor(this, Map.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_keys: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_values: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_size: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_es6Map: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Set map.[[MapData]] to a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - This step was done as part of step two.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Some old engines do not support ES5 getters/setters.<span class="Apple-converted-space">  </span>Since Map only requires these for the size property, we can fall back to setting the size property statically each time the size of the map changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(map, 'size', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If iterable is not present, let iterable be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iterable = arguments.length &gt; 0 ? arguments[0] : undefined;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If iterable is either undefined or null, return map.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (iterable === null || iterable === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let adder be ? Get(map, "set").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var adder = map.set;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. If IsCallable(adder) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!IsCallable(adder)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Map.prototype.set is not a function");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Let iteratorRecord be ? GetIterator(iterable).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iteratorRecord = GetIterator(iterable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Repeat,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let next be ? IteratorStep(iteratorRecord).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var next = IteratorStep(iteratorRecord);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If next is false, return map.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (next === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let nextItem be ? IteratorValue(next).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextItem = IteratorValue(next);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If Type(nextItem) is not Object, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(nextItem) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let error be Completion{[[Type]]: throw, [[Value]]: a newly created TypeError object, [[Target]]: empty}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Iterator value ' + nextItem + ' is not an entry object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Return ? IteratorClose(iteratorRecord, error).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - The try catch accounts for steps: f, h, and j.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Let k be Get(nextItem, "0").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = nextItem[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// f. If k is an abrupt completion, return ? IteratorClose(iteratorRecord, k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// g. Let v be Get(nextItem, "1").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var v = nextItem[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// h. If v is an abrupt completion, return ? IteratorClose(iteratorRecord, v).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let status be Call(adder, map, « k.[[Value]], v.[[Value]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>adder.call(map, k, v);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// j. If status is an abrupt completion, return ? IteratorClose(iteratorRecord, status).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - For user agents which do not have iteration methods on argument objects or arrays, we can special case those.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Array.isArray(iterable) ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.prototype.toString.call(iterable) === '[object Arguments]' ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE 7 &amp; IE 8 return '[object Object]' for the arguments object, we can detect by checking for the existence of the callee property</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(!!iterable.callee)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var length = iterable.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (index = 0; index &lt; length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>adder.call(map, iterable[index][0], iterable[index][1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.2.1. Map.prototype</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of Map.prototype is the intrinsic object %MapPrototype%.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(Map, 'prototype', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.2.2 get Map [ @@species ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(Map, Symbol.species, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Return the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateMethodProperty(Map, Symbol.species, Map);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.1 Map.prototype.clear ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'clear', function clear() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5.a. Set p.[[Key]] to empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._keys[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5.b. Set p.[[Value]] to empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._values[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._size = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.2. Map.prototype.constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'constructor', Map);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.3. Map.prototype.delete ( key )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'delete', function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValueZero(p.[[Key]], key) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValueZero(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Set p.[[Key]] to empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._keys[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Set p.[[Value]] to empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._values[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._size = --this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.4. Map.prototype.entries ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'entries', function entries () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return ? CreateMapIterator(M, "key+value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateMapIterator(M, 'key+value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.5. Map.prototype.forEach ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'forEach', function (callbackFn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.forEach called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.forEach called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!IsCallable(callbackFn)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(Object.prototype.toString.call(callbackFn) + ' is not a function.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arguments[1]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var T = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. For each Record {[[Key]], [[Value]]} e that is an element of entries, in original key insertion order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e.[[Key]] is not empty, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; M._values[i] !== undefMarker ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Perform ? Call(callbackfn, T, « e.[[Value]], e.[[Key]], M »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>callbackFn.call(T, M._values[i], M._keys[i], M);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.6. Map.prototype.get ( key )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'get', function get(key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.get called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.get called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValueZero(p.[[Key]], key) is true, return p.[[Value]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValueZero(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return M._values[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.7. Map.prototype.has ( key )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'has', function has (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof M !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.has called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.has called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValueZero(p.[[Key]], key) is true, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValueZero(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.8. Map.prototype.keys ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'keys', function keys () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return ? CreateMapIterator(M, "key").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateMapIterator(M, "key");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.9. Map.prototype.set ( key, value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'set', function set(key, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.set called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.set called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValueZero(p.[[Key]], key) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValueZero(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Set p.[[Value]] to value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._values[i] = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Return M.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return M;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. If key is -0, let key be +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (key === -0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>key = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Let p be the Record {[[Key]]: key, [[Value]]: value}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var p = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>p['[[Key]]'] = key;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>p['[[Value]]'] = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Append p as the last element of entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._keys.push(p['[[Key]]']);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._values.push(p['[[Value]]']);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>++M._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M.size = M._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Return M.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return M;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.10. get Map.prototype.size</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(Map.prototype, 'size', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.size called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Map.prototype.size called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Let count be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var count = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty, set count to count+1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>count = count + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return count.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return count;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.11. Map.prototype.values ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, 'values', function values () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return ? CreateMapIterator(M, "value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateMapIterator(M, 'value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.12. Map.prototype [ @@iterator ] ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@iterator property is the same function object as the initial value of the entries property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Map.prototype, Symbol.iterator, Map.prototype.entries);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.3.13. Map.prototype [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@toStringTag property is the String value "Map".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - Safari 8 implements Map.name but as a non-configurable property, which means it would throw an error if we try and configure it here.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!('name' in Map)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 19.2.4.2 name</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(Map, 'name', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 'Map'</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.5.1. CreateMapIterator ( map, kind )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function CreateMapIterator(map, kind) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If Type(map) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(map) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('createMapIterator called on incompatible receiver ' + Object.prototype.toString.call(map));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If map does not have a [[MapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (map._es6Map !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('createMapIterator called on incompatible receiver ' + Object.prototype.toString.call(map));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let iterator be ObjectCreate(%MapIteratorPrototype%, « [[Map]], [[MapNextIndex]], [[MapIterationKind]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iterator = Object.create(MapIteratorPrototype);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Set iterator.[[Map]] to map.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(iterator, '[[Map]]', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: map</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Set iterator.[[MapNextIndex]] to 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(iterator, '[[MapNextIndex]]', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Set iterator.[[MapIterationKind]] to kind.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(iterator, '[[MapIterationKind]]', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: kind</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return iterator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return iterator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.5.2. The %MapIteratorPrototype% Object</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var MapIteratorPrototype = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We use this as a quick way to check if an object is a Map Iterator instance.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(MapIteratorPrototype, 'isMapIterator', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.5.2.1. %MapIteratorPrototype%.next ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(MapIteratorPrototype, 'next', function next() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let O be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var O = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(O) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(O) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method %MapIteratorPrototype%.next called on incompatible receiver ' + Object.prototype.toString.call(O));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If O does not have all of the internal slots of a Map Iterator Instance (23.1.5.3), throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!O.isMapIterator) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method %MapIteratorPrototype%.next called on incompatible receiver ' + Object.prototype.toString.call(O));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let m be O.[[Map]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var m = O['[[Map]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Let index be O.[[MapNextIndex]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var index = O['[[MapNextIndex]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let itemKind be O.[[MapIterationKind]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var itemKind = O['[[MapIterationKind]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. If m is undefined, return CreateIterResultObject(undefined, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (m === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject(undefined, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Assert: m has a [[MapData]] internal slot.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!m._es6Map) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error(Object.prototype.toString.call(m) + ' has a [[MapData]] internal slot.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Let entries be the List that is m.[[MapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = m._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 10. Let numEntries be the number of elements of entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var numEntries = entries.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 11. NOTE: numEntries must be redetermined each time this method is evaluated.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 12. Repeat, while index is less than numEntries,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (index &lt; numEntries) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let e be the Record {[[Key]], [[Value]]} that is the value of entries[index].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = Object.create(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e['[[Key]]'] = m._keys[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e['[[Value]]'] = m._values[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Set index to index+1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = index + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Set O.[[MapNextIndex]] to index.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>O['[[MapNextIndex]]'] = index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If e.[[Key]] is not empty, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e['[[Key]]'] !== undefMarker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. If itemKind is "key", let result be e.[[Key]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (itemKind === 'key') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var result = e['[[Key]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Else if itemKind is "value", let result be e.[[Value]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (itemKind === 'value') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result = e['[[Value]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Assert: itemKind is "key+value".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (itemKind !== 'key+value') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Let result be CreateArrayFromList(« e.[[Key]], e.[[Value]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>result = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e['[[Key]]'],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e['[[Value]]']</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iv. Return CreateIterResultObject(result, false).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject(result, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 13. Set O.[[Map]] to undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>O['[[Map]]'] = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 14. Return CreateIterResultObject(undefined, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject(undefined, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.1.5.2.2 %MapIteratorPrototype% [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@toStringTag property is the String value "Map Iterator".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(MapIteratorPrototype, Symbol.iterator, function iterator() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Export the object</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateMethodProperty(global, 'Map', Map);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE8 throws an error here if we set enumerable to false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// More info on table 2: https://msdn.microsoft.com/en-us/library/dd229916(v=vs.85).aspx</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global['Map'] = Map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Set</span></p>
<p class="p1"><span class="s1">/* global CreateIterResultObject, CreateMethodProperty, GetIterator, IsCallable, IteratorClose, IteratorStep, IteratorValue, OrdinaryCreateFromConstructor, SameValueZero, Symbol */</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var supportsGetters = (function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var a = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(a, 't', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return !!a.t;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Deleted set items mess with iterator pointers, so rather than removing them mark them as deleted. Can't use undefined or null since those both valid keys so use a private symbol.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var undefMarker = Symbol('undef');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.1.1. Set ( [ iterable ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var Set = function Set(/* iterable */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If NewTarget is undefined, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof Set)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Constructor Set requires "new"');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Let set be ? OrdinaryCreateFromConstructor(NewTarget, "%SetPrototype%", « [[SetData]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var set = OrdinaryCreateFromConstructor(this, Set.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_values: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_size: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_es6Set: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Set set.[[SetData]] to a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - This step was done as part of step two.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Some old engines do not support ES5 getters/setters.<span class="Apple-converted-space">  </span>Since Set only requires these for the size property, we can fall back to setting the size property statically each time the size of the set changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(set, 'size', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If iterable is not present, let iterable be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iterable = arguments.length &gt; 0 ? arguments[0] : undefined;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If iterable is either undefined or null, return set.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (iterable === null || iterable === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let adder be ? Get(set, "add").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var adder = set.add;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. If IsCallable(adder) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!IsCallable(adder)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Set.prototype.add is not a function");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Let iteratorRecord be ? GetIterator(iterable).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iteratorRecord = GetIterator(iterable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Repeat,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let next be ? IteratorStep(iteratorRecord).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var next = IteratorStep(iteratorRecord);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If next is false, return set.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (next === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let nextValue be ? IteratorValue(next).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextValue = IteratorValue(next);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Let status be Call(adder, set, « nextValue.[[Value]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>adder.call(set, nextValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. If status is an abrupt completion, return ? IteratorClose(iteratorRecord, status).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - For user agents which do not have iteration methods on argument objects or arrays, we can special case those.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Array.isArray(iterable) ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.prototype.toString.call(iterable) === '[object Arguments]' ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE 7 &amp; IE 8 return '[object Object]' for the arguments object, we can detect by checking for the existence of the callee property</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(!!iterable.callee)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var length = iterable.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (index = 0; index &lt; length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>adder.call(set, iterable[index]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw (e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.2.1. Set.prototype</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of Set.prototype is the intrinsic %SetPrototype% object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(Set, 'prototype', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.2.2 get Set [ @@species ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(Set, Symbol.species, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Return the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateMethodProperty(Set, Symbol.species, Set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.1. Set.prototype.add ( value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'add', function add(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof S !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.add called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.add called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is S.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty and SameValueZero(e, value) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker &amp;&amp; SameValueZero(e, value)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. If value is -0, let value be +0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (1/value === -Infinity) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Append value as the last element of entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>S._values.push(value);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._size = ++this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.2. Set.prototype.clear ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'clear', function clear() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof S !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is S.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Replace the element of entries whose value is e with an element whose value is empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>entries[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._size = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.3. Set.prototype.constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'constructor', Set);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.4. Set.prototype.delete ( value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'delete', function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof S !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.delete called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.delete called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is S.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty and SameValueZero(e, value) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker &amp;&amp; SameValueZero(e, value)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Replace the element of entries whose value is e with an element whose value is empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>entries[i] = undefMarker;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._size = --this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.5. Set.prototype.entries ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'entries', function entries() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return ? CreateSetIterator(S, "key+value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateSetIterator(S, 'key+value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.6. Set.prototype.forEach ( callbackfn [ , thisArg ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'forEach', function forEach(callbackFn /*[ , thisArg ]*/) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof S !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.forEach called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.forEach called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If IsCallable(callbackfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!IsCallable(callbackFn)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(Object.prototype.toString.call(callbackFn) + ' is not a function.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (arguments[1]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var T = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let entries be the List that is S.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. For each e that is an element of entries, in original insertion order, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Perform ? Call(callbackfn, T, « e, e, S »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>callbackFn.call(T, e, e, S);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.7. Set.prototype.has ( value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'has', function has(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof S !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.forEach called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.forEach called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is S.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty and SameValueZero(e, value) is true, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker &amp;&amp; SameValueZero(e, value)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - We need to define Set.prototype.values before Set.prototype.keys because keys is a reference to values.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.10. Set.prototype.values()</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var values = function values() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return ? CreateSetIterator(S, "value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateSetIterator(S, "value");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'values', values);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.8 Set.prototype.keys ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the keys property is the same function object as the initial value of the values property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, 'keys', values);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.9. get Set.prototype.size</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (supportsGetters) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(Set.prototype, 'size', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof S !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.size called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method Set.prototype.size called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is S.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Let count be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var count = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty, set count to count+1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>count = count + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return count.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return count;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>set: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.11. Set.prototype [ @@iterator ] ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@iterator property is the same function object as the initial value of the values property.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Set.prototype, Symbol.iterator, values);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.3.12. Set.prototype [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@toStringTag property is the String value "Set".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - Safari 8 implements Set.name but as a non-configurable property, which means it would throw an error if we try and configure it here.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!('name' in Set)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 19.2.4.2 name</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(Set, 'name', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 'Set'</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.5.1. CreateSetIterator ( set, kind )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function CreateSetIterator(set, kind) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If Type(set) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof set !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('createSetIterator called on incompatible receiver ' + Object.prototype.toString.call(set));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If set does not have a [[SetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (set._es6Set !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('createSetIterator called on incompatible receiver ' + Object.prototype.toString.call(set));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let iterator be ObjectCreate(%SetIteratorPrototype%, « [[IteratedSet]], [[SetNextIndex]], [[SetIterationKind]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iterator = Object.create(SetIteratorPrototype);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Set iterator.[[IteratedSet]] to set.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(iterator, '[[IteratedSet]]', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: set</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Set iterator.[[SetNextIndex]] to 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(iterator, '[[SetNextIndex]]', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Set iterator.[[SetIterationKind]] to kind.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(iterator, '[[SetIterationKind]]', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: kind</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return iterator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return iterator;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.5.2. The %SetIteratorPrototype% Object</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var SetIteratorPrototype = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>//Polyfill.io - We add this property to help us identify what is a set iterator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(SetIteratorPrototype, 'isSetIterator', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.5.2.1. %SetIteratorPrototype%.next ( )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(SetIteratorPrototype, 'next', function next() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let O be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var O = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(O) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof O !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method %SetIteratorPrototype%.next called on incompatible receiver ' + Object.prototype.toString.call(O));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If O does not have all of the internal slots of a Set Iterator Instance (23.2.5.3), throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!O.isSetIterator) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method %SetIteratorPrototype%.next called on incompatible receiver ' + Object.prototype.toString.call(O));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let s be O.[[IteratedSet]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var s = O['[[IteratedSet]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Let index be O.[[SetNextIndex]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var index = O['[[SetNextIndex]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let itemKind be O.[[SetIterationKind]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var itemKind = O['[[SetIterationKind]]'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. If s is undefined, return CreateIterResultObject(undefined, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (s === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject(undefined, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Assert: s has a [[SetData]] internal slot.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!s._es6Set) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error(Object.prototype.toString.call(s) + ' does not have [[SetData]] internal slot.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Let entries be the List that is s.[[SetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = s._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 10. Let numEntries be the number of elements of entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var numEntries = entries.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 11. NOTE: numEntries must be redetermined each time this method is evaluated.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 12. Repeat, while index is less than numEntries,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (index &lt; numEntries) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let e be entries[index].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Set index to index+1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = index + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Set O.[[SetNextIndex]] to index.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>O['[[SetNextIndex]]'] = index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If e is not empty, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. If itemKind is "key+value", then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (itemKind === 'key+value') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Return CreateIterResultObject(CreateArrayFromList(« e, e »), false).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject([e, e], false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Return CreateIterResultObject(e, false).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject(e, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 13. Set O.[[IteratedSet]] to undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>O['[[IteratedSet]]'] = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 14. Return CreateIterResultObject(undefined, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return CreateIterResultObject(undefined, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.2.5.2.2. %SetIteratorPrototype% [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@toStringTag property is the String value "Set Iterator".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(SetIteratorPrototype, Symbol.iterator, function iterator() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Export the object</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateMethodProperty(global, 'Set', Set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE8 throws an error here if we set enumerable to false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// More info on table 2: https://msdn.microsoft.com/en-us/library/dd229916(v=vs.85).aspx</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global['Set'] = Set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.from</span></p>
<p class="p1"><span class="s1">/* globals</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>IsCallable, GetMethod, Symbol, IsConstructor, Construct, ArrayCreate, GetIterator, IteratorClose,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>ToString, IteratorStep, IteratorValue, Call, CreateDataPropertyOrThrow, ToObject, ToLength, Get, CreateMethodProperty</span></p>
<p class="p1"><span class="s1">*/</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var toString = Object.prototype.toString;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var stringMatch = String.prototype.match;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// A cross-realm friendly way to detect if a value is a String object or literal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function isString(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof value === 'string') { return true; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof value !== 'object') { return false; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return toString.call(value) === '[object String]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 22.1.2.1. Array.from ( items [ , mapfn [ , thisArg ] ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Array, 'from', function from(items /* [ , mapfn [ , thisArg ] ] */) { // eslint-disable-line no-undef</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let C be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var C = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If mapfn is undefined, let mapping be false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var mapfn = arguments.length &gt; 1 ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (mapfn === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var mapping = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If IsCallable(mapfn) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsCallable(mapfn) === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError(Object.prototype.toString.call(mapfn) + ' is not a function.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If thisArg is present, let T be thisArg; else let T be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var thisArg = arguments.length &gt; 2 ? arguments[2] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (thisArg !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var T = thisArg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>T = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let mapping be true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mapping = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let usingIterator be ? GetMethod(items, @@iterator).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var usingIterator = GetMethod(items, Symbol.iterator);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If usingIterator is not undefined, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (usingIterator !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If IsConstructor(C) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsConstructor(C)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let A be ? Construct(C).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var A = Construct(C);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let A be ! ArrayCreate(0).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A = ArrayCreate(0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let iteratorRecord be ? GetIterator(items, usingIterator).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iteratorRecord = GetIterator(items, usingIterator);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Repeat,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. If k ≥ 2^53-1, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (k &gt;= (Math.pow(2, 53) - 1)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let error be Completion{[[Type]]: throw, [[Value]]: a newly created TypeError object, [[Target]]: empty}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var error = new TypeError('Iteration count can not be greater than or equal 9007199254740991.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return ? IteratorClose(iteratorRecord, error).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Let next be ? IteratorStep(iteratorRecord).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var next = IteratorStep(iteratorRecord);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iv. If next is false, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (next === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Perform ? Set(A, "length", k, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A["length"] = k;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return A;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// v. Let nextValue be ? IteratorValue(next).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextValue = IteratorValue(next);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// vi. If mapping is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (mapping) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - The try catch accounts for step 2.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let mappedValue be Call(mapfn, T, « nextValue, k »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var mappedValue = Call(mapfn, T, [nextValue, k]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If mappedValue is an abrupt completion, return ? IteratorClose(iteratorRecord, mappedValue).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Let mappedValue be mappedValue.[[Value]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// vii. Else, let mappedValue be nextValue.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mappedValue = nextValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - The try catch accounts for step ix.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// viii. Let defineStatus be CreateDataPropertyOrThrow(A, Pk, mappedValue).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateDataPropertyOrThrow(A, Pk, mappedValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ix. If defineStatus is an abrupt completion, return ? IteratorClose(iteratorRecord, defineStatus).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// x. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. NOTE: items is not an Iterable so assume it is an array-like object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Let arrayLike be ! ToObject(items).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - For Strings we need to split astral symbols into surrogate pairs.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (isString(items)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var arrayLike = stringMatch.call(items, /[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g) || [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>arrayLike = ToObject(items);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Let len be ? ToLength(? Get(arrayLike, "length")).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var len = ToLength(Get(arrayLike, "length"));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. If IsConstructor(C) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsConstructor(C)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let A be ? Construct(C, « len »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A = Construct(C, [len]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 10. Else,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let A be ? ArrayCreate(len).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A = ArrayCreate(len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 11. Let k be 0.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 12. Repeat, while k &lt; len</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (k &lt; len) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let Pk be ! ToString(k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Pk = ToString(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. Let kValue be ? Get(arrayLike, Pk).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var kValue = Get(arrayLike, Pk);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. If mapping is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (mapping === true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let mappedValue be ? Call(mapfn, T, « kValue, k »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mappedValue = Call(mapfn, T, [kValue, k]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Else, let mappedValue be kValue.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mappedValue = kValue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Perform ? CreateDataPropertyOrThrow(A, Pk, mappedValue).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateDataPropertyOrThrow(A, Pk, mappedValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// f. Increase k by 1.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>k = k + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 13. Perform ? Set(A, "length", len, true).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A["length"] = len;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 14. Return A.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return A;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.split</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'split', { value: Symbol('split') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.toPrimitive</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'toPrimitive', { value: Symbol('toPrimitive') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.toStringTag</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'toStringTag', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>value: Symbol('toStringTag')</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _Iterator</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">// A modification of https://github.com/medikoo/es6-iterator</span></p>
<p class="p1"><span class="s1">// Copyright (C) 2013-2015 Mariusz Nowak (www.medikoo.com)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">var Iterator = (function () { // eslint-disable-line no-unused-vars</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var clear = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.length = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var callable = function (fn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof fn !== 'function') throw new TypeError(fn + " is not a function");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return fn;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var Iterator = function (list, context) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof Iterator)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new Iterator(list, context);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperties(this, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>__list__: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: list</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>__context__: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: context</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>__nextIndex__: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!context) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>callable(context.on);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>context.on('_add', this._onAdd.bind(this));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>context.on('_delete', this._onDelete.bind(this));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>context.on('_clear', this._onClear.bind(this));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperties(Iterator.prototype, Object.assign({</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>constructor: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: Iterator,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_next: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!this.__list__) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__redo__) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i = this.__redo__.shift();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (i !== undefined) return i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__nextIndex__ &lt; this.__list__.length) return this.__nextIndex__++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._unBind();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>next: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this._createResult(this._next());</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_createResult: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function (i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (i === undefined) return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>done: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: undefined</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>done: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: this._resolve(i)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_resolve: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function (i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this.__list__[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_unBind: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__list__ = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete this.__redo__;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!this.__context__) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__context__.off('_add', this._onAdd.bind(this));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__context__.off('_delete', this._onDelete.bind(this));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__context__.off('_clear', this._onClear.bind(this));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__context__ = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>toString: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return '[object Iterator]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_onAdd: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function (index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (index &gt;= this.__nextIndex__) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>++this.__nextIndex__;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!this.__redo__) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(this, '__redo__', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: [index],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__redo__.forEach(function (redo, i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (redo &gt;= index) this.__redo__[i] = ++redo;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__redo__.push(index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_onDelete: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function (index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (index &gt;= this.__nextIndex__) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>--this.__nextIndex__;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!this.__redo__) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i = this.__redo__.indexOf(index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (i !== -1) this.__redo__.splice(i, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__redo__.forEach(function (redo, i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (redo &gt; index) this.__redo__[i] = --redo;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_onClear: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__redo__) clear.call(this.__redo__);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.__nextIndex__ = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(Iterator.prototype, Symbol.iterator, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(Iterator.prototype, Symbol.toStringTag, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 'Iterator',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return Iterator;</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _ArrayIterator</span></p>
<p class="p1"><span class="s1">/* global Iterator */</span></p>
<p class="p1"><span class="s1">// A modification of https://github.com/medikoo/es6-iterator</span></p>
<p class="p1"><span class="s1">// Copyright (C) 2013-2015 Mariusz Nowak (www.medikoo.com)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">var ArrayIterator = (function() { // eslint-disable-line no-unused-vars</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ArrayIterator = function(arr, kind) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof ArrayIterator)) return new ArrayIterator(arr, kind);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Iterator.call(this, arr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!kind) kind = 'value';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else if (String.prototype.includes.call(kind, 'key+value')) kind = 'key+value';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else if (String.prototype.includes.call(kind, 'key')) kind = 'key';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>else kind = 'value';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(this, '__kind__', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: kind,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Object.setPrototypeOf) Object.setPrototypeOf(ArrayIterator, Iterator.prototype);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>ArrayIterator.prototype = Object.create(Iterator.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>constructor: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: ArrayIterator,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_resolve: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function(i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__kind__ === 'value') return this.__list__[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__kind__ === 'key+value') return [i, this.__list__[i]];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>toString: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return '[object Array Iterator]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return ArrayIterator;</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.entries</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject */</span></p>
<p class="p1"><span class="s1">// 22.1.3.4. Array.prototype.entries ( )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'entries', function entries() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Return CreateArrayIterator(O, "key+value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// TODO: Add CreateArrayIterator</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return new ArrayIterator(O, 'key+value');</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.keys</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, ToObject */</span></p>
<p class="p1"><span class="s1">// 22.1.3.14. Array.prototype.keys ( )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, 'keys', function keys() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Return CreateArrayIterator(O, "key").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// TODO: Add CreateArrayIterator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return new ArrayIterator(O, 'key');</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.values</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Symbol, ToObject */</span></p>
<p class="p1"><span class="s1">// 22.1.3.30/ Array.prototype.values ( )</span></p>
<p class="p1"><span class="s1">// Polyfill.io - Firefox, Chrome and Opera have Array.prototype[Symbol.iterator], which is the exact same function as Array.prototype.values.</span></p>
<p class="p1"><span class="s1">if ('Symbol' in this &amp;&amp; 'iterator' in Symbol &amp;&amp; typeof Array.prototype[Symbol.iterator] === 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Array.prototype, 'values', Array.prototype[Symbol.iterator]);</span></p>
<p class="p1"><span class="s1">} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(Array.prototype, 'values', function values () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let O be ? ToObject(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var O = ToObject(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Return CreateArrayIterator(O, "value").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// TODO: Add CreateArrayIterator</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new ArrayIterator(O, 'value');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Array.prototype.@@iterator</span></p>
<p class="p1"><span class="s1">/* global Symbol, CreateMethodProperty */</span></p>
<p class="p1"><span class="s1">// 22.1.3.31. Array.prototype [ @@iterator ] ( )</span></p>
<p class="p1"><span class="s1">// The initial value of the @@iterator property is the same function object as the initial value of the<span class="Apple-converted-space">  </span>Array.prototype.values property.</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(Array.prototype, Symbol.iterator, Array.prototype.values);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// DOMTokenList.prototype.@@iterator</span></p>
<p class="p1"><span class="s1">/* global Symbol, ArrayIterator*/</span></p>
<p class="p1"><span class="s1">DOMTokenList.prototype[Symbol.iterator] = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return new ArrayIterator(this);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// NodeList.prototype.@@iterator</span></p>
<p class="p1"><span class="s1">/* global Symbol, ArrayIterator*/</span></p>
<p class="p1"><span class="s1">NodeList.prototype[Symbol.iterator] = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return new ArrayIterator(this);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// _StringIterator</span></p>
<p class="p1"><span class="s1">// A modification of https://github.com/medikoo/es6-iterator</span></p>
<p class="p1"><span class="s1">// Copyright (C) 2013-2015 Mariusz Nowak (www.medikoo.com)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* global Iterator */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">var StringIterator = (function() { // eslint-disable-line no-unused-vars</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var StringIterator = function (str) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof StringIterator)) return new StringIterator(str);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>str = String(str);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Iterator.call(this, str);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(this, '__length__', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: str.length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (Object.setPrototypeOf) Object.setPrototypeOf(StringIterator, Iterator);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>StringIterator.prototype = Object.create(Iterator.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>constructor: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: StringIterator,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_next: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!this.__list__) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__nextIndex__ &lt; this.__length__) return this.__nextIndex__++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._unBind();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_resolve: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function (i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var char = this.__list__[i], code;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (this.__nextIndex__ === this.__length__) return char;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>code = char.charCodeAt(0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ((code &gt;= 0xD800) &amp;&amp; (code &lt;= 0xDBFF)) return char + this.__list__[this.__nextIndex__++];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return char;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>toString: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return '[object String Iterator]';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return StringIterator;</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// String.prototype.@@iterator</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, RequireObjectCoercible, ToString, StringIterator, Symbol */</span></p>
<p class="p1"><span class="s1">// 21.1.3.29. String.prototype [ @@iterator ] ( )</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(String.prototype, Symbol.iterator, function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 1. Let O be ? RequireObjectCoercible(this value).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var O = RequireObjectCoercible(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 2. Let S be ? ToString(O).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var S = ToString(O);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 3. Return CreateStringIterator(S).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// TODO: Add CreateStringIterator.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return new StringIterator(S);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Symbol.unscopables</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">Object.defineProperty(Symbol, 'unscopables', { value: Symbol('unscopables') });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// URL</span></p>
<p class="p1"><span class="s1">/* global Symbol */</span></p>
<p class="p1"><span class="s1">// URL Polyfill</span></p>
<p class="p1"><span class="s1">// Draft specification: https://url.spec.whatwg.org</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Notes:</span></p>
<p class="p1"><span class="s1">// - Primarily useful for parsing URLs and modifying query parameters</span></p>
<p class="p1"><span class="s1">// - Should work in IE8+ and everything more modern, with es5.js polyfills</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>'use strict';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function isSequence(o) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!o) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if ('Symbol' in global &amp;&amp; 'iterator' in global.Symbol &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>typeof o[Symbol.iterator] === 'function') return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (Array.isArray(o)) return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function toArray(iter) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return ('from' in Array) ? Array.from(iter) : Array.prototype.slice.call(iter);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>(function() {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Browsers may have:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// * No global URL object</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// * URL with static methods only - may have a dummy constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// * URL with members except searchParams</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// * Full URL API support</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var origURL = global.URL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var nativeURL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (origURL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>nativeURL = new global.URL('http://example.com');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if ('searchParams' in nativeURL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var url = new URL('http://example.com');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>url.search = 'a=1&amp;b=2';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (url.href === 'http://example.com/?a=1&amp;b=2') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>url.search = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (url.href === 'http://example.com/') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!('href' in nativeURL)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nativeURL = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nativeURL = undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} catch (_) {}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// NOTE: Doesn't do the encoding/decoding dance</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function urlencoded_serialize(pairs) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var output = '', first = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>pairs.forEach(function (pair) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var name = encodeURIComponent(pair.name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var value = encodeURIComponent(pair.value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!first) output += '&amp;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>output += name + '=' + value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>first = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return output.replace(/%20/g, '+');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// NOTE: Doesn't do the encoding/decoding dance</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function urlencoded_parse(input, isindex) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var sequences = input.split('&amp;');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (isindex &amp;&amp; sequences[0].indexOf('=') === -1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>sequences[0] = '=' + sequences[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var pairs = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>sequences.forEach(function (bytes) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (bytes.length === 0) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var index = bytes.indexOf('=');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (index !== -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var name = bytes.substring(0, index);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var value = bytes.substring(index + 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>name = bytes;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>name = name.replace(/\+/g, ' ');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value = value.replace(/\+/g, ' ');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>pairs.push({ name: name, value: value });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var output = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>pairs.forEach(function (pair) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>output.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>name: decodeURIComponent(pair.name),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>value: decodeURIComponent(pair.value)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return output;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function URLUtils(url) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (nativeURL)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return new origURL(url);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var anchor = document.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>anchor.href = url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return anchor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function URLSearchParams(init) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var $this = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._list = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (init === undefined || init === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// no-op</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (init instanceof URLSearchParams) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// In ES6 init would be a sequence, but special case for ES5.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._list = urlencoded_parse(String(init));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (typeof init === 'object' &amp;&amp; isSequence(init)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>toArray(init).forEach(function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (!isSequence(e)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var nv = toArray(e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (nv.length !== 2) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>$this._list.push({name: String(nv[0]), value: String(nv[1])});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (typeof init === 'object' &amp;&amp; init) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Object.keys(init).forEach(function(key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>$this._list.push({name: String(key), value: String(init[key])});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>init = String(init);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (init.substring(0, 1) === '?')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>init = init.substring(1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._list = urlencoded_parse(init);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._url_object = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._setList = function (list) { if (!updating) $this._list = list; };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var updating = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._update_steps = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (updating) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>updating = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!$this._url_object) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Partial workaround for IE issue with 'about:'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if ($this._url_object.protocol === 'about:' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>$this._url_object.pathname.indexOf('?') !== -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>$this._url_object.pathname = $this._url_object.pathname.split('?')[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>$this._url_object.search = urlencoded_serialize($this._list);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>updating = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.defineProperties(URLSearchParams.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>append: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function (name, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._list.push({ name: name, value: value });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._update_steps();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'delete': {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this._list.length;) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this._list[i].name === name)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>this._list.splice(i, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>else</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>++i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._update_steps();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>get: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this._list.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this._list[i].name === name)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return this._list[i].value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>getAll: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var result = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this._list.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this._list[i].name === name)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>result.push(this._list[i].value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>has: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function (name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this._list.length; ++i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this._list[i].name === name)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>set: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function (name, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var found = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>for (var i = 0; i &lt; this._list.length;) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (this._list[i].name === name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (!found) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this._list[i].value = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>found = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>++i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this._list.splice(i, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>++i;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (!found)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>this._list.push({ name: name, value: value });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._update_steps();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>entries: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function() { return new Iterator(this._list, 'key+value'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>keys: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function() { return new Iterator(this._list, 'key'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>values: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function() { return new Iterator(this._list, 'value'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>forEach: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function(callback) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var thisArg = (arguments.length &gt; 1) ? arguments[1] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._list.forEach(function(pair) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>callback.call(thisArg, pair.value, pair.name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>},</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>toString: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return urlencoded_serialize(this._list);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}, writable: true, enumerable: false, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function Iterator(source, kind) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var index = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this['next'] = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (index &gt;= source.length)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return {done: true, value: undefined};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var pair = source[index++];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return {done: false, value:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>kind === 'key' ? pair.name :</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>kind === 'value' ? pair.value :</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>[pair.name, pair.value]};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if ('Symbol' in global &amp;&amp; 'iterator' in global.Symbol) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(URLSearchParams.prototype, global.Symbol.iterator, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: URLSearchParams.prototype.entries,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>writable: true, enumerable: true, configurable: true});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperty(Iterator.prototype, global.Symbol.iterator, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>value: function() { return this; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>writable: true, enumerable: true, configurable: true});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function URL(url, base) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!(this instanceof global.URL))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>throw new TypeError("Failed to construct 'URL': Please use the 'new' operator.");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (base) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>url = (function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (nativeURL) return new origURL(url, base).href;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var iframe;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var doc;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Use another document/base tag/anchor for relative URL resolution, if possible</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (Object.prototype.toString.call(window.operamini) === "[object OperaMini]") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>iframe = document.createElement('iframe');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>iframe.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>document.documentElement.appendChild(iframe);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc = iframe.contentWindow.document;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (document.implementation &amp;&amp; document.implementation.createHTMLDocument) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc = document.implementation.createHTMLDocument('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (document.implementation &amp;&amp; document.implementation.createDocument) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc = document.implementation.createDocument('http://www.w3.org/1999/xhtml', 'html', null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc.documentElement.appendChild(doc.createElement('head'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc.documentElement.appendChild(doc.createElement('body'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (window.ActiveXObject) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc = new window.ActiveXObject('htmlfile');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc.write('&lt;head&gt;&lt;\/head&gt;&lt;body&gt;&lt;\/body&gt;');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>doc.close();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!doc) throw Error('base not supported');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var baseTag = doc.createElement('base');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>baseTag.href = base;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>doc.getElementsByTagName('head')[0].appendChild(baseTag);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var anchor = doc.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>anchor.href = url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return anchor.href;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (iframe)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>iframe.parentNode.removeChild(iframe);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// An inner object implementing URLUtils (either a native URL</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// object or an HTMLAnchorElement instance) is used to perform the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// URL algorithms. With full ES5 getter/setter support, return a</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// regular object For IE8's limited getter/setter support, a</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// different HTMLAnchorElement is returned with properties</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// overridden</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var instance = URLUtils(url || '');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Detect for ES5 getter/setter support</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// (an Object.defineProperties polyfill that doesn't support getters/setters may throw)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var ES5_GET_SET = (function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!('defineProperties' in Object)) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var obj = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Object.defineProperties(obj, { prop: { 'get': function () { return true; } } });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return obj.prop;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} catch (_) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var self = ES5_GET_SET ? this : document.createElement('a');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>var query_object = new URLSearchParams(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>instance.search ? instance.search.substring(1) : null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>query_object._url_object = self;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>Object.defineProperties(self, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>href: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.href; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.href = v; tidy_instance(); update_steps(); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>origin: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if ('origin' in instance) return instance.origin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return this.protocol + '//' + this.host;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>protocol: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.protocol; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.protocol = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>username: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.username; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.username = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>password: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.password; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.password = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>host: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// IE returns default port in |host|</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var re = {'http:': /:80$/, 'https:': /:443$/, 'ftp:': /:21$/}[instance.protocol];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return re ? instance.host.replace(re, '') : instance.host;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.host = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>hostname: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.hostname; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.hostname = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>port: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.port; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.port = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>pathname: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// IE does not include leading '/' in |pathname|</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (instance.pathname.charAt(0) !== '/') return '/' + instance.pathname;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return instance.pathname;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.pathname = v; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>search: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.search; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (instance.search === v) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>instance.search = v; tidy_instance(); update_steps();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>searchParams: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return query_object; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>hash: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>get: function () { return instance.hash; },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>set: function (v) { instance.hash = v; tidy_instance(); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: true, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>toString: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>value: function() { return instance.toString(); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: false, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>valueOf: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>value: function() { return instance.valueOf(); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>enumerable: false, configurable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>function tidy_instance() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var href = instance.href.replace(/#$|\?$|\?(?=#)/g, '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (instance.href !== href)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>instance.href = href;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>function update_steps() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>query_object._setList(instance.search ? urlencoded_parse(instance.search.substring(1)) : []);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>query_object._update_steps();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return self;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (origURL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>for (var i in origURL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (origURL.hasOwnProperty(i) &amp;&amp; typeof origURL[i] === 'function')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>URL[i] = origURL[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.URL = URL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.URLSearchParams = URLSearchParams;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Patch native URLSearchParams constructor to handle sequences/records</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// if necessary.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>(function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (new global.URLSearchParams([['a', 1]]).get('a') === '1' &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>new global.URLSearchParams({a: 1}).get('a') === '1')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var orig = global.URLSearchParams;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>global.URLSearchParams = function(init) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (init &amp;&amp; typeof init === 'object' &amp;&amp; isSequence(init)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var o = new orig();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>toArray(init).forEach(function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (!isSequence(e)) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>var nv = toArray(e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (nv.length !== 2) throw TypeError();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>o.append(nv[0], nv[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else if (init &amp;&amp; typeof init === 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o = new orig();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Object.keys(init).forEach(function(key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>o.set(key, init[key]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return o;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return new orig(init);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(self));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Blob</span></p>
<p class="p1"><span class="s1">// Local modification of https://github.com/eligrey/Blob.js/blob</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* Blob.js</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* A Blob implementation.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* 2014-07-24</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* By Eli Grey, http://eligrey.com</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* By Devin Samarin, https://github.com/dsamarin</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* License: MIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">  </span>See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/*global self, unescape */</span></p>
<p class="p1"><span class="s1">/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>plusplus: true */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function (view) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>"use strict";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>view.URL = view.URL || view.webkitURL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var ArrayBuffer = view.ArrayBuffer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var Uint8Array = view.Uint8Array;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var get_class = function (object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return Object.prototype.toString.call(object).match(/^\[object\s(.*)\]$/)[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var FakeBlob;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Internally we use a BlobBuilder implementation to base Blob off of</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// in order to support older browsers that only have BlobBuilder</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var BlobBuilder = view.BlobBuilder || view.WebKitBlobBuilder || view.MozBlobBuilder || (function (view) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var FakeBlobBuilder = function BlobBuilder() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.data = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FakeBlob = function Blob(data, type, encoding) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.data = data;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = data.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.type = type;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.encoding = encoding;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var FBB_proto = FakeBlobBuilder.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var FB_proto = FakeBlob.prototype;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var FileReaderSync = view.FileReaderSync;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var FileException = function (type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.code = this[this.name = type];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var file_ex_codes = (</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>"NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR " +</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>"NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR"</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>).split(" ");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var file_ex_code = file_ex_codes.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var real_URL = view.URL || view.webkitURL || view;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var real_create_object_URL = real_URL.createObjectURL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var real_revoke_object_URL = real_URL.revokeObjectURL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var URL = real_URL;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var btoa = view.btoa;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var atob = view.atob;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var origin = /^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FakeBlob.fake = FB_proto.fake = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (file_ex_code--) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FileException.prototype[file_ex_codes[file_ex_code]] = file_ex_code + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill URL</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!real_URL.createObjectURL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>URL = view.URL = function (uri) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>uri_info = document.createElementNS("http://www.w3.org/1999/xhtml", "a"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>uri_origin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>uri_info.href = uri;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!("origin" in uri_info)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (uri_info.protocol.toLowerCase() === "data:") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>uri_info.origin = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>uri_origin = uri.match(origin);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>uri_info.origin = uri_origin &amp;&amp; uri_origin[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return uri_info;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>URL.createObjectURL = function (blob) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>type = blob.type,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>data_URI_header;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (type === null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>type = "application/octet-stream";</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (blob instanceof FakeBlob) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>data_URI_header = "data:" + type;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (blob.encoding === "base64") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return data_URI_header + ";base64," + blob.data;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (blob.encoding === "URI") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return data_URI_header + "," + decodeURIComponent(blob.data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (btoa) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return data_URI_header + ";base64," + btoa(blob.data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return data_URI_header + "," + encodeURIComponent(blob.data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (real_create_object_URL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return real_create_object_URL.call(real_URL, blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>URL.revokeObjectURL = function (object_URL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (object_URL.substring(0, 5) !== "data:" &amp;&amp; real_revoke_object_URL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>real_revoke_object_URL.call(real_URL, object_URL);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FBB_proto.append = function (data /*, endings*/ ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var bb = this.data;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// decode data to a binary string</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Uint8Array &amp;&amp; (data instanceof ArrayBuffer || data instanceof Uint8Array)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>str = "",</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>buf = new Uint8Array(data),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i = 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>buf_len = buf.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (; i &lt; buf_len; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>str += String.fromCharCode(buf[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bb.push(str);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (get_class(data) === "Blob" || get_class(data) === "File") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (FileReaderSync) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var fr = new FileReaderSync;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bb.push(fr.readAsBinaryString(data));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// async FileReader won't work as BlobBuilder is sync</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new FileException("NOT_READABLE_ERR");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (data instanceof FakeBlob) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (data.encoding === "base64" &amp;&amp; atob) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bb.push(atob(data.data));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (data.encoding === "URI") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bb.push(decodeURIComponent(data.data));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (data.encoding === "raw") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bb.push(data.data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof data !== "string") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>data += ""; // convert unsupported types to strings</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// decode UTF-16 to binary string</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bb.push(unescape(encodeURIComponent(data)));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FBB_proto.getBlob = function (type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!arguments.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>type = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new FakeBlob(this.data.join(""), type, "raw");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FBB_proto.toString = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return "[object BlobBuilder]";</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FB_proto.slice = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var start = arguments[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var end = arguments[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var type = arguments[2];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var args = arguments.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (args &lt; 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>type = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new FakeBlob(</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.data.slice(start, args &gt; 1 ? end : this.data.length), type, this.encoding</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FB_proto.toString = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return "[object Blob]";</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>FB_proto.close = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.size = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete this.data;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return FakeBlobBuilder;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}(view));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>(function(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var builder = new BlobBuilder();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>builder.append(1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (err) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nativeAppend = BlobBuilder.prototype.append;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>BlobBuilder.prototype.append = function append(data /*, endings*/ ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(Uint8Array &amp;&amp; (data instanceof ArrayBuffer || data instanceof Uint8Array)) &amp;&amp; !(get_class(data) === "Blob" || get_class(data) === "File") &amp;&amp; !(FakeBlob &amp;&amp; data instanceof FakeBlob)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof data !== "string") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>data += ""; // convert unsupported types to strings</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (1 in arguments) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nativeAppend.call(this, data, arguments[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nativeAppend.call(this, data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>view.Blob = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var blobParts = arguments[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var options = arguments[1];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var isInstanceOfBlob = this instanceof Blob;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - IE 8 throws an error when using instanceof</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (isInstanceOfBlob === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Failed to construct 'Blob': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (blobParts !== undefined &amp;&amp; typeof blobParts.length !== 'number') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Failed to construct 'Blob': Iterator getter is not callable.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof blobParts !== 'undefined' &amp;&amp; typeof blobParts !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Failed to construct 'Blob': Iterator getter is not callable.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof options !== 'undefined' &amp;&amp; typeof options !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Failed to construct 'Blob': parameter 2 ('options') is not an object.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var type = options ? (options.type || "") : "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var builder = new BlobBuilder();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (blobParts) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0, len = blobParts.length; i &lt; len; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof Uint8Array !== 'undefined' &amp;&amp; blobParts[i] instanceof Uint8Array) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>builder.append(blobParts[i].buffer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>builder.append(blobParts[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var blob = builder.getBlob(type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!blob.slice &amp;&amp; blob.webkitSlice) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>blob.slice = blob.webkitSlice;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return blob;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var getPrototypeOf = Object.getPrototypeOf || function (object) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return object.__proto__;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>view.Blob.prototype = getPrototypeOf(new view.Blob());</span></p>
<p class="p1"><span class="s1">}(typeof self !== "undefined" &amp;&amp; self || typeof window !== "undefined" &amp;&amp; window || this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// HTMLCanvasElement.prototype.toBlob</span></p>
<p class="p1"><span class="s1">/* global CreateMethodProperty, Uint8Array */</span></p>
<p class="p1"><span class="s1">CreateMethodProperty(HTMLCanvasElement.prototype, 'toBlob', function (callback, type, quality) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var binStr = atob(this.toDataURL(type, quality).split(',')[1]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var len = binStr.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var arr = new Uint8Array(len);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; len; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>arr[i] = binStr.charCodeAt(i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>callback(new Blob([arr], { type: type || 'image/png' }));</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// UserTiming</span></p>
<p class="p1"><span class="s1">/* eslint-env browser,amd,node */</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// usertiming.js</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// A polyfill for UserTiming (http://www.w3.org/TR/user-timing/)</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// Copyright 2013 Nic Jansma</span></p>
<p class="p1"><span class="s1">// http://nicj.net</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// https://github.com/nicjansma/usertiming.js</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// Licensed under the MIT license</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">(function(window) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>"use strict";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// allow running in Node.js environment</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof window === "undefined") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// prepare base perf object</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof window.performance === "undefined") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.performance = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// We need to keep a global reference to the window.performance object to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// prevent any added properties from being garbage-collected in Safari 8.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://bugs.webkit.org/show_bug.cgi?id=137407</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window._perfRefForUserTimingPolyfill = window.performance;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Note what we shimmed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window.performance.userTimingJsNow = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window.performance.userTimingJsNowPrefixed = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window.performance.userTimingJsUserTiming = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window.performance.userTimingJsUserTimingPrefixed = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window.performance.userTimingJsPerformanceTimeline = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>window.performance.userTimingJsPerformanceTimelinePrefixed = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// for prefixed support</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var prefixes = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var methods = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var methodTest = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var i, j;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// window.performance.now() shim</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//<span class="Apple-converted-space">  </span>http://www.w3.org/TR/hr-time/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof window.performance.now !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.performance.userTimingJsNow = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// copy prefixed version over if it exists</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>methods = ["webkitNow", "msNow", "mozNow"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (i = 0; i &lt; methods.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (typeof window.performance[methods[i]] === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>window.performance.now = window.performance[methods[i]];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>window.performance.userTimingJsNowPrefixed = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// now() should be a DOMHighResTimeStamp, which is defined as being a time relative</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// to navigationStart of the PerformanceTiming (PT) interface.<span class="Apple-converted-space">  </span>If this browser supports</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// PT, use that as our relative start.<span class="Apple-converted-space">  </span>Otherwise, use "now" as the start and all other</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// now() calls will be relative to our initialization.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>//</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var nowOffset = +(new Date());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (window.performance.timing &amp;&amp; window.performance.timing.navigationStart) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>nowOffset = window.performance.timing.navigationStart;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else if (typeof process !== "undefined" &amp;&amp; typeof process.hrtime === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>nowOffset = process.hrtime();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.now = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var time = process.hrtime(nowOffset);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return time[0] * 1e3 + time[1] * 1e-6;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.now !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// No browser support, fall back to Date.now</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (Date.now) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>window.performance.now = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return Date.now() - nowOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// no Date.now support, get the time from new Date()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>window.performance.now = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return +(new Date()) - nowOffset;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// PerformanceTimeline (PT) shims</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//<span class="Apple-converted-space">  </span>http://www.w3.org/TR/performance-timeline/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Adds an object to our internal Performance Timeline array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Will be blank if the environment supports PT.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var addToPerformanceTimeline = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Clears the specified entry types from our timeline array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>* Will be blank if the environment supports PT.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">     </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var clearEntriesFromPerformanceTimeline = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// performance timeline array</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var performanceTimeline = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// whether or not the timeline will require sort on getEntries()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var performanceTimelineRequiresSort = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// whether or not ResourceTiming is natively supported but UserTiming is</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// not (eg Firefox 35)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var hasNativeGetEntriesButNotUserTiming = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If getEntries() and mark() aren't defined, we'll assume</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// we have to shim at least some PT functions.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof window.performance.getEntries !== "function" ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>typeof window.performance.mark !== "function") {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.getEntries === "function" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>typeof window.performance.mark !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>hasNativeGetEntriesButNotUserTiming = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.performance.userTimingJsPerformanceTimeline = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// copy prefixed version over if it exists</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>prefixes = ["webkit", "moz"];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>methods = ["getEntries", "getEntriesByName", "getEntriesByType"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (i = 0; i &lt; methods.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (j = 0; j &lt; prefixes.length; j++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// prefixed method will likely have an upper-case first letter</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>methodTest = prefixes[j] + methods[i].substr(0, 1).toUpperCase() + methods[i].substr(1);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof window.performance[methodTest] === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>window.performance[methods[i]] = window.performance[methodTest];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>window.performance.userTimingJsPerformanceTimelinePrefixed = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Adds an object to our internal Performance Timeline array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Object} obj PerformanceEntry</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>addToPerformanceTimeline = function(obj) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>performanceTimeline.push(obj);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// If we insert a measure, its startTime may be out of order</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// from the rest of the entries because the use can use any</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// mark as the start time.<span class="Apple-converted-space">  </span>If so, note we have to sort it before</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// returning getEntries();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (obj.entryType === "measure") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>performanceTimelineRequiresSort = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Ensures our PT array is in the correct sorted order (by startTime)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var ensurePerformanceTimelineOrder = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!performanceTimelineRequiresSort) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Measures, which may be in this list, may enter the list in</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// an unsorted order. For example:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//<span class="Apple-converted-space">  </span>1. measure("a")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//<span class="Apple-converted-space">  </span>2. mark("start_mark")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//<span class="Apple-converted-space">  </span>3. measure("b", "start_mark")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//<span class="Apple-converted-space">  </span>4. measure("c")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//<span class="Apple-converted-space">  </span>5. getEntries()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// When calling #5, we should return [a,c,b] because technically the start time</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// of c is "0" (navigationStart), which will occur before b's start time due to the mark.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>performanceTimeline.sort(function(a, b) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return a.startTime - b.startTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>performanceTimelineRequiresSort = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* Clears the specified entry types from our timeline array.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {string} entryType Entry type (eg "mark" or "measure")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>* @param {string} [name] Entry name (optional)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>clearEntriesFromPerformanceTimeline = function(entryType, name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// clear all entries from the perf timeline</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>i = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>while (i &lt; performanceTimeline.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (performanceTimeline[i].entryType !== entryType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// unmatched entry type</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>i++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>continue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof name !== "undefined" &amp;&amp; performanceTimeline[i].name !== name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// unmatched name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>i++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>continue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// this entry matches our criteria, remove just it</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>performanceTimeline.splice(i, 1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.getEntries !== "function" || hasNativeGetEntriesButNotUserTiming) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var origGetEntries = window.performance.getEntries;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* Gets all entries from the Performance Timeline.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/performance-timeline/#dom-performance-getentries</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* NOTE: This will only ever return marks and measures.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @returns {PerformanceEntry[]} Array of PerformanceEntrys</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.getEntries = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ensurePerformanceTimelineOrder();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// get a copy of all of our entries</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var entries = performanceTimeline.slice(0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// if there was a native version of getEntries, add that</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (hasNativeGetEntriesButNotUserTiming &amp;&amp; origGetEntries) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// merge in native</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Array.prototype.push.apply(entries, origGetEntries.call(window.performance));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// sort by startTime</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>entries.sort(function(a, b) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return a.startTime - b.startTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return entries;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.getEntriesByType !== "function" || hasNativeGetEntriesButNotUserTiming) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var origGetEntriesByType = window.performance.getEntriesByType;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* Gets all entries from the Performance Timeline of the specified type.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/performance-timeline/#dom-performance-getentriesbytype</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* NOTE: This will only work for marks and measures.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} entryType Entry type (eg "mark" or "measure")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @returns {PerformanceEntry[]} Array of PerformanceEntrys</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.getEntriesByType = function(entryType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// we only support marks/measures</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof entryType === "undefined" ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>(entryType !== "mark" &amp;&amp; entryType !== "measure")) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (hasNativeGetEntriesButNotUserTiming &amp;&amp; origGetEntriesByType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// native version exists, forward</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return origGetEntriesByType.call(window.performance, entryType);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// see note in ensurePerformanceTimelineOrder() on why this is required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (entryType === "measure") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ensurePerformanceTimelineOrder();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// find all entries of entryType</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var entries = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (i = 0; i &lt; performanceTimeline.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (performanceTimeline[i].entryType === entryType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>entries.push(performanceTimeline[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return entries;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.getEntriesByName !== "function" || hasNativeGetEntriesButNotUserTiming) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var origGetEntriesByName = window.performance.getEntriesByName;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* Gets all entries from the Performance Timeline of the specified</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* name, and optionally, type.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/performance-timeline/#dom-performance-getentriesbyname</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* NOTE: This will only work for marks and measures.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} name Entry name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} [entryType] Entry type (eg "mark" or "measure")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @returns {PerformanceEntry[]} Array of PerformanceEntrys</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.getEntriesByName = function(name, entryType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (entryType &amp;&amp; entryType !== "mark" &amp;&amp; entryType !== "measure") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (hasNativeGetEntriesButNotUserTiming &amp;&amp; origGetEntriesByName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// native version exists, forward</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return origGetEntriesByName.call(window.performance, name, entryType);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// see note in ensurePerformanceTimelineOrder() on why this is required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof entryType !== "undefined" &amp;&amp; entryType === "measure") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ensurePerformanceTimelineOrder();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// find all entries of the name and (optionally) type</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var entries = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (i = 0; i &lt; performanceTimeline.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (typeof entryType !== "undefined" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>performanceTimeline[i].entryType !== entryType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>continue;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (performanceTimeline[i].name === name) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>entries.push(performanceTimeline[i]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (hasNativeGetEntriesButNotUserTiming &amp;&amp; origGetEntriesByName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// merge in native</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Array.prototype.push.apply(entries, origGetEntriesByName.call(window.performance, name, entryType));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// sort by startTime</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>entries.sort(function(a, b) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return a.startTime - b.startTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return entries;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// UserTiming support</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof window.performance.mark !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.performance.userTimingJsUserTiming = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// copy prefixed version over if it exists</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>prefixes = ["webkit", "moz", "ms"];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>methods = ["mark", "measure", "clearMarks", "clearMeasures"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>for (i = 0; i &lt; methods.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (j = 0; j &lt; prefixes.length; j++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// prefixed method will likely have an upper-case first letter</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>methodTest = prefixes[j] + methods[i].substr(0, 1).toUpperCase() + methods[i].substr(1);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof window.performance[methodTest] === "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>window.performance[methods[i]] = window.performance[methodTest];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>window.performance.userTimingJsUserTimingPrefixed = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// only used for measure(), to quickly see the latest timestamp of a mark</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var marks = {};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.mark !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* UserTiming mark</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/user-timing/#dom-performance-mark</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} markName Mark name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.mark = function(markName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var now = window.performance.now();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// mark name is required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof markName === "undefined") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>throw new SyntaxError("Mark name must be specified");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// mark name can't be a NT timestamp</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (window.performance.timing &amp;&amp; markName in window.performance.timing) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>throw new SyntaxError("Mark name is not allowed");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!marks[markName]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>marks[markName] = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>marks[markName].push(now);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// add to perf timeline as well</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>addToPerformanceTimeline({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>entryType: "mark",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>name: markName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>startTime: now,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>duration: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.clearMarks !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* UserTiming clear marks</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/user-timing/#dom-performance-clearmarks</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} markName Mark name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.clearMarks = function(markName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!markName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// clear all marks</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>marks = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>marks[markName] = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>clearEntriesFromPerformanceTimeline("mark", markName);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.measure !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* UserTiming measure</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/user-timing/#dom-performance-measure</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} measureName Measure name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} [startMark] Start mark name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} [endMark] End mark name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.measure = function(measureName, startMark, endMark) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var now = window.performance.now();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (typeof measureName === "undefined") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>throw new SyntaxError("Measure must be specified");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// if there isn't a startMark, we measure from navigationStart to now</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!startMark) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// add to perf timeline as well</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>addToPerformanceTimeline({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>entryType: "measure",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>name: measureName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>startTime: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>duration: now</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// If there is a startMark, check for it first in the NavigationTiming interface,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// then check our own marks.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var startMarkTime = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (window.performance.timing &amp;&amp; startMark in window.performance.timing) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// mark cannot have a timing of 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (startMark !== "navigationStart" &amp;&amp; window.performance.timing[startMark] === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>throw new Error(startMark + " has a timing of 0");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// time is the offset of this mark to navigationStart's time</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>startMarkTime = window.performance.timing[startMark] - window.performance.timing.navigationStart;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else if (startMark in marks) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>startMarkTime = marks[startMark][marks[startMark].length - 1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>throw new Error(startMark + " mark not found");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// If there is a endMark, check for it first in the NavigationTiming interface,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// then check our own marks.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var endMarkTime = now;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (endMark) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>endMarkTime = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (window.performance.timing &amp;&amp; endMark in window.performance.timing) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// mark cannot have a timing of 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (endMark !== "navigationStart" &amp;&amp; window.performance.timing[endMark] === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>throw new Error(endMark + " has a timing of 0");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// time is the offset of this mark to navigationStart's time</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>endMarkTime = window.performance.timing[endMark] - window.performance.timing.navigationStart;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else if (endMark in marks) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>endMarkTime = marks[endMark][marks[endMark].length - 1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>throw new Error(endMark + " mark not found");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// add to our measure array</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>var duration = endMarkTime - startMarkTime;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// add to perf timeline as well</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>addToPerformanceTimeline({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>entryType: "measure",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>name: measureName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>startTime: startMarkTime,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>duration: duration</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (typeof window.performance.clearMeasures !== "function") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* UserTiming clear measures</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* http://www.w3.org/TR/user-timing/#dom-performance-clearmeasures</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>* @param {string} measureName Measure name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">             </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.performance.clearMeasures = function(measureName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>clearEntriesFromPerformanceTimeline("measure", measureName);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Export UserTiming to the appropriate location.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// When included directly via a script tag in the browser, we're good as we've been</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// updating the window.performance object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof define === "function" &amp;&amp; define.amd) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// AMD / RequireJS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>define([], function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return window.performance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (typeof module !== "undefined" &amp;&amp; typeof module.exports !== "undefined") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Node.js</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>//</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>module.exports = window.performance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1">}(typeof window !== "undefined" ? window : undefined));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// WeakMap</span></p>
<p class="p1"><span class="s1">/* globals Symbol, OrdinaryCreateFromConstructor, IsCallable, GetIterator, IteratorStep, IteratorValue, IteratorClose, Get, Call, CreateMethodProperty, Type, SameValue */</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Deleted map items mess with iterator pointers, so rather than removing them mark them as deleted. Can't use undefined or null since those both valid keys so use a private symbol.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var undefMarker = Symbol('undef');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.1.1 WeakMap ( [ iterable ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var WeakMap = function WeakMap(/* iterable */) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If NewTarget is undefined, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof WeakMap)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Constructor WeakMap requires "new"');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Let map be ? OrdinaryCreateFromConstructor(NewTarget, "%WeakMapPrototype%", « [[WeakMapData]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var map = OrdinaryCreateFromConstructor(this, WeakMap.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_keys: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_values: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_es6WeakMap: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Set map.[[WeakMapData]] to a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - This step was done as part of step two.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If iterable is not present, let iterable be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iterable = arguments.length &gt; 0 ? arguments[0] : undefined;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If iterable is either undefined or null, return map.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (iterable === null || iterable === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let adder be ? Get(map, "set").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var adder = Get(map, "set");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. If IsCallable(adder) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!IsCallable(adder)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("WeakMap.prototype.set is not a function");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Let iteratorRecord be ? GetIterator(iterable).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iteratorRecord = GetIterator(iterable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Repeat,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let next be ? IteratorStep(iteratorRecord).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var next = IteratorStep(iteratorRecord);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If next is false, return map.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (next === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let nextItem be ? IteratorValue(next).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextItem = IteratorValue(next);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. If Type(nextItem) is not Object, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(nextItem) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let error be Completion{[[Type]]: throw, [[Value]]: a newly created TypeError object, [[Target]]: empty}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Iterator value ' + nextItem + ' is not an entry object');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Return ? IteratorClose(iteratorRecord, error).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - The try catch accounts for steps: f, h, and j.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. Let k be Get(nextItem, "0").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = Get(nextItem, "0");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// f. If k is an abrupt completion, return ? IteratorClose(iteratorRecord, k).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// g. Let v be Get(nextItem, "1").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var v = Get(nextItem, "1");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// h. If v is an abrupt completion, return ? IteratorClose(iteratorRecord, v).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Let status be Call(adder, map, « k.[[Value]], v.[[Value]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Call(adder, map, [k, v]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// j. If status is an abrupt completion, return ? IteratorClose(iteratorRecord, status).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - For user agents which do not have iteration methods on argument objects or arrays, we can special case those.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Array.isArray(iterable) ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.prototype.toString.call(iterable) === '[object Arguments]' ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE 7 &amp; IE 8 return '[object Object]' for the arguments object, we can detect by checking for the existence of the callee property</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(!!iterable.callee)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var length = iterable.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (index = 0; index &lt; length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var k = iterable[index][0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var v = iterable[index][1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Call(adder, map, [k, v]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return map;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.2.1 WeakMap.prototype</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of WeakMap.prototype is the intrinsic object %WeakMapPrototype%.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(WeakMap, 'prototype', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.3.1 WeakMap.prototype.constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakMap.prototype, 'constructor', WeakMap);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.3.2 WeakMap.prototype.delete ( key )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakMap.prototype, 'delete', function (key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[WeakMapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6WeakMap !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.clear called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[WeakMapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If Type(key) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(key) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValue(p.[[Key]], key) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValue(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Set p.[[Key]] to empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._keys[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Set p.[[Value]] to empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._values[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._size = --this._size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// iii. Return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.3.3 WeakMap.prototype.get ( key )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakMap.prototype, 'get', function get(key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.get called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[WeakMapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6WeakMap !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.get called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[WeakMapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If Type(key) is not Object, return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(key) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValue(p.[[Key]], key) is true, return p.[[Value]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValue(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return M._values[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.3.4 WeakMap.prototype.has ( key )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakMap.prototype, 'has', function has(key) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof M !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.has called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[WeakMapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6WeakMap !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.has called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[WeakMapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If Type(key) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(key) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValue(p.[[Key]], key) is true, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValue(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.3.5 WeakMap.prototype.set ( key, value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakMap.prototype, 'set', function set(key, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let M be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var M = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(M) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(M) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.set called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If M does not have a [[WeakMapData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._es6WeakMap !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakMap.prototype.set called on incompatible receiver ' + Object.prototype.toString.call(M));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is M.[[WeakMapData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = M._keys;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If Type(key) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(key) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("Invalid value used as weak map key");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each Record {[[Key]], [[Value]]} p that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If p.[[Key]] is not empty and SameValue(p.[[Key]], key) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (M._keys[i] !== undefMarker &amp;&amp; SameValue(M._keys[i], key)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Set p.[[Value]] to value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._values[i] = value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Return M.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return M;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Let p be the Record {[[Key]]: key, [[Value]]: value}.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var p = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'[[Key]]': key,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>'[[Value]]': value</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Append p as the last element of entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._keys.push(p['[[Key]]']);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>M._values.push(p['[[Value]]']);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Return M.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return M;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.3.3.6 WeakMap.prototype [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@toStringTag property is the String value "WeakMap".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - Safari 8 implements WeakMap.name but as a non-writable property, which means it would throw an error if we try and write to it here.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!('name' in WeakMap)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 19.2.4.2 name</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(WeakMap, 'name', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 'WeakMap'</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Export the object</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateMethodProperty(global, 'WeakMap', WeakMap);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE8 throws an error here if we set enumerable to false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// More info on table 2: https://msdn.microsoft.com/en-us/library/dd229916(v=vs.85).aspx</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global['WeakMap'] = WeakMap;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// WeakSet</span></p>
<p class="p1"><span class="s1">/* global Call, CreateMethodProperty, Get, GetIterator, IsArray, IsCallable, IteratorClose, IteratorStep, IteratorValue, OrdinaryCreateFromConstructor, SameValueZero, Type, Symbol */</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Deleted set items mess with iterator pointers, so rather than removing them mark them as deleted. Can't use undefined or null since those both valid keys so use a private symbol.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var undefMarker = Symbol('undef');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.1.1. WeakSet ( [ iterable ] )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var WeakSet = function WeakSet() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. If NewTarget is undefined, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!(this instanceof WeakSet)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Constructor WeakSet requires "new"');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. Let set be ? OrdinaryCreateFromConstructor(NewTarget, "%WeakSetPrototype%", « [[WeakSetData]] »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var set = OrdinaryCreateFromConstructor(this, WeakSet.prototype, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_values: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_size: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>_es6WeakSet: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. Set set.[[WeakSetData]] to a new empty List.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - This step was done as part of step two.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If iterable is not present, let iterable be undefined.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iterable = arguments.length &gt; 0 ? arguments[0] : undefined;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If iterable is either undefined or null, return set.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (iterable === null || iterable === undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. Let adder be ? Get(set, "add").</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var adder = Get(set, 'add');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. If IsCallable(adder) is false, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!IsCallable(adder)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError("WeakSet.prototype.add is not a function");</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Let iteratorRecord be ? GetIterator(iterable).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var iteratorRecord = GetIterator(iterable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 9. Repeat,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. Let next be ? IteratorStep(iteratorRecord).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var next = IteratorStep(iteratorRecord);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// b. If next is false, return set.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (next === false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// c. Let nextValue be ? IteratorValue(next).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var nextValue = IteratorValue(next);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// d. Let status be Call(adder, set, « nextValue »).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Call(adder, set, [nextValue]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// e. If status is an abrupt completion, return ? IteratorClose(iteratorRecord, status).</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return IteratorClose(iteratorRecord, e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Polyfill.io - For user agents which do not have iteration methods on argument objects or arrays, we can special case those.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (IsArray(iterable) ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.prototype.toString.call(iterable) === '[object Arguments]' ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE 7 &amp; IE 8 return '[object Object]' for the arguments object, we can detect by checking for the existence of the callee property</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(!!iterable.callee)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var length = iterable.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (index = 0; index &lt; length; index++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Call(adder, set, [iterable[index]]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return set;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.2.1. WeakSet.prototype</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of WeakSet.prototype is the intrinsic %WeakSetPrototype% object.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: false }.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Object.defineProperty(WeakSet, 'prototype', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: {}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.3.1. WeakSet.prototype.add ( value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakSet.prototype, 'add', function add(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(S) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakSet.prototype.add called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[WeakSetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6WeakSet !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakSet.prototype.add called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If Type(value) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(value) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Invalid value used in weak set');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Let entries be the List that is S.[[WeakSetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty and SameValue(e, value) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker &amp;&amp; SameValueZero(e, value)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Append value as the last element of entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>S._values.push(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 8. Return S.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return S;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.3.2. WeakSet.prototype.constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakSet.prototype, 'constructor', WeakSet);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.3.3. WeakSet.prototype.delete ( value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakSet.prototype, 'delete', function (value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(S) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakSet.prototype.delete called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[WeakSetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6WeakSet !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakSet.prototype.delete called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. If Type(value) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(value) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. Let entries be the List that is S.[[WeakSetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty and SameValue(e, value) is true, then</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker &amp;&amp; SameValueZero(e, value)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// i. Replace the element of entries whose value is e with an element whose value is empty.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>entries[i] = undefMarker;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ii. Return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.3.4. WeakSet.prototype.has ( value )</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CreateMethodProperty(WeakSet.prototype, 'has', function has(value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 1. Let S be the this value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var S = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 2. If Type(S) is not Object, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(S) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakSet.prototype.has called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 3. If S does not have a [[WeakSetData]] internal slot, throw a TypeError exception.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (S._es6WeakSet !== true) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new TypeError('Method WeakSet.prototype.has called on incompatible receiver ' + Object.prototype.toString.call(S));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 4. Let entries be the List that is S.[[WeakSetData]].</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var entries = S._values;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 5. If Type(value) is not Object, return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (Type(value) !== 'object') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 6. For each e that is an element of entries, do</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; entries.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var e = entries[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// a. If e is not empty and SameValue(e, value) is true, return true.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (e !== undefMarker &amp;&amp; SameValueZero(e, value)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 7. Return false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// 23.4.3.5. WeakSet.prototype [ @@toStringTag ]</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// The initial value of the @@toStringTag property is the String value "WeakSet".</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This property has the attributes { [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Polyfill.io - Safari 8 implements Set.name but as a non-configurable property, which means it would throw an error if we try and configure it here.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!('name' in WeakSet)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 19.2.4.2 name</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(WeakSet, 'name', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: 'WeakSet'</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Export the object</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>CreateMethodProperty(global, 'WeakSet', WeakSet);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE8 throws an error here if we set enumerable to false.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// More info on table 2: https://msdn.microsoft.com/en-us/library/dd229916(v=vs.85).aspx</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global['WeakSet'] = WeakSet;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// WebAnimations</span></p>
<p class="p1"><span class="s1">// Copyright 2014 Google Inc. All rights reserved.</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// Licensed under the Apache License, Version 2.0 (the "License");</span></p>
<p class="p1"><span class="s1">// you may not use this file except in compliance with the License.</span></p>
<p class="p1"><span class="s1">// <span class="Apple-converted-space">    </span>You may obtain a copy of the License at</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// http://www.apache.org/licenses/LICENSE-2.0</span></p>
<p class="p1"><span class="s1">//</span></p>
<p class="p1"><span class="s1">// Unless required by applicable law or agreed to in writing, software</span></p>
<p class="p1"><span class="s1">// distributed under the License is distributed on an "AS IS" BASIS,</span></p>
<p class="p1"><span class="s1">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></p>
<p class="p1"><span class="s1">// <span class="Apple-converted-space">    </span>See the License for the specific language governing permissions and</span></p>
<p class="p1"><span class="s1">// limitations under the License.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">!function(a,b){var c={},d={};!function(a,b){function c(a){if("number"==typeof a)return a;var b={};for(var c in a)b[c]=a[c];return b}function d(){this._delay=0,this._endDelay=0,this._fill="none",this._iterationStart=0,this._iterations=1,this._duration=0,this._playbackRate=1,this._direction="normal",this._easing="linear",this._easingFunction=x}function e(){return a.isDeprecated("Invalid timing inputs","2016-03-02","TypeError exceptions will be thrown instead.",!0)}function f(b,c,e){var f=new d;return c&amp;&amp;(f.fill="both",f.duration="auto"),"number"!=typeof b||isNaN(b)?void 0!==b&amp;&amp;Object.getOwnPropertyNames(b).forEach(function(c){if("auto"!=b[c]){if(("number"==typeof f[c]||"duration"==c)&amp;&amp;("number"!=typeof b[c]||isNaN(b[c])))return;if("fill"==c&amp;&amp;-1==v.indexOf(b[c]))return;if("direction"==c&amp;&amp;-1==w.indexOf(b[c]))return;if("playbackRate"==c&amp;&amp;1!==b[c]&amp;&amp;a.isDeprecated("AnimationEffectTiming.playbackRate","2014-11-28","Use Animation.playbackRate instead."))return;f[c]=b[c]}}):f.duration=b,f}function g(a){return"number"==typeof a&amp;&amp;(a=isNaN(a)?{duration:0}:{duration:a}),a}function h(b,c){return b=a.numericTimingToObject(b),f(b,c)}function i(a,b,c,d){return a&lt;0||a&gt;1||c&lt;0||c&gt;1?x:function(e){function f(a,b,c){return 3*a*(1-c)*(1-c)*c+3*b*(1-c)*c*c+c*c*c}if(e&lt;=0){var g=0;return a&gt;0?g=b/a:!b&amp;&amp;c&gt;0&amp;&amp;(g=d/c),g*e}if(e&gt;=1){var h=0;return c&lt;1?h=(d-1)/(c-1):1==c&amp;&amp;a&lt;1&amp;&amp;(h=(b-1)/(a-1)),1+h*(e-1)}for(var i=0,j=1;i&lt;j;){var k=(i+j)/2,l=f(a,c,k);if(Math.abs(e-l)&lt;1e-5)return f(b,d,k);l&lt;e?i=k:j=k}return f(b,d,k)}}function j(a,b){return function(c){if(c&gt;=1)return 1;var d=1/a;return(c+=b*d)-c%d}}function k(a){C||(C=document.createElement("div").style),C.animationTimingFunction="",C.animationTimingFunction=a;var b=C.animationTimingFunction;if(""==b&amp;&amp;e())throw new TypeError(a+" is not a valid value for easing");return b}function l(a){if("linear"==a)return x;var b=E.exec(a);if(b)return i.apply(this,b.slice(1).map(Number));var c=F.exec(a);return c?j(Number(c[1]),{start:y,middle:z,end:A}[c[2]]):B[a]||x}function m(a){return Math.abs(n(a)/a.playbackRate)}function n(a){return 0===a.duration||0===a.iterations?0:a.duration*a.iterations}function o(a,b,c){if(null==b)return G;var d=c.delay+a+c.endDelay;return b&lt;Math.min(c.delay,d)?H:b&gt;=Math.min(c.delay+a,d)?I:J}function p(a,b,c,d,e){switch(d){case H:return"backwards"==b||"both"==b?0:null;case J:return c-e;case I:return"forwards"==b||"both"==b?a:null;case G:return null}}function q(a,b,c,d,e){var f=e;return 0===a?b!==H&amp;&amp;(f+=c):f+=d/a,f}function r(a,b,c,d,e,f){var g=a===1/0?b%1:a%1;return 0!==g||c!==I||0===d||0===e&amp;&amp;0!==f||(g=1),g}function s(a,b,c,d){return a===I&amp;&amp;b===1/0?1/0:1===c?Math.floor(d)-1:Math.floor(d)}function t(a,b,c){var d=a;if("normal"!==a&amp;&amp;"reverse"!==a){var e=b;"alternate-reverse"===a&amp;&amp;(e+=1),d="normal",e!==1/0&amp;&amp;e%2!=0&amp;&amp;(d="reverse")}return"normal"===d?c:1-c}function u(a,b,c){var d=o(a,b,c),e=p(a,c.fill,b,d,c.delay);if(null===e)return null;var f=q(c.duration,d,c.iterations,e,c.iterationStart),g=r(f,c.iterationStart,d,c.iterations,e,c.duration),h=s(d,c.iterations,g,f),i=t(c.direction,h,g);return c._easingFunction(i)}var v="backwards|forwards|both|none".split("|"),w="reverse|alternate|alternate-reverse".split("|"),x=function(a){return a};d.prototype={_setMember:function(b,c){this["_"+b]=c,this._effect&amp;&amp;(this._effect._timingInput[b]=c,this._effect._timing=a.normalizeTimingInput(this._effect._timingInput),this._effect.activeDuration=a.calculateActiveDuration(this._effect._timing),this._effect._animation&amp;&amp;this._effect._animation._rebuildUnderlyingAnimation())},get playbackRate(){return this._playbackRate},set delay(a){this._setMember("delay",a)},get delay(){return this._delay},set endDelay(a){this._setMember("endDelay",a)},get endDelay(){return this._endDelay},set fill(a){this._setMember("fill",a)},get fill(){return this._fill},set iterationStart(a){if((isNaN(a)||a&lt;0)&amp;&amp;e())throw new TypeError("iterationStart must be a non-negative number, received: "+timing.iterationStart);this._setMember("iterationStart",a)},get iterationStart(){return this._iterationStart},set duration(a){if("auto"!=a&amp;&amp;(isNaN(a)||a&lt;0)&amp;&amp;e())throw new TypeError("duration must be non-negative or auto, received: "+a);this._setMember("duration",a)},get duration(){return this._duration},set direction(a){this._setMember("direction",a)},get direction(){return this._direction},set easing(a){this._easingFunction=l(k(a)),this._setMember("easing",a)},get easing(){return this._easing},set iterations(a){if((isNaN(a)||a&lt;0)&amp;&amp;e())throw new TypeError("iterations must be non-negative, received: "+a);this._setMember("iterations",a)},get iterations(){return this._iterations}};var y=1,z=.5,A=0,B={ease:i(.25,.1,.25,1),"ease-in":i(.42,0,1,1),"ease-out":i(0,0,.58,1),"ease-in-out":i(.42,0,.58,1),"step-start":j(1,y),"step-middle":j(1,z),"step-end":j(1,A)},C=null,D="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",E=new RegExp("cubic-bezier\\("+D+","+D+","+D+","+D+"\\)"),F=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/,G=0,H=1,I=2,J=3;a.cloneTimingInput=c,a.makeTiming=f,a.numericTimingToObject=g,a.normalizeTimingInput=h,a.calculateActiveDuration=m,a.calculateIterationProgress=u,a.calculatePhase=o,a.normalizeEasing=k,a.parseEasingFunction=l}(c),function(a,b){function c(a,b){return a in k?k[a][b]||b:b}function d(a){return"display"===a||0===a.lastIndexOf("animation",0)||0===a.lastIndexOf("transition",0)}function e(a,b,e){if(!d(a)){var f=h[a];if(f){i.style[a]=b;for(var g in f){var j=f[g],k=i.style[j];e[j]=c(j,k)}}else e[a]=c(a,b)}}function f(a){var b=[];for(var c in a)if(!(c in["easing","offset","composite"])){var d=a[c];Array.isArray(d)||(d=[d]);for(var e,f=d.length,g=0;g&lt;f;g++)e={},e.offset="offset"in a?a.offset:1==f?1:g/(f-1),"easing"in a&amp;&amp;(e.easing=a.easing),"composite"in a&amp;&amp;(e.composite=a.composite),e[c]=d[g],b.push(e)}return b.sort(function(a,b){return a.offset-b.offset}),b}function g(b){function c(){var a=d.length;null==d[a-1].offset&amp;&amp;(d[a-1].offset=1),a&gt;1&amp;&amp;null==d[0].offset&amp;&amp;(d[0].offset=0);for(var b=0,c=d[0].offset,e=1;e&lt;a;e++){var f=d[e].offset;if(null!=f){for(var g=1;g&lt;e-b;g++)d[b+g].offset=c+(f-c)*g/(e-b);b=e,c=f}}}if(null==b)return[];window.Symbol&amp;&amp;Symbol.iterator&amp;&amp;Array.prototype.from&amp;&amp;b[Symbol.iterator]&amp;&amp;(b=Array.from(b)),Array.isArray(b)||(b=f(b));for(var d=b.map(function(b){var c={};for(var d in b){var f=b[d];if("offset"==d){if(null!=f){if(f=Number(f),!isFinite(f))throw new TypeError("Keyframe offsets must be numbers.");if(f&lt;0||f&gt;1)throw new TypeError("Keyframe offsets must be between 0 and 1.")}}else if("composite"==d){if("add"==f||"accumulate"==f)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"add compositing is not supported"};if("replace"!=f)throw new TypeError("Invalid composite mode "+f+".")}else f="easing"==d?a.normalizeEasing(f):""+f;e(d,f,c)}return void 0==c.offset&amp;&amp;(c.offset=null),void 0==c.easing&amp;&amp;(c.easing="linear"),c}),g=!0,h=-1/0,i=0;i&lt;d.length;i++){var j=d[i].offset;if(null!=j){if(j&lt;h)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");h=j}else g=!1}return d=d.filter(function(a){return a.offset&gt;=0&amp;&amp;a.offset&lt;=1}),g||c(),d}var h={background:["backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","backgroundAttachment","backgroundOrigin","backgroundClip","backgroundColor"],border:["borderTopColor","borderTopStyle","borderTopWidth","borderRightColor","borderRightStyle","borderRightWidth","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeftColor","borderLeftStyle","borderLeftWidth"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderColor:["borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderWidth:["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],flex:["flexGrow","flexShrink","flexBasis"],font:["fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineHeight"],margin:["marginTop","marginRight","marginBottom","marginLeft"],outline:["outlineColor","outlineStyle","outlineWidth"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"]},i=document.createElementNS("http://www.w3.org/1999/xhtml","div"),j={thin:"1px",medium:"3px",thick:"5px"},k={borderBottomWidth:j,borderLeftWidth:j,borderRightWidth:j,borderTopWidth:j,fontSize:{"xx-small":"60%","x-small":"75%",small:"89%",medium:"100%",large:"120%","x-large":"150%","xx-large":"200%"},fontWeight:{normal:"400",bold:"700"},outlineWidth:j,textShadow:{none:"0px 0px 0px transparent"},boxShadow:{none:"0px 0px 0px 0px transparent"}};a.convertToArrayForm=f,a.normalizeKeyframes=g}(c),function(a){var b={};a.isDeprecated=function(a,c,d,e){var f=e?"are":"is",g=new Date,h=new Date(c);return h.setMonth(h.getMonth()+3),!(g&lt;h&amp;&amp;(a in b||console.warn("Web Animations: "+a+" "+f+" deprecated and will stop working on "+h.toDateString()+". "+d),b[a]=!0,1))},a.deprecated=function(b,c,d,e){var f=e?"are":"is";if(a.isDeprecated(b,c,d,e))throw new Error(b+" "+f+" no longer supported. "+d)}}(c),function(){if(document.documentElement.animate){var a=document.documentElement.animate([],0),b=!0;if(a&amp;&amp;(b=!1,"play|currentTime|pause|reverse|playbackRate|cancel|finish|startTime|playState".split("|").forEach(function(c){void 0===a[c]&amp;&amp;(b=!0)})),!b)return}!function(a,b,c){function d(a){for(var b={},c=0;c&lt;a.length;c++)for(var d in a[c])if("offset"!=d&amp;&amp;"easing"!=d&amp;&amp;"composite"!=d){var e={offset:a[c].offset,easing:a[c].easing,value:a[c][d]};b[d]=b[d]||[],b[d].push(e)}for(var f in b){var g=b[f];if(0!=g[0].offset||1!=g[g.length-1].offset)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"Partial keyframes are not supported"}}return b}function e(c){var d=[];for(var e in c)for(var f=c[e],g=0;g&lt;f.length-1;g++){var h=g,i=g+1,j=f[h].offset,k=f[i].offset,l=j,m=k;0==g&amp;&amp;(l=-1/0,0==k&amp;&amp;(i=h)),g==f.length-2&amp;&amp;(m=1/0,1==j&amp;&amp;(h=i)),d.push({applyFrom:l,applyTo:m,startOffset:f[h].offset,endOffset:f[i].offset,easingFunction:a.parseEasingFunction(f[h].easing),property:e,interpolation:b.propertyInterpolation(e,f[h].value,f[i].value)})}return d.sort(function(a,b){return a.startOffset-b.startOffset}),d}b.convertEffectInput=function(c){var f=a.normalizeKeyframes(c),g=d(f),h=e(g);return function(a,c){if(null!=c)h.filter(function(a){return c&gt;=a.applyFrom&amp;&amp;c&lt;a.applyTo}).forEach(function(d){var e=c-d.startOffset,f=d.endOffset-d.startOffset,g=0==f?0:d.easingFunction(e/f);b.apply(a,d.property,d.interpolation(g))});else for(var d in g)"offset"!=d&amp;&amp;"easing"!=d&amp;&amp;"composite"!=d&amp;&amp;b.clear(a,d)}}}(c,d),function(a,b,c){function d(a){return a.replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function e(a,b,c){h[c]=h[c]||[],h[c].push([a,b])}function f(a,b,c){for(var f=0;f&lt;c.length;f++){e(a,b,d(c[f]))}}function g(c,e,f){var g=c;/-/.test(c)&amp;&amp;!a.isDeprecated("Hyphenated property names","2016-03-22","Use camelCase instead.",!0)&amp;&amp;(g=d(c)),"initial"!=e&amp;&amp;"initial"!=f||("initial"==e&amp;&amp;(e=i[g]),"initial"==f&amp;&amp;(f=i[g]));for(var j=e==f?[]:h[g],k=0;j&amp;&amp;k&lt;j.length;k++){var l=j[k][0](e),m=j[k][0](f);if(void 0!==l&amp;&amp;void 0!==m){var n=j[k][1](l,m);if(n){var o=b.Interpolation.apply(null,n);return function(a){return 0==a?e:1==a?f:o(a)}}}}return b.Interpolation(!1,!0,function(a){return a?f:e})}var h={};b.addPropertiesHandler=f;var i={backgroundColor:"transparent",backgroundPosition:"0% 0%",borderBottomColor:"currentColor",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomWidth:"3px",borderLeftColor:"currentColor",borderLeftWidth:"3px",borderRightColor:"currentColor",borderRightWidth:"3px",borderSpacing:"2px",borderTopColor:"currentColor",borderTopLeftRadius:"0px",borderTopRightRadius:"0px",borderTopWidth:"3px",bottom:"auto",clip:"rect(0px, 0px, 0px, 0px)",color:"black",fontSize:"100%",fontWeight:"400",height:"auto",left:"auto",letterSpacing:"normal",lineHeight:"120%",marginBottom:"0px",marginLeft:"0px",marginRight:"0px",marginTop:"0px",maxHeight:"none",maxWidth:"none",minHeight:"0px",minWidth:"0px",opacity:"1.0",outlineColor:"invert",outlineOffset:"0px",outlineWidth:"3px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"0px",right:"auto",strokeDasharray:"none",strokeDashoffset:"0px",textIndent:"0px",textShadow:"0px 0px 0px transparent",top:"auto",transform:"",verticalAlign:"0px",visibility:"visible",width:"auto",wordSpacing:"normal",zIndex:"auto"};b.propertyInterpolation=g}(c,d),function(a,b,c){function d(b){var c=a.calculateActiveDuration(b),d=function(d){return a.calculateIterationProgress(c,d,b)};return d._totalDuration=b.delay+c+b.endDelay,d}b.KeyframeEffect=function(c,e,f,g){var h,i=d(a.normalizeTimingInput(f)),j=b.convertEffectInput(e),k=function(){j(c,h)};return k._update=function(a){return null!==(h=i(a))},k._clear=function(){j(c,null)},k._hasSameTarget=function(a){return c===a},k._target=c,k._totalDuration=i._totalDuration,k._id=g,k}}(c,d),function(a,b){function c(a,b){return!(!b.namespaceURI||-1==b.namespaceURI.indexOf("/svg"))&amp;&amp;(g in a||(a[g]=/Trident|MSIE|IEMobile|Edge|Android 4/i.test(a.navigator.userAgent)),a[g])}function d(a,b,c){c.enumerable=!0,c.configurable=!0,Object.defineProperty(a,b,c)}function e(a){this._element=a,this._surrogateStyle=document.createElementNS("http://www.w3.org/1999/xhtml","div").style,this._style=a.style,this._length=0,this._isAnimatedProperty={},this._updateSvgTransformAttr=c(window,a),this._savedTransformAttr=null;for(var b=0;b&lt;this._style.length;b++){var d=this._style[b];this._surrogateStyle[d]=this._style[d]}this._updateIndices()}function f(a){if(!a._webAnimationsPatchedStyle){var b=new e(a);try{d(a,"style",{get:function(){return b}})}catch(b){a.style._set=function(b,c){a.style[b]=c},a.style._clear=function(b){a.style[b]=""}}a._webAnimationsPatchedStyle=a.style}}var g="_webAnimationsUpdateSvgTransformAttr",h={cssText:1,length:1,parentRule:1},i={getPropertyCSSValue:1,getPropertyPriority:1,getPropertyValue:1,item:1,removeProperty:1,setProperty:1},j={removeProperty:1,setProperty:1};e.prototype={get cssText(){return this._surrogateStyle.cssText},set cssText(a){for(var b={},c=0;c&lt;this._surrogateStyle.length;c++)b[this._surrogateStyle[c]]=!0;this._surrogateStyle.cssText=a,this._updateIndices();for(var c=0;c&lt;this._surrogateStyle.length;c++)b[this._surrogateStyle[c]]=!0;for(var d in b)this._isAnimatedProperty[d]||this._style.setProperty(d,this._surrogateStyle.getPropertyValue(d))},get length(){return this._surrogateStyle.length},get parentRule(){return this._style.parentRule},_updateIndices:function(){for(;this._length&lt;this._surrogateStyle.length;)Object.defineProperty(this,this._length,{configurable:!0,enumerable:!1,get:function(a){return function(){return this._surrogateStyle[a]}}(this._length)}),this._length++;for(;this._length&gt;this._surrogateStyle.length;)this._length--,Object.defineProperty(this,this._length,{configurable:!0,enumerable:!1,value:void 0})},_set:function(b,c){this._style[b]=c,this._isAnimatedProperty[b]=!0,this._updateSvgTransformAttr&amp;&amp;"transform"==a.unprefixedPropertyName(b)&amp;&amp;(null==this._savedTransformAttr&amp;&amp;(this._savedTransformAttr=this._element.getAttribute("transform")),this._element.setAttribute("transform",a.transformToSvgMatrix(c)))},_clear:function(b){this._style[b]=this._surrogateStyle[b],this._updateSvgTransformAttr&amp;&amp;"transform"==a.unprefixedPropertyName(b)&amp;&amp;(this._savedTransformAttr?this._element.setAttribute("transform",this._savedTransformAttr):this._element.removeAttribute("transform"),this._savedTransformAttr=null),delete this._isAnimatedProperty[b]}};for(var k in i)e.prototype[k]=function(a,b){return function(){var c=this._surrogateStyle[a].apply(this._surrogateStyle,arguments);return b&amp;&amp;(this._isAnimatedProperty[arguments[0]]||this._style[a].apply(this._style,arguments),this._updateIndices()),c}}(k,k in j);for(var l in document.documentElement.style)l in h||l in i||function(a){d(e.prototype,a,{get:function(){return this._surrogateStyle[a]},set:function(b){this._surrogateStyle[a]=b,this._updateIndices(),this._isAnimatedProperty[a]||(this._style[a]=b)}})}(l);a.apply=function(b,c,d){f(b),b.style._set(a.propertyName(c),d)},a.clear=function(b,c){b._webAnimationsPatchedStyle&amp;&amp;b.style._clear(a.propertyName(c))}}(d),function(a){window.Element.prototype.animate=function(b,c){var d="";return c&amp;&amp;c.id&amp;&amp;(d=c.id),a.timeline._play(a.KeyframeEffect(this,b,c,d))}}(d),function(a,b){function c(a,b,d){if("number"==typeof a&amp;&amp;"number"==typeof b)return a*(1-d)+b*d;if("boolean"==typeof a&amp;&amp;"boolean"==typeof b)return d&lt;.5?a:b;if(a.length==b.length){for(var e=[],f=0;f&lt;a.length;f++)e.push(c(a[f],b[f],d));return e}throw"Mismatched interpolation arguments "+a+":"+b}a.Interpolation=function(a,b,d){return function(e){return d(c(a,b,e))}}}(d),function(a,b){function c(a,b,c){return Math.max(Math.min(a,c),b)}function d(b,d,e){var f=a.dot(b,d);f=c(f,-1,1);var g=[];if(1===f)g=b;else for(var h=Math.acos(f),i=1*Math.sin(e*h)/Math.sqrt(1-f*f),j=0;j&lt;4;j++)g.push(b[j]*(Math.cos(e*h)-f*i)+d[j]*i);return g}var e=function(){function a(a,b){for(var c=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],d=0;d&lt;4;d++)for(var e=0;e&lt;4;e++)for(var f=0;f&lt;4;f++)c[d][e]+=b[d][f]*a[f][e];return c}function b(a){return 0==a[0][2]&amp;&amp;0==a[0][3]&amp;&amp;0==a[1][2]&amp;&amp;0==a[1][3]&amp;&amp;0==a[2][0]&amp;&amp;0==a[2][1]&amp;&amp;1==a[2][2]&amp;&amp;0==a[2][3]&amp;&amp;0==a[3][2]&amp;&amp;1==a[3][3]}function c(c,d,e,f,g){for(var h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],i=0;i&lt;4;i++)h[i][3]=g[i];for(var i=0;i&lt;3;i++)for(var j=0;j&lt;3;j++)h[3][i]+=c[j]*h[j][i];var k=f[0],l=f[1],m=f[2],n=f[3],o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];o[0][0]=1-2*(l*l+m*m),o[0][1]=2*(k*l-m*n),o[0][2]=2*(k*m+l*n),o[1][0]=2*(k*l+m*n),o[1][1]=1-2*(k*k+m*m),o[1][2]=2*(l*m-k*n),o[2][0]=2*(k*m-l*n),o[2][1]=2*(l*m+k*n),o[2][2]=1-2*(k*k+l*l),h=a(h,o);var p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];e[2]&amp;&amp;(p[2][1]=e[2],h=a(h,p)),e[1]&amp;&amp;(p[2][1]=0,p[2][0]=e[0],h=a(h,p)),e[0]&amp;&amp;(p[2][0]=0,p[1][0]=e[0],h=a(h,p));for(var i=0;i&lt;3;i++)for(var j=0;j&lt;3;j++)h[i][j]*=d[i];return b(h)?[h[0][0],h[0][1],h[1][0],h[1][1],h[3][0],h[3][1]]:h[0].concat(h[1],h[2],h[3])}return c}();a.composeMatrix=e,a.quat=d}(d),function(a,b,c){a.sequenceNumber=0;var d=function(a,b,c){this.target=a,this.currentTime=b,this.timelineTime=c,this.type="finish",this.bubbles=!1,this.cancelable=!1,this.currentTarget=a,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()};b.Animation=function(b){this.id="",b&amp;&amp;b._id&amp;&amp;(this.id=b._id),this._sequenceNumber=a.sequenceNumber++,this._currentTime=0,this._startTime=null,this._paused=!1,this._playbackRate=1,this._inTimeline=!0,this._finishedFlag=!0,this.onfinish=null,this._finishHandlers=[],this._effect=b,this._inEffect=this._effect._update(0),this._idle=!0,this._currentTimePending=!1},b.Animation.prototype={_ensureAlive:function(){this.playbackRate&lt;0&amp;&amp;0===this.currentTime?this._inEffect=this._effect._update(-1):this._inEffect=this._effect._update(this.currentTime),this._inTimeline||!this._inEffect&amp;&amp;this._finishedFlag||(this._inTimeline=!0,b.timeline._animations.push(this))},_tickCurrentTime:function(a,b){a!=this._currentTime&amp;&amp;(this._currentTime=a,this._isFinished&amp;&amp;!b&amp;&amp;(this._currentTime=this._playbackRate&gt;0?this._totalDuration:0),this._ensureAlive())},get currentTime(){return this._idle||this._currentTimePending?null:this._currentTime},set currentTime(a){a=+a,isNaN(a)||(b.restart(),this._paused||null==this._startTime||(this._startTime=this._timeline.currentTime-a/this._playbackRate),this._currentTimePending=!1,this._currentTime!=a&amp;&amp;(this._idle&amp;&amp;(this._idle=!1,this._paused=!0),this._tickCurrentTime(a,!0),b.applyDirtiedAnimation(this)))},get startTime(){return this._startTime},set startTime(a){a=+a,isNaN(a)||this._paused||this._idle||(this._startTime=a,this._tickCurrentTime((this._timeline.currentTime-this._startTime)*this.playbackRate),b.applyDirtiedAnimation(this))},get playbackRate(){return this._playbackRate},set playbackRate(a){if(a!=this._playbackRate){var c=this.currentTime;this._playbackRate=a,this._startTime=null,"paused"!=this.playState&amp;&amp;"idle"!=this.playState&amp;&amp;(this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),b.applyDirtiedAnimation(this)),null!=c&amp;&amp;(this.currentTime=c)}},get _isFinished(){return!this._idle&amp;&amp;(this._playbackRate&gt;0&amp;&amp;this._currentTime&gt;=this._totalDuration||this._playbackRate&lt;0&amp;&amp;this._currentTime&lt;=0)},get _totalDuration(){return this._effect._totalDuration},get playState(){return this._idle?"idle":null==this._startTime&amp;&amp;!this._paused&amp;&amp;0!=this.playbackRate||this._currentTimePending?"pending":this._paused?"paused":this._isFinished?"finished":"running"},_rewind:function(){if(this._playbackRate&gt;=0)this._currentTime=0;else{if(!(this._totalDuration&lt;1/0))throw new DOMException("Unable to rewind negative playback rate animation with infinite duration","InvalidStateError");this._currentTime=this._totalDuration}},play:function(){this._paused=!1,(this._isFinished||this._idle)&amp;&amp;(this._rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),b.applyDirtiedAnimation(this)},pause:function(){this._isFinished||this._paused||this._idle?this._idle&amp;&amp;(this._rewind(),this._idle=!1):this._currentTimePending=!0,this._startTime=null,this._paused=!0},finish:function(){this._idle||(this.currentTime=this._playbackRate&gt;0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this._currentTimePending=!1,b.applyDirtiedAnimation(this))},cancel:function(){this._inEffect&amp;&amp;(this._inEffect=!1,this._idle=!0,this._paused=!1,this._isFinished=!0,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this._effect._update(null),b.applyDirtiedAnimation(this))},reverse:function(){this.playbackRate*=-1,this.play()},addEventListener:function(a,b){"function"==typeof b&amp;&amp;"finish"==a&amp;&amp;this._finishHandlers.push(b)},removeEventListener:function(a,b){if("finish"==a){var c=this._finishHandlers.indexOf(b);c&gt;=0&amp;&amp;this._finishHandlers.splice(c,1)}},_fireEvents:function(a){if(this._isFinished){if(!this._finishedFlag){var b=new d(this,this._currentTime,a),c=this._finishHandlers.concat(this.onfinish?[this.onfinish]:[]);setTimeout(function(){c.forEach(function(a){a.call(b.target,b)})},0),this._finishedFlag=!0}}else this._finishedFlag=!1},_tick:function(a,b){this._idle||this._paused||(null==this._startTime?b&amp;&amp;(this.startTime=a-this._currentTime/this.playbackRate):this._isFinished||this._tickCurrentTime((a-this._startTime)*this.playbackRate)),b&amp;&amp;(this._currentTimePending=!1,this._fireEvents(a))},get _needsTick(){return this.playState in{pending:1,running:1}||!this._finishedFlag},_targetAnimations:function(){var a=this._effect._target;return a._activeAnimations||(a._activeAnimations=[]),a._activeAnimations},_markTarget:function(){var a=this._targetAnimations();-1===a.indexOf(this)&amp;&amp;a.push(this)},_unmarkTarget:function(){var a=this._targetAnimations(),b=a.indexOf(this);-1!==b&amp;&amp;a.splice(b,1)}}}(c,d),function(a,b,c){function d(a){var b=j;j=[],a&lt;q.currentTime&amp;&amp;(a=q.currentTime),q._animations.sort(e),q._animations=h(a,!0,q._animations)[0],b.forEach(function(b){b[1](a)}),g(),l=void 0}function e(a,b){return a._sequenceNumber-b._sequenceNumber}function f(){this._animations=[],this.currentTime=window.performance&amp;&amp;performance.now?performance.now():0}function g(){o.forEach(function(a){a()}),o.length=0}function h(a,c,d){p=!0,n=!1,b.timeline.currentTime=a,m=!1;var e=[],f=[],g=[],h=[];return d.forEach(function(b){b._tick(a,c),b._inEffect?(f.push(b._effect),b._markTarget()):(e.push(b._effect),b._unmarkTarget()),b._needsTick&amp;&amp;(m=!0);var d=b._inEffect||b._needsTick;b._inTimeline=d,d?g.push(b):h.push(b)}),o.push.apply(o,e),o.push.apply(o,f),m&amp;&amp;requestAnimationFrame(function(){}),p=!1,[g,h]}var i=window.requestAnimationFrame,j=[],k=0;window.requestAnimationFrame=function(a){var b=k++;return 0==j.length&amp;&amp;i(d),j.push([b,a]),b},window.cancelAnimationFrame=function(a){j.forEach(function(b){b[0]==a&amp;&amp;(b[1]=function(){})})},f.prototype={_play:function(c){c._timing=a.normalizeTimingInput(c.timing);var d=new b.Animation(c);return d._idle=!1,d._timeline=this,this._animations.push(d),b.restart(),b.applyDirtiedAnimation(d),d}};var l=void 0,m=!1,n=!1;b.restart=function(){return m||(m=!0,requestAnimationFrame(function(){}),n=!0),n},b.applyDirtiedAnimation=function(a){if(!p){a._markTarget();var c=a._targetAnimations();c.sort(e),h(b.timeline.currentTime,!1,c.slice())[1].forEach(function(a){var b=q._animations.indexOf(a);-1!==b&amp;&amp;q._animations.splice(b,1)}),g()}};var o=[],p=!1,q=new f;b.timeline=q}(c,d),function(a,b){function c(a,b){for(var c=0,d=0;d&lt;a.length;d++)c+=a[d]*b[d];return c}function d(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]}function e(a){var b=a.rad||0;return((a.deg||0)/360+(a.grad||0)/400+(a.turn||0))*(2*Math.PI)+b}function f(a){switch(a.t){case"rotatex":var b=e(a.d[0]);return[1,0,0,0,0,Math.cos(b),Math.sin(b),0,0,-Math.sin(b),Math.cos(b),0,0,0,0,1];case"rotatey":var b=e(a.d[0]);return[Math.cos(b),0,-Math.sin(b),0,0,1,0,0,Math.sin(b),0,Math.cos(b),0,0,0,0,1];case"rotate":case"rotatez":var b=e(a.d[0]);return[Math.cos(b),Math.sin(b),0,0,-Math.sin(b),Math.cos(b),0,0,0,0,1,0,0,0,0,1];case"rotate3d":var c=a.d[0],d=a.d[1],f=a.d[2],b=e(a.d[3]),g=c*c+d*d+f*f;if(0===g)c=1,d=0,f=0;else if(1!==g){var h=Math.sqrt(g);c/=h,d/=h,f/=h}var i=Math.sin(b/2),j=i*Math.cos(b/2),k=i*i;return[1-2*(d*d+f*f)*k,2*(c*d*k+f*j),2*(c*f*k-d*j),0,2*(c*d*k-f*j),1-2*(c*c+f*f)*k,2*(d*f*k+c*j),0,2*(c*f*k+d*j),2*(d*f*k-c*j),1-2*(c*c+d*d)*k,0,0,0,0,1];case"scale":return[a.d[0],0,0,0,0,a.d[1],0,0,0,0,1,0,0,0,0,1];case"scalex":return[a.d[0],0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,a.d[0],0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,a.d[0],0,0,0,0,1];case"scale3d":return[a.d[0],0,0,0,0,a.d[1],0,0,0,0,a.d[2],0,0,0,0,1];case"skew":var l=e(a.d[0]),m=e(a.d[1]);return[1,Math.tan(m),0,0,Math.tan(l),1,0,0,0,0,1,0,0,0,0,1];case"skewx":var b=e(a.d[0]);return[1,0,0,0,Math.tan(b),1,0,0,0,0,1,0,0,0,0,1];case"skewy":var b=e(a.d[0]);return[1,Math.tan(b),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":var c=a.d[0].px||0,d=a.d[1].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,c,d,0,1];case"translatex":var c=a.d[0].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,c,0,0,1];case"translatey":var d=a.d[0].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,0,d,0,1];case"translatez":var f=a.d[0].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,f,1];case"translate3d":var c=a.d[0].px||0,d=a.d[1].px||0,f=a.d[2].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,c,d,f,1];case"perspective":return[1,0,0,0,0,1,0,0,0,0,1,a.d[0].px?-1/a.d[0].px:0,0,0,0,1];case"matrix":return[a.d[0],a.d[1],0,0,a.d[2],a.d[3],0,0,0,0,1,0,a.d[4],a.d[5],0,1];case"matrix3d":return a.d}}function g(a){return 0===a.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:a.map(f).reduce(d)}function h(a){return[i(g(a))]}var i=function(){function a(a){return a[0][0]*a[1][1]*a[2][2]+a[1][0]*a[2][1]*a[0][2]+a[2][0]*a[0][1]*a[1][2]-a[0][2]*a[1][1]*a[2][0]-a[1][2]*a[2][1]*a[0][0]-a[2][2]*a[0][1]*a[1][0]}function b(b){for(var c=1/a(b),d=b[0][0],e=b[0][1],f=b[0][2],g=b[1][0],h=b[1][1],i=b[1][2],j=b[2][0],k=b[2][1],l=b[2][2],m=[[(h*l-i*k)*c,(f*k-e*l)*c,(e*i-f*h)*c,0],[(i*j-g*l)*c,(d*l-f*j)*c,(f*g-d*i)*c,0],[(g*k-h*j)*c,(j*e-d*k)*c,(d*h-e*g)*c,0]],n=[],o=0;o&lt;3;o++){for(var p=0,q=0;q&lt;3;q++)p+=b[3][q]*m[q][o];n.push(p)}return n.push(1),m.push(n),m}function d(a){return[[a[0][0],a[1][0],a[2][0],a[3][0]],[a[0][1],a[1][1],a[2][1],a[3][1]],[a[0][2],a[1][2],a[2][2],a[3][2]],[a[0][3],a[1][3],a[2][3],a[3][3]]]}function e(a,b){for(var c=[],d=0;d&lt;4;d++){for(var e=0,f=0;f&lt;4;f++)e+=a[f]*b[f][d];c.push(e)}return c}function f(a){var b=g(a);return[a[0]/b,a[1]/b,a[2]/b]}function g(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}function h(a,b,c,d){return[c*a[0]+d*b[0],c*a[1]+d*b[1],c*a[2]+d*b[2]]}function i(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function j(j){var k=[j.slice(0,4),j.slice(4,8),j.slice(8,12),j.slice(12,16)];if(1!==k[3][3])return null;for(var l=[],m=0;m&lt;4;m++)l.push(k[m].slice());for(var m=0;m&lt;3;m++)l[m][3]=0;if(0===a(l))return null;var n,o=[];k[0][3]||k[1][3]||k[2][3]?(o.push(k[0][3]),o.push(k[1][3]),o.push(k[2][3]),o.push(k[3][3]),n=e(o,d(b(l)))):n=[0,0,0,1];var p=k[3].slice(0,3),q=[];q.push(k[0].slice(0,3));var r=[];r.push(g(q[0])),q[0]=f(q[0]);var s=[];q.push(k[1].slice(0,3)),s.push(c(q[0],q[1])),q[1]=h(q[1],q[0],1,-s[0]),r.push(g(q[1])),q[1]=f(q[1]),s[0]/=r[1],q.push(k[2].slice(0,3)),s.push(c(q[0],q[2])),q[2]=h(q[2],q[0],1,-s[1]),s.push(c(q[1],q[2])),q[2]=h(q[2],q[1],1,-s[2]),r.push(g(q[2])),q[2]=f(q[2]),s[1]/=r[2],s[2]/=r[2];var t=i(q[1],q[2]);if(c(q[0],t)&lt;0)for(var m=0;m&lt;3;m++)r[m]*=-1,q[m][0]*=-1,q[m][1]*=-1,q[m][2]*=-1;var u,v,w=q[0][0]+q[1][1]+q[2][2]+1;return w&gt;1e-4?(u=.5/Math.sqrt(w),v=[(q[2][1]-q[1][2])*u,(q[0][2]-q[2][0])*u,(q[1][0]-q[0][1])*u,.25/u]):q[0][0]&gt;q[1][1]&amp;&amp;q[0][0]&gt;q[2][2]?(u=2*Math.sqrt(1+q[0][0]-q[1][1]-q[2][2]),v=[.25*u,(q[0][1]+q[1][0])/u,(q[0][2]+q[2][0])/u,(q[2][1]-q[1][2])/u]):q[1][1]&gt;q[2][2]?(u=2*Math.sqrt(1+q[1][1]-q[0][0]-q[2][2]),v=[(q[0][1]+q[1][0])/u,.25*u,(q[1][2]+q[2][1])/u,(q[0][2]-q[2][0])/u]):(u=2*Math.sqrt(1+q[2][2]-q[0][0]-q[1][1]),v=[(q[0][2]+q[2][0])/u,(q[1][2]+q[2][1])/u,.25*u,(q[1][0]-q[0][1])/u]),[p,r,s,v,n]}return j}();a.dot=c,a.makeMatrixDecomposition=h,a.transformListToMatrix=g}(d),function(a){function b(a,b){var c=a.exec(b);if(c)return c=a.ignoreCase?c[0].toLowerCase():c[0],[c,b.substr(c.length)]}function c(a,b){b=b.replace(/^\s*/,"");var c=a(b);if(c)return[c[0],c[1].replace(/^\s*/,"")]}function d(a,d,e){a=c.bind(null,a);for(var f=[];;){var g=a(e);if(!g)return[f,e];if(f.push(g[0]),e=g[1],!(g=b(d,e))||""==g[1])return[f,e];e=g[1]}}function e(a,b){for(var c=0,d=0;d&lt;b.length&amp;&amp;(!/\s|,/.test(b[d])||0!=c);d++)if("("==b[d])c++;else if(")"==b[d]&amp;&amp;(c--,0==c&amp;&amp;d++,c&lt;=0))break;var e=a(b.substr(0,d));return void 0==e?void 0:[e,b.substr(d)]}function f(a,b){for(var c=a,d=b;c&amp;&amp;d;)c&gt;d?c%=d:d%=c;return c=a*b/(c+d)}function g(a){return function(b){var c=a(b);return c&amp;&amp;(c[0]=void 0),c}}function h(a,b){return function(c){return a(c)||[b,c]}}function i(b,c){for(var d=[],e=0;e&lt;b.length;e++){var f=a.consumeTrimmed(b[e],c);if(!f||""==f[0])return;void 0!==f[0]&amp;&amp;d.push(f[0]),c=f[1]}if(""==c)return d}function j(a,b,c,d,e){for(var g=[],h=[],i=[],j=f(d.length,e.length),k=0;k&lt;j;k++){var l=b(d[k%d.length],e[k%e.length]);if(!l)return;g.push(l[0]),h.push(l[1]),i.push(l[2])}return[g,h,function(b){var d=b.map(function(a,b){return i[b](a)}).join(c);return a?a(d):d}]}function k(a,b,c){for(var d=[],e=[],f=[],g=0,h=0;h&lt;c.length;h++)if("function"==typeof c[h]){var i=c[h](a[g],b[g++]);d.push(i[0]),e.push(i[1]),f.push(i[2])}else!function(a){d.push(!1),e.push(!1),f.push(function(){return c[a]})}(h);return[d,e,function(a){for(var b="",c=0;c&lt;a.length;c++)b+=f[c](a[c]);return b}]}a.consumeToken=b,a.consumeTrimmed=c,a.consumeRepeated=d,a.consumeParenthesised=e,a.ignore=g,a.optional=h,a.consumeList=i,a.mergeNestedRepeated=j.bind(null,null),a.mergeWrappedNestedRepeated=j,a.mergeList=k}(d),function(a){function b(b){function c(b){var c=a.consumeToken(/^inset/i,b);if(c)return d.inset=!0,c;var c=a.consumeLengthOrPercent(b);if(c)return d.lengths.push(c[0]),c;var c=a.consumeColor(b);return c?(d.color=c[0],c):void 0}var d={inset:!1,lengths:[],color:null},e=a.consumeRepeated(c,/^/,b);if(e&amp;&amp;e[0].length)return[d,e[1]]}function c(c){var d=a.consumeRepeated(b,/^,/,c);if(d&amp;&amp;""==d[1])return d[0]}function d(b,c){for(;b.lengths.length&lt;Math.max(b.lengths.length,c.lengths.length);)b.lengths.push({px:0});for(;c.lengths.length&lt;Math.max(b.lengths.length,c.lengths.length);)c.lengths.push({px:0});if(b.inset==c.inset&amp;&amp;!!b.color==!!c.color){for(var d,e=[],f=[[],0],g=[[],0],h=0;h&lt;b.lengths.length;h++){var i=a.mergeDimensions(b.lengths[h],c.lengths[h],2==h);f[0].push(i[0]),g[0].push(i[1]),e.push(i[2])}if(b.color&amp;&amp;c.color){var j=a.mergeColors(b.color,c.color);f[1]=j[0],g[1]=j[1],d=j[2]}return[f,g,function(a){for(var c=b.inset?"inset ":" ",f=0;f&lt;e.length;f++)c+=e[f](a[0][f])+" ";return d&amp;&amp;(c+=d(a[1])),c}]}}function e(b,c,d,e){function f(a){return{inset:a,color:[0,0,0,0],lengths:[{px:0},{px:0},{px:0},{px:0}]}}for(var g=[],h=[],i=0;i&lt;d.length||i&lt;e.length;i++){var j=d[i]||f(e[i].inset),k=e[i]||f(d[i].inset);g.push(j),h.push(k)}return a.mergeNestedRepeated(b,c,g,h)}var f=e.bind(null,d,", ");a.addPropertiesHandler(c,f,["box-shadow","text-shadow"])}(d),function(a,b){function c(a){return a.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}function d(a,b,c){return Math.min(b,Math.max(a,c))}function e(a){if(/^\s*[-+]?(\d*\.)?\d+\s*$/.test(a))return Number(a)}function f(a,b){return[a,b,c]}function g(a,b){if(0!=a)return i(0,1/0)(a,b)}function h(a,b){return[a,b,function(a){return Math.round(d(1,1/0,a))}]}function i(a,b){return function(e,f){return[e,f,function(e){return c(d(a,b,e))}]}}function j(a){var b=a.trim().split(/\s*[\s,]\s*/);if(0!==b.length){for(var c=[],d=0;d&lt;b.length;d++){var f=e(b[d]);if(void 0===f)return;c.push(f)}return c}}function k(a,b){if(a.length==b.length)return[a,b,function(a){return a.map(c).join(" ")}]}function l(a,b){return[a,b,Math.round]}a.clamp=d,a.addPropertiesHandler(j,k,["stroke-dasharray"]),a.addPropertiesHandler(e,i(0,1/0),["border-image-width","line-height"]),a.addPropertiesHandler(e,i(0,1),["opacity","shape-image-threshold"]),a.addPropertiesHandler(e,g,["flex-grow","flex-shrink"]),a.addPropertiesHandler(e,h,["orphans","widows"]),a.addPropertiesHandler(e,l,["z-index"]),a.parseNumber=e,a.parseNumberList=j,a.mergeNumbers=f,a.numberToString=c}(d),function(a,b){function c(a,b){if("visible"==a||"visible"==b)return[0,1,function(c){return c&lt;=0?a:c&gt;=1?b:"visible"}]}a.addPropertiesHandler(String,c,["visibility"])}(d),function(a,b){function c(a){a=a.trim(),f.fillStyle="#000",f.fillStyle=a;var b=f.fillStyle;if(f.fillStyle="#fff",f.fillStyle=a,b==f.fillStyle){f.fillRect(0,0,1,1);var c=f.getImageData(0,0,1,1).data;f.clearRect(0,0,1,1);var d=c[3]/255;return[c[0]*d,c[1]*d,c[2]*d,d]}}function d(b,c){return[b,c,function(b){function c(a){return Math.max(0,Math.min(255,a))}if(b[3])for(var d=0;d&lt;3;d++)b[d]=Math.round(c(b[d]/b[3]));return b[3]=a.numberToString(a.clamp(0,1,b[3])),"rgba("+b.join(",")+")"}]}var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");e.width=e.height=1;var f=e.getContext("2d");a.addPropertiesHandler(c,d,["background-color","border-bottom-color","border-left-color","border-right-color","border-top-color","color","fill","flood-color","lighting-color","outline-color","stop-color","stroke","text-decoration-color"]),a.consumeColor=a.consumeParenthesised.bind(null,c),a.mergeColors=d}(d),function(a,b){function c(a){function b(){var b=h.exec(a);g=b?b[0]:void 0}function c(){var a=Number(g);return b(),a}function d(){if("("!==g)return c();b();var a=f();return")"!==g?NaN:(b(),a)}function e(){for(var a=d();"*"===g||"/"===g;){var c=g;b();var e=d();"*"===c?a*=e:a/=e}return a}function f(){for(var a=e();"+"===g||"-"===g;){var c=g;b();var d=e();"+"===c?a+=d:a-=d}return a}var g,h=/([\+\-\w\.]+|[\(\)\*\/])/g;return b(),f()}function d(a,b){if("0"==(b=b.trim().toLowerCase())&amp;&amp;"px".search(a)&gt;=0)return{px:0};if(/^[^(]*$|^calc/.test(b)){b=b.replace(/calc\(/g,"(");var d={};b=b.replace(a,function(a){return d[a]=null,"U"+a});for(var e="U("+a.source+")",f=b.replace(/[-+]?(\d*\.)?\d+([Ee][-+]?\d+)?/g,"N").replace(new RegExp("N"+e,"g"),"D").replace(/\s[+-]\s/g,"O").replace(/\s/g,""),g=[/N\*(D)/g,/(N|D)[*\/]N/g,/(N|D)O\1/g,/\((N|D)\)/g],h=0;h&lt;g.length;)g[h].test(f)?(f=f.replace(g[h],"$1"),h=0):h++;if("D"==f){for(var i in d){var j=c(b.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(e,"g"),"*0"));if(!isFinite(j))return;d[i]=j}return d}}}function e(a,b){return f(a,b,!0)}function f(b,c,d){var e,f=[];for(e in b)f.push(e);for(e in c)f.indexOf(e)&lt;0&amp;&amp;f.push(e);return b=f.map(function(a){return b[a]||0}),c=f.map(function(a){return c[a]||0}),[b,c,function(b){var c=b.map(function(c,e){return 1==b.length&amp;&amp;d&amp;&amp;(c=Math.max(c,0)),a.numberToString(c)+f[e]}).join(" + ");return b.length&gt;1?"calc("+c+")":c}]}var g="px|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc",h=d.bind(null,new RegExp(g,"g")),i=d.bind(null,new RegExp(g+"|%","g")),j=d.bind(null,/deg|rad|grad|turn/g);a.parseLength=h,a.parseLengthOrPercent=i,a.consumeLengthOrPercent=a.consumeParenthesised.bind(null,i),a.parseAngle=j,a.mergeDimensions=f;var k=a.consumeParenthesised.bind(null,h),l=a.consumeRepeated.bind(void 0,k,/^/),m=a.consumeRepeated.bind(void 0,l,/^,/);a.consumeSizePairList=m;var n=function(a){var b=m(a);if(b&amp;&amp;""==b[1])return b[0]},o=a.mergeNestedRepeated.bind(void 0,e," "),p=a.mergeNestedRepeated.bind(void 0,o,",");a.mergeNonNegativeSizePair=o,a.addPropertiesHandler(n,p,["background-size"]),a.addPropertiesHandler(i,e,["border-bottom-width","border-image-width","border-left-width","border-right-width","border-top-width","flex-basis","font-size","height","line-height","max-height","max-width","outline-width","width"]),a.addPropertiesHandler(i,f,["border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","bottom","left","letter-spacing","margin-bottom","margin-left","margin-right","margin-top","min-height","min-width","outline-offset","padding-bottom","padding-left","padding-right","padding-top","perspective","right","shape-margin","stroke-dashoffset","text-indent","top","vertical-align","word-spacing"])}(d),function(a,b){function c(b){return a.consumeLengthOrPercent(b)||a.consumeToken(/^auto/,b)}function d(b){var d=a.consumeList([a.ignore(a.consumeToken.bind(null,/^rect/)),a.ignore(a.consumeToken.bind(null,/^\(/)),a.consumeRepeated.bind(null,c,/^,/),a.ignore(a.consumeToken.bind(null,/^\)/))],b);if(d&amp;&amp;4==d[0].length)return d[0]}function e(b,c){return"auto"==b||"auto"==c?[!0,!1,function(d){var e=d?b:c;if("auto"==e)return"auto";var f=a.mergeDimensions(e,e);return f[2](f[0])}]:a.mergeDimensions(b,c)}function f(a){return"rect("+a+")"}var g=a.mergeWrappedNestedRepeated.bind(null,f,e,", ");a.parseBox=d,a.mergeBoxes=g,a.addPropertiesHandler(d,g,["clip"])}(d),function(a,b){function c(a){return function(b){var c=0;return a.map(function(a){return a===k?b[c++]:a})}}function d(a){return a}function e(b){if("none"==(b=b.toLowerCase().trim()))return[];for(var c,d=/\s*(\w+)\(([^)]*)\)/g,e=[],f=0;c=d.exec(b);){if(c.index!=f)return;f=c.index+c[0].length;var g=c[1],h=n[g];if(!h)return;var i=c[2].split(","),j=h[0];if(j.length&lt;i.length)return;for(var k=[],o=0;o&lt;j.length;o++){var p,q=i[o],r=j[o];if(void 0===(p=q?{A:function(b){return"0"==b.trim()?m:a.parseAngle(b)},N:a.parseNumber,T:a.parseLengthOrPercent,L:a.parseLength}[r.toUpperCase()](q):{a:m,n:k[0],t:l}[r]))return;k.push(p)}if(e.push({t:g,d:k}),d.lastIndex==b.length)return e}}function f(a){return a.toFixed(6).replace(".000000","")}function g(b,c){if(b.decompositionPair!==c){b.decompositionPair=c;var d=a.makeMatrixDecomposition(b)}if(c.decompositionPair!==b){c.decompositionPair=b;var e=a.makeMatrixDecomposition(c)}return null==d[0]||null==e[0]?[[!1],[!0],function(a){return a?c[0].d:b[0].d}]:(d[0].push(0),e[0].push(1),[d,e,function(b){var c=a.quat(d[0][3],e[0][3],b[5]);return a.composeMatrix(b[0],b[1],b[2],c,b[4]).map(f).join(",")}])}function h(a){return a.replace(/[xy]/,"")}function i(a){return a.replace(/(x|y|z|3d)?$/,"3d")}function j(b,c){var d=a.makeMatrixDecomposition&amp;&amp;!0,e=!1;if(!b.length||!c.length){b.length||(e=!0,b=c,c=[]);for(var f=0;f&lt;b.length;f++){var j=b[f].t,k=b[f].d,l="scale"==j.substr(0,5)?1:0;c.push({t:j,d:k.map(function(a){if("number"==typeof a)return l;var b={};for(var c in a)b[c]=l;return b})})}}var m=function(a,b){return"perspective"==a&amp;&amp;"perspective"==b||("matrix"==a||"matrix3d"==a)&amp;&amp;("matrix"==b||"matrix3d"==b)},o=[],p=[],q=[];if(b.length!=c.length){if(!d)return;var r=g(b,c);o=[r[0]],p=[r[1]],q=[["matrix",[r[2]]]]}else for(var f=0;f&lt;b.length;f++){var j,s=b[f].t,t=c[f].t,u=b[f].d,v=c[f].d,w=n[s],x=n[t];if(m(s,t)){if(!d)return;var r=g([b[f]],[c[f]]);o.push(r[0]),p.push(r[1]),q.push(["matrix",[r[2]]])}else{if(s==t)j=s;else if(w[2]&amp;&amp;x[2]&amp;&amp;h(s)==h(t))j=h(s),u=w[2](u),v=x[2](v);else{if(!w[1]||!x[1]||i(s)!=i(t)){if(!d)return;var r=g(b,c);o=[r[0]],p=[r[1]],q=[["matrix",[r[2]]]];break}j=i(s),u=w[1](u),v=x[1](v)}for(var y=[],z=[],A=[],B=0;B&lt;u.length;B++){var C="number"==typeof u[B]?a.mergeNumbers:a.mergeDimensions,r=C(u[B],v[B]);y[B]=r[0],z[B]=r[1],A.push(r[2])}o.push(y),p.push(z),q.push([j,A])}}if(e){var D=o;o=p,p=D}return[o,p,function(a){return a.map(function(a,b){var c=a.map(function(a,c){return q[b][1][c](a)}).join(",");return"matrix"==q[b][0]&amp;&amp;16==c.split(",").length&amp;&amp;(q[b][0]="matrix3d"),q[b][0]+"("+c+")"}).join(" ")}]}var k=null,l={px:0},m={deg:0},n={matrix:["NNNNNN",[k,k,0,0,k,k,0,0,0,0,1,0,k,k,0,1],d],matrix3d:["NNNNNNNNNNNNNNNN",d],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",c([k,k,1]),d],scalex:["N",c([k,1,1]),c([k,1])],scaley:["N",c([1,k,1]),c([1,k])],scalez:["N",c([1,1,k])],scale3d:["NNN",d],skew:["Aa",null,d],skewx:["A",null,c([k,m])],skewy:["A",null,c([m,k])],translate:["Tt",c([k,k,l]),d],translatex:["T",c([k,l,l]),c([k,l])],translatey:["T",c([l,k,l]),c([l,k])],translatez:["L",c([l,l,k])],translate3d:["TTL",d]};a.addPropertiesHandler(e,j,["transform"]),a.transformToSvgMatrix=function(b){var c=a.transformListToMatrix(e(b));return"matrix("+f(c[0])+" "+f(c[1])+" "+f(c[4])+" "+f(c[5])+" "+f(c[12])+" "+f(c[13])+")"}}(d),function(a){function b(a){var b=Number(a);if(!(isNaN(b)||b&lt;100||b&gt;900||b%100!=0))return b}function c(b){return b=100*Math.round(b/100),b=a.clamp(100,900,b),400===b?"normal":700===b?"bold":String(b)}function d(a,b){return[a,b,c]}a.addPropertiesHandler(b,d,["font-weight"])}(d),function(a){function b(a){var b={};for(var c in a)b[c]=-a[c];return b}function c(b){return a.consumeToken(/^(left|center|right|top|bottom)\b/i,b)||a.consumeLengthOrPercent(b)}function d(b,d){var e=a.consumeRepeated(c,/^/,d);if(e&amp;&amp;""==e[1]){var f=e[0];if(f[0]=f[0]||"center",f[1]=f[1]||"center",3==b&amp;&amp;(f[2]=f[2]||{px:0}),f.length==b){if(/top|bottom/.test(f[0])||/left|right/.test(f[1])){var h=f[0];f[0]=f[1],f[1]=h}if(/left|right|center|Object/.test(f[0])&amp;&amp;/top|bottom|center|Object/.test(f[1]))return f.map(function(a){return"object"==typeof a?a:g[a]})}}}function e(d){var e=a.consumeRepeated(c,/^/,d);if(e){for(var f=e[0],h=[{"%":50},{"%":50}],i=0,j=!1,k=0;k&lt;f.length;k++){var l=f[k];"string"==typeof l?(j=/bottom|right/.test(l),i={left:0,right:0,center:i,top:1,bottom:1}[l],h[i]=g[l],"center"==l&amp;&amp;i++):(j&amp;&amp;(l=b(l),l["%"]=(l["%"]||0)+100),h[i]=l,i++,j=!1)}return[h,e[1]]}}function f(b){var c=a.consumeRepeated(e,/^,/,b);if(c&amp;&amp;""==c[1])return c[0]}var g={left:{"%":0},center:{"%":50},right:{"%":100},top:{"%":0},bottom:{"%":100}},h=a.mergeNestedRepeated.bind(null,a.mergeDimensions," ");a.addPropertiesHandler(d.bind(null,3),h,["transform-origin"]),a.addPropertiesHandler(d.bind(null,2),h,["perspective-origin"]),a.consumePosition=e,a.mergeOffsetList=h;var i=a.mergeNestedRepeated.bind(null,h,", ");a.addPropertiesHandler(f,i,["background-position","object-position"])}(d),function(a){function b(b){var c=a.consumeToken(/^circle/,b);if(c&amp;&amp;c[0])return["circle"].concat(a.consumeList([a.ignore(a.consumeToken.bind(void 0,/^\(/)),d,a.ignore(a.consumeToken.bind(void 0,/^at/)),a.consumePosition,a.ignore(a.consumeToken.bind(void 0,/^\)/))],c[1]));var f=a.consumeToken(/^ellipse/,b);if(f&amp;&amp;f[0])return["ellipse"].concat(a.consumeList([a.ignore(a.consumeToken.bind(void 0,/^\(/)),e,a.ignore(a.consumeToken.bind(void 0,/^at/)),a.consumePosition,a.ignore(a.consumeToken.bind(void 0,/^\)/))],f[1]));var g=a.consumeToken(/^polygon/,b);return g&amp;&amp;g[0]?["polygon"].concat(a.consumeList([a.ignore(a.consumeToken.bind(void 0,/^\(/)),a.optional(a.consumeToken.bind(void 0,/^nonzero\s*,|^evenodd\s*,/),"nonzero,"),a.consumeSizePairList,a.ignore(a.consumeToken.bind(void 0,/^\)/))],g[1])):void 0}function c(b,c){if(b[0]===c[0])return"circle"==b[0]?a.mergeList(b.slice(1),c.slice(1),["circle(",a.mergeDimensions," at ",a.mergeOffsetList,")"]):"ellipse"==b[0]?a.mergeList(b.slice(1),c.slice(1),["ellipse(",a.mergeNonNegativeSizePair," at ",a.mergeOffsetList,")"]):"polygon"==b[0]&amp;&amp;b[1]==c[1]?a.mergeList(b.slice(2),c.slice(2),["polygon(",b[1],g,")"]):void 0}var d=a.consumeParenthesised.bind(null,a.parseLengthOrPercent),e=a.consumeRepeated.bind(void 0,d,/^/),f=a.mergeNestedRepeated.bind(void 0,a.mergeDimensions," "),g=a.mergeNestedRepeated.bind(void 0,f,",");a.addPropertiesHandler(b,c,["shape-outside"])}(d),function(a,b){function c(a,b){b.concat([a]).forEach(function(b){b in document.documentElement.style&amp;&amp;(d[a]=b),e[b]=a})}var d={},e={};c("transform",["webkitTransform","msTransform"]),c("transformOrigin",["webkitTransformOrigin"]),c("perspective",["webkitPerspective"]),c("perspectiveOrigin",["webkitPerspectiveOrigin"]),a.propertyName=function(a){return d[a]||a},a.unprefixedPropertyName=function(a){return e[a]||a}}(d)}(),function(){if(void 0===document.createElement("div").animate([]).oncancel){var a;if(window.performance&amp;&amp;performance.now)var a=function(){return performance.now()};else var a=function(){return Date.now()};var b=function(a,b,c){this.target=a,this.currentTime=b,this.timelineTime=c,this.type="cancel",this.bubbles=!1,this.cancelable=!1,this.currentTarget=a,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()},c=window.Element.prototype.animate;window.Element.prototype.animate=function(d,e){var f=c.call(this,d,e);f._cancelHandlers=[],f.oncancel=null;var g=f.cancel;f.cancel=function(){g.call(this);var c=new b(this,null,a()),d=this._cancelHandlers.concat(this.oncancel?[this.oncancel]:[]);setTimeout(function(){d.forEach(function(a){a.call(c.target,c)})},0)};var h=f.addEventListener;f.addEventListener=function(a,b){"function"==typeof b&amp;&amp;"cancel"==a?this._cancelHandlers.push(b):h.call(this,a,b)};var i=f.removeEventListener;return f.removeEventListener=function(a,b){if("cancel"==a){var c=this._cancelHandlers.indexOf(b);c&gt;=0&amp;&amp;this._cancelHandlers.splice(c,1)}else i.call(this,a,b)},f}}}(),function(a){var b=document.documentElement,c=null,d=!1;try{var e=getComputedStyle(b).getPropertyValue("opacity"),f="0"==e?"1":"0";c=b.animate({opacity:[f,f]},{duration:1}),c.currentTime=0,d=getComputedStyle(b).getPropertyValue("opacity")==f}catch(a){}finally{c&amp;&amp;c.cancel()}if(!d){var g=window.Element.prototype.animate;window.Element.prototype.animate=function(b,c){return window.Symbol&amp;&amp;Symbol.iterator&amp;&amp;Array.prototype.from&amp;&amp;b[Symbol.iterator]&amp;&amp;(b=Array.from(b)),Array.isArray(b)||null===b||(b=a.convertToArrayForm(b)),g.call(this,b,c)}}}(c),b.true=a}({},function(){return this}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Window</span></p>
<p class="p1"><span class="s1">if ((typeof WorkerGlobalScope === "undefined") &amp;&amp; (typeof importScripts !== "function")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (global.constructor) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.Window = global.constructor;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(global.Window = global.constructor = new Function('return function Window() {}')()).prototype = this;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}(this));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Event</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var unlistenableWindowEvents = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>click: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>dblclick: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keyup: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keypress: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keydown: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mousedown: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouseup: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mousemove: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouseover: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouseenter: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouseleave: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>mouseout: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>storage: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>storagecommit: 1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>textinput: 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// This polyfill depends on availability of `document` so will not run in a worker</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// However, we asssume there are no browsers with worker support that lack proper</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// support for `Event` within the worker</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (typeof document === 'undefined' || typeof window === 'undefined') return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function indexOf(array, element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = -1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = array.length;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (++index &lt; length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (index in array &amp;&amp; array[index] === element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var existingProto = (window.Event &amp;&amp; window.Event.prototype) || null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function Event(type, eventInitDict) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('Not enough arguments');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var event;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Shortcut if browser supports createEvent</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ('createEvent' in document) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event = document.createEvent('Event');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var bubbles = eventInitDict &amp;&amp; eventInitDict.bubbles !== undefined ? eventInitDict.bubbles : false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var cancelable = eventInitDict &amp;&amp; eventInitDict.cancelable !== undefined ? eventInitDict.cancelable : false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.initEvent(type, bubbles, cancelable);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return event;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event = document.createEventObject();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.type = type;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.bubbles = eventInitDict &amp;&amp; eventInitDict.bubbles !== undefined ? eventInitDict.bubbles : false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.cancelable = eventInitDict &amp;&amp; eventInitDict.cancelable !== undefined ? eventInitDict.cancelable : false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return event;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Event.NONE = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Event.CAPTURING_PHASE = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Event.AT_TARGET = 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>Event.BUBBLING_PHASE = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>window.Event = Window.prototype.Event = Event;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (existingProto) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Object.defineProperty(window.Event, 'prototype', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>configurable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>enumerable: false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>writable: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value: existingProto</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!('createEvent' in document)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>window.addEventListener = Window.prototype.addEventListener = Document.prototype.addEventListener = Element.prototype.addEventListener = function addEventListener() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element = this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>type = arguments[0],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>listener = arguments[1];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (element === window &amp;&amp; type in unlistenableWindowEvents) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('In IE8 the event: ' + type + ' is not available on the window object. Please see https://github.com/Financial-Times/polyfill-service/issues/317 for more information.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!element._events) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element._events = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!element._events[type]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element._events[type] = function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>list = element._events[event.type].list,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>events = list.slice(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = -1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>length = events.length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>eventElement;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.preventDefault = function preventDefault() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (event.cancelable !== false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.returnValue = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.stopPropagation = function stopPropagation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.cancelBubble = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.stopImmediatePropagation = function stopImmediatePropagation() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.cancelBubble = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.cancelImmediate = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.currentTarget = element;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.relatedTarget = event.fromElement || null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.target = event.target || event.srcElement || element;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.timeStamp = new Date().getTime();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (event.clientX) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.pageX = event.clientX + document.documentElement.scrollLeft;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.pageY = event.clientY + document.documentElement.scrollTop;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while (++index &lt; length &amp;&amp; !event.cancelImmediate) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (index in events) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>eventElement = events[index];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (indexOf(list, eventElement) !== -1 &amp;&amp; typeof eventElement === 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>eventElement.call(element, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element._events[type].list = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (element.attachEvent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.attachEvent('on' + type, element._events[type]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element._events[type].list.push(listener);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>window.removeEventListener = Window.prototype.removeEventListener = Document.prototype.removeEventListener = Element.prototype.removeEventListener = function removeEventListener() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element = this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>type = arguments[0],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>listener = arguments[1],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (element._events &amp;&amp; element._events[type] &amp;&amp; element._events[type].list) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>index = indexOf(element._events[type].list, listener);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (index !== -1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element._events[type].list.splice(index, 1);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!element._events[type].list.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (element.detachEvent) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element.detachEvent('on' + type, element._events[type]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>delete element._events[type];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>window.dispatchEvent = Window.prototype.dispatchEvent = Document.prototype.dispatchEvent = Element.prototype.dispatchEvent = function dispatchEvent(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!arguments.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('Not enough arguments');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!event || typeof event.type !== 'string') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('DOM Events Exception 0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var element = this, type = event.type;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (!event.bubbles) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.cancelBubble = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var cancelBubbleEvent = function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.cancelBubble = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(element || window).detachEvent('on' + type, cancelBubbleEvent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.attachEvent('on' + type, cancelBubbleEvent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this.fireEvent('on' + type, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.target = element;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>do {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.currentTarget = element;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ('_events' in element &amp;&amp; typeof element._events[type] === 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element._events[type].call(element, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (typeof element['on' + type] === 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element['on' + type].call(element, event);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>element = element.nodeType === 9 ? element.parentWindow : element.parentNode;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} while (element &amp;&amp; !event.cancelBubble);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Add the DOMContentLoaded Event</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.attachEvent('onreadystatechange', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (document.readyState === 'complete') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.dispatchEvent(new Event('DOMContentLoaded', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bubbles: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// CustomEvent</span></p>
<p class="p1"><span class="s1">this.CustomEvent = function CustomEvent(type, eventInitDict) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw Error('TypeError: Failed to construct "CustomEvent": An event name must be provided.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var event;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>eventInitDict = eventInitDict || {bubbles: false, cancelable: false, detail: null};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if ('createEvent' in document) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event = document.createEvent('CustomEvent');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.initCustomEvent(type, eventInitDict.bubbles, eventInitDict.cancelable, eventInitDict.detail);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// for browsers which don't support CustomEvent at all, we use a regular event instead</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event = document.createEvent('Event');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.initEvent(type, eventInitDict.bubbles, eventInitDict.cancelable);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.detail = eventInitDict.detail;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// IE8</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event = new Event(type, eventInitDict);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event.detail = eventInitDict &amp;&amp; eventInitDict.detail || null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return event;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">CustomEvent.prototype = Event.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// document.visibilityState</span></p>
<p class="p1"><span class="s1">// PageVisibility</span></p>
<p class="p1"><span class="s1">(function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var prefix = document.webkitVisibilityState ? 'webkit' : document.mozVisibilityState ? 'moz' : null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function normalizeState () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.hidden = document[prefix + 'Hidden'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.visibilityState = document[prefix + 'VisibilityState'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (!prefix) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>normalizeState();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>document.addEventListener(prefix + 'visibilitychange', function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>normalizeState();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>document.dispatchEvent(new CustomEvent('visibilitychange'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}());</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Event.focusin</span></p>
<p class="p1"><span class="s1">this.addEventListener('focus', function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>event.target.dispatchEvent(new Event('focusin', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bubbles: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>cancelable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}));</span></p>
<p class="p1"><span class="s1">}, true);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">this.addEventListener('blur', function (event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>event.target.dispatchEvent(new Event('focusout', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bubbles: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>cancelable: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}));</span></p>
<p class="p1"><span class="s1">}, true);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Event.hashchange</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var hash = global.location.hash;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function poll() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (hash !== global.location.hash) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>hash = global.location.hash;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>global.dispatchEvent(new Event('hashchange'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setTimeout(poll, 500);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// Make sure a check for 'onhashchange' in window will pass (note: setting to undefined IE&lt;9 causes 'Not implemented' error)</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.onhashchange = function () { };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>poll();</span></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// getComputedStyle</span></p>
<p class="p1"><span class="s1">(function (global) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function getComputedStylePixel(element, property, fontSize) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// Internet Explorer sometimes struggles to read currentStyle until the element's document is accessed.</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value = element.document &amp;&amp; element.currentStyle[property].match(/([\d\.]+)(%|cm|em|in|mm|pc|pt|)/) || [0, 0, ''],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>size = value[1],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>suffix = value[2],</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>rootSize;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fontSize = !fontSize ? fontSize : /%|em/.test(suffix) &amp;&amp; element.parentElement ? getComputedStylePixel(element.parentElement, 'fontSize', null) : 16;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>rootSize = property == 'fontSize' ? fontSize : /width/i.test(property) ? element.clientWidth : element.clientHeight;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return suffix == '%' ? size / 100 * rootSize :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>suffix == 'cm' ? size * 0.3937 * 96 :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>suffix == 'em' ? size * fontSize :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>suffix == 'in' ? size * 96 :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>suffix == 'mm' ? size * 0.3937 * 96 / 10 :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>suffix == 'pc' ? size * 12 * 96 / 72 :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>suffix == 'pt' ? size * 96 / 72 :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">      </span>size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function setShortStyleProperty(style, property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>borderSuffix = property == 'border' ? 'Width' : '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>t = property + 'Top' + borderSuffix,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>r = property + 'Right' + borderSuffix,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b = property + 'Bottom' + borderSuffix,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>l = property + 'Left' + borderSuffix;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style[property] = (style[t] == style[r] &amp;&amp; style[t] == style[b] &amp;&amp; style[t] == style[l] ? [ style[t] ] :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">                  </span>style[t] == style[b] &amp;&amp; style[l] == style[r] ? [ style[t], style[r] ] :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">                  </span>style[l] == style[r] ? [ style[t], style[r], style[b] ] :</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> <span class="Apple-converted-space">                  </span>[ style[t], style[r], style[b], style[l] ]).join(' ');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>function CSSStyleDeclaration(element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style = this,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>currentStyle = element.currentStyle,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fontSize = getComputedStylePixel(element, 'fontSize'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>unCamelCase = function (match) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return '-' + match.toLowerCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>property;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (property in currentStyle) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Array.prototype.push.call(style, property == 'styleFloat' ? 'float' : property.replace(/[A-Z]/, unCamelCase));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (property == 'width') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style[property] = element.offsetWidth + 'px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (property == 'height') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style[property] = element.offsetHeight + 'px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (property == 'styleFloat') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style.float = currentStyle[property];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (/margin.|padding.|border.+W/.test(property) &amp;&amp; style[property] != 'auto') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style[property] = Math.round(getComputedStylePixel(element, property, fontSize)) + 'px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else if (/^outline/.test(property)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// errors on checking outline</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style[property] = currentStyle[property];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style.outlineColor = currentStyle.color;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style.outlineStyle = style.outlineStyle || 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style.outlineWidth = style.outlineWidth || '0px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style.outline = [style.outlineColor, style.outlineWidth, style.outlineStyle].join(' ');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style[property] = currentStyle[property];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setShortStyleProperty(style, 'margin');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setShortStyleProperty(style, 'padding');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setShortStyleProperty(style, 'border');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>style.fontSize = Math.round(fontSize) + 'px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>CSSStyleDeclaration.prototype = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>constructor: CSSStyleDeclaration,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;.getPropertyPriority</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>getPropertyPriority: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('NotSupportedError: DOM Exception 9');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;.getPropertyValue</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>getPropertyValue: function (property) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this[property.replace(/-\w/g, function (match) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return match[1].toUpperCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>})];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;.item</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>item: function (index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this[index];</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;.removeProperty</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>removeProperty: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('NoModificationAllowedError: DOM Exception 7');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;.setProperty</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setProperty: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('NoModificationAllowedError: DOM Exception 7');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// &lt;CSSStyleDeclaration&gt;.getPropertyCSSValue</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>getPropertyCSSValue: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>throw new Error('NotSupportedError: DOM Exception 9');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// &lt;Global&gt;.getComputedStyle</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.getComputedStyle = function getComputedStyle(element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return new CSSStyleDeclaration(element);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}(this));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// IntersectionObserver</span></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Copyright 2016 Google Inc. All Rights Reserved.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Licensed under the Apache License, Version 2.0 (the "License");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* you may not use this file except in compliance with the License.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* You may obtain a copy of the License at</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>http://www.apache.org/licenses/LICENSE-2.0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Unless required by applicable law or agreed to in writing, software</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* distributed under the License is distributed on an "AS IS" BASIS,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* See the License for the specific language governing permissions and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* limitations under the License.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">(function(window, document) {</span></p>
<p class="p1"><span class="s1">'use strict';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* An IntersectionObserver registry. This registry exists to hold a strong</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* reference to IntersectionObserver instances currently observering a target</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* element. Without this registry, instances without another reference may be</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* garbage collected.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">var registry = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Creates the global IntersectionObserverEntry constructor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* https://wicg.github.io/IntersectionObserver/#intersection-observer-entry</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Object} entry A dictionary of instance properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function IntersectionObserverEntry(entry) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.time = entry.time;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.target = entry.target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.rootBounds = entry.rootBounds;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.boundingClientRect = entry.boundingClientRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.intersectionRect = entry.intersectionRect || getEmptyRect();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.isIntersecting = !!entry.intersectionRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} catch (err) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// This means we are using the IntersectionObserverEntry polyfill which has only defined a getter</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Calculates the intersection ratio.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var targetRect = this.boundingClientRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var targetArea = targetRect.width * targetRect.height;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var intersectionRect = this.intersectionRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var intersectionArea = intersectionRect.width * intersectionRect.height;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Sets intersection ratio.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (targetArea) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.intersectionRatio = intersectionArea / targetArea;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If area is zero and is intersecting, sets to 1, otherwise to 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this.intersectionRatio = this.isIntersecting ? 1 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Creates the global IntersectionObserver constructor.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* https://wicg.github.io/IntersectionObserver/#intersection-observer-interface</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Function} callback The function to be invoked after intersection</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>changes have queued. The function is not invoked if the queue has</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>been emptied by calling the `takeRecords` method.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Object=} opt_options Optional configuration options.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @constructor</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function IntersectionObserver(callback, opt_options) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var options = opt_options || {};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (typeof callback != 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>throw new Error('callback must be a function');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (options.root &amp;&amp; options.root.nodeType != 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>throw new Error('root must be an Element');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Binds and throttles `this._checkForIntersections`.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._checkForIntersections = throttle(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._checkForIntersections.bind(this), this.THROTTLE_TIMEOUT);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Private properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._callback = callback;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._observationTargets = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._queuedEntries = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._rootMarginValues = this._parseRootMargin(options.rootMargin);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Public properties.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.thresholds = this._initThresholds(options.threshold);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.root = options.root || null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this.rootMargin = this._rootMarginValues.map(function(margin) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return margin.value + margin.unit;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}).join(' ');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* The minimum interval within which the document will be checked for</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* intersection changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype.THROTTLE_TIMEOUT = 100;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* The frequency in which the polyfill polls for intersection changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* this can be updated on a per instance basis and must be set prior to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* calling `observe` on the first target.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype.POLL_INTERVAL = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Starts observing a target element for intersection changes based on</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* the thresholds values.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Element} target The DOM element to observe.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype.observe = function(target) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// If the target is already being observed, do nothing.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (this._observationTargets.some(function(item) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return item.element == target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>})) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!(target &amp;&amp; target.nodeType == 1)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>throw new Error('target must be an Element');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._registerInstance();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._observationTargets.push({element: target, entry: null});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._monitorIntersections();</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Stops observing a target element for intersection changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Element} target The DOM element to observe.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype.unobserve = function(target) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._observationTargets =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._observationTargets.filter(function(item) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return item.element != target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!this._observationTargets.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._unmonitorIntersections();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._unregisterInstance();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Stops observing all target elements for intersection changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype.disconnect = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._observationTargets = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._unmonitorIntersections();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._unregisterInstance();</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns any queue entries that have not yet been reported to the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* callback and clears the queue. This can be used in conjunction with the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* callback to obtain the absolute most up-to-date intersection information.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Array} The currently queued entries.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype.takeRecords = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var records = this._queuedEntries.slice();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._queuedEntries = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return records;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Accepts the threshold value from the user configuration object and</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* returns a sorted array of unique threshold values. If a value is not</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* between 0 and 1 and error is thrown.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Array|number=} opt_threshold An optional threshold value or</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>a list of threshold values, defaulting to [0].</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Array} A sorted list of unique and valid threshold values.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._initThresholds = function(opt_threshold) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var threshold = opt_threshold || [0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!Array.isArray(threshold)) threshold = [threshold];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return threshold.sort().filter(function(t, i, a) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (typeof t != 'number' || isNaN(t) || t &lt; 0 || t &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw new Error('threshold must be a number between 0 and 1 inclusively');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return t !== a[i - 1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Accepts the rootMargin value from the user configuration object</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* and returns an array of the four margin values as an object containing</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* the value and unit properties. If any of the values are not properly</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* formatted or use a unit other than px or %, and error is thrown.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {string=} opt_rootMargin An optional rootMargin value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>defaulting to '0px'.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Array&lt;Object&gt;} An array of margin objects with the keys</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>value and unit.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._parseRootMargin = function(opt_rootMargin) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var marginString = opt_rootMargin || '0px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var margins = marginString.split(/\s+/).map(function(margin) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var parts = /^(-?\d*\.?\d+)(px|%)$/.exec(margin);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!parts) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw new Error('rootMargin must be specified in pixels or percent');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return {value: parseFloat(parts[1]), unit: parts[2]};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Handles shorthand.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>margins[1] = margins[1] || margins[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>margins[2] = margins[2] || margins[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>margins[3] = margins[3] || margins[1];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return margins;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Starts polling for intersection changes if the polling is not already</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* happening, and if the page's visibilty state is visible.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._monitorIntersections = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!this._monitoringIntersections) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._monitoringIntersections = true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._checkForIntersections();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If a poll interval is set, use polling instead of listening to</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// resize and scroll events or DOM mutations.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this.POLL_INTERVAL) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._monitoringInterval = setInterval(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>this._checkForIntersections, this.POLL_INTERVAL);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>addEvent(window, 'resize', this._checkForIntersections, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>addEvent(document, 'scroll', this._checkForIntersections, true);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if ('MutationObserver' in window) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._domObserver = new MutationObserver(this._checkForIntersections);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._domObserver.observe(document, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>attributes: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>childList: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>characterData: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>subtree: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Stops polling for intersection changes.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._unmonitorIntersections = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (this._monitoringIntersections) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._monitoringIntersections = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>clearInterval(this._monitoringInterval);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._monitoringInterval = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>removeEvent(window, 'resize', this._checkForIntersections, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>removeEvent(document, 'scroll', this._checkForIntersections, true);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (this._domObserver) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._domObserver.disconnect();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._domObserver = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Scans each observation target for intersection changes and adds them</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* to the internal entries queue. If new entries are found, it</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* schedules the callback to be invoked.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._checkForIntersections = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var rootIsInDom = this._rootIsInDom();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var rootRect = rootIsInDom ? this._getRootRect() : getEmptyRect();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>this._observationTargets.forEach(function(item) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var target = item.element;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var targetRect = getBoundingClientRect(target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var rootContainsTarget = this._rootContainsTarget(target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var oldEntry = item.entry;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var intersectionRect = rootIsInDom &amp;&amp; rootContainsTarget &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._computeTargetAndRootIntersection(target, rootRect);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var newEntry = item.entry = new IntersectionObserverEntry({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>time: now(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>target: target,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>boundingClientRect: targetRect,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rootBounds: rootRect,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>intersectionRect: intersectionRect</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!oldEntry) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this._queuedEntries.push(newEntry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (rootIsInDom &amp;&amp; rootContainsTarget) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// If the new entry intersection ratio has crossed any of the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// thresholds, add a new entry.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (this._hasCrossedThreshold(oldEntry, newEntry)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._queuedEntries.push(newEntry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// If the root is not in the DOM or target is not contained within</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// root but the previous entry for this target had an intersection,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// add a new record indicating removal.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (oldEntry &amp;&amp; oldEntry.isIntersecting) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this._queuedEntries.push(newEntry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}, this);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (this._queuedEntries.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>this._callback(this.takeRecords(), this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Accepts a target and root rect computes the intersection between then</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* following the algorithm in the spec.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* TODO(philipwalton): at this time clip-path is not considered.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* https://wicg.github.io/IntersectionObserver/#calculate-intersection-rect-algo</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Element} target The target DOM element</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Object} rootRect The bounding rect of the root after being</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>expanded by the rootMargin value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {?Object} The final intersection rect object or undefined if no</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>intersection is found.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._computeTargetAndRootIntersection =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function(target, rootRect) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// If the element isn't displayed, an intersection can't happen.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (window.getComputedStyle(target).display == 'none') return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var targetRect = getBoundingClientRect(target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var intersectionRect = targetRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var parent = getParentNode(target);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var atRoot = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>while (!atRoot) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var parentRect = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var parentComputedStyle = parent.nodeType == 1 ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.getComputedStyle(parent) : {};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If the parent isn't displayed, an intersection can't happen.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (parentComputedStyle.display == 'none') return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (parent == this.root || parent == document) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>atRoot = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>parentRect = rootRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// If the element has a non-visible overflow, and it's not the &lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// or &lt;html&gt; element, update the intersection rect.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// Note: &lt;body&gt; and &lt;html&gt; cannot be clipped to a rect that's not also</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// the document rect, so no need to compute a new intersection.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (parent != document.body &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>parent != document.documentElement &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>parentComputedStyle.overflow != 'visible') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>parentRect = getBoundingClientRect(parent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If either of the above conditionals set a new parentRect,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// calculate new intersection data.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (parentRect) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>intersectionRect = computeRectIntersection(parentRect, intersectionRect);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!intersectionRect) break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>parent = getParentNode(parent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return intersectionRect;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns the root rect after being expanded by the rootMargin value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Object} The expanded root rect.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._getRootRect = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var rootRect;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (this.root) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>rootRect = getBoundingClientRect(this.root);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Use &lt;html&gt;/&lt;body&gt; instead of window since scroll bars affect size.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var html = document.documentElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var body = document.body;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>rootRect = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>top: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>left: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>right: html.clientWidth || body.clientWidth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: html.clientWidth || body.clientWidth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>bottom: html.clientHeight || body.clientHeight,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: html.clientHeight || body.clientHeight</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return this._expandRectByRootMargin(rootRect);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Accepts a rect and expands it by the rootMargin value.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Object} rect The rect object to expand.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Object} The expanded rect.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._expandRectByRootMargin = function(rect) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var margins = this._rootMarginValues.map(function(margin, i) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return margin.unit == 'px' ? margin.value :</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>margin.value * (i % 2 ? rect.width : rect.height) / 100;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var newRect = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>top: rect.top - margins[0],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>right: rect.right + margins[1],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bottom: rect.bottom + margins[2],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>left: rect.left - margins[3]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>newRect.width = newRect.right - newRect.left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>newRect.height = newRect.bottom - newRect.top;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return newRect;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Accepts an old and new entry and returns true if at least one of the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* threshold values has been crossed.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {?IntersectionObserverEntry} oldEntry The previous entry for a</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*<span class="Apple-converted-space">    </span>particular target element or null if no previous entry exists.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {IntersectionObserverEntry} newEntry The current entry for a</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*<span class="Apple-converted-space">    </span>particular target element.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {boolean} Returns true if a any threshold has been crossed.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._hasCrossedThreshold =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>function(oldEntry, newEntry) {</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// To make comparing easier, an entry that has a ratio of 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// but does not actually intersect is given a value of -1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var oldRatio = oldEntry &amp;&amp; oldEntry.isIntersecting ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>oldEntry.intersectionRatio || 0 : -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var newRatio = newEntry.isIntersecting ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>newEntry.intersectionRatio || 0 : -1;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Ignore unchanged ratios</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (oldRatio === newRatio) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>for (var i = 0; i &lt; this.thresholds.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>var threshold = this.thresholds[i];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Return true if an entry matches a threshold or if the new ratio</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// and the old ratio are on the opposite sides of a threshold.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (threshold == oldRatio || threshold == newRatio ||</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>threshold &lt; oldRatio !== threshold &lt; newRatio) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns whether or not the root element is an element and is in the DOM.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {boolean} True if the root element is an element and is in the DOM.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._rootIsInDom = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return !this.root || containsDeep(document, this.root);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns whether or not the target element is a child of root.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Element} target The target element to check.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {boolean} True if the target element is a child of root.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._rootContainsTarget = function(target) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return containsDeep(this.root || document, target);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Adds the instance to the global IntersectionObserver registry if it isn't</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* already present.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._registerInstance = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (registry.indexOf(this) &lt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>registry.push(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Removes the instance from the global IntersectionObserver registry.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @private</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">IntersectionObserver.prototype._unregisterInstance = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var index = registry.indexOf(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (index != -1) registry.splice(index, 1);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns the result of the performance.now() method or null in browsers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* that don't support the API.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {number} The elapsed time since the page was requested.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function now() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return window.performance &amp;&amp; performance.now &amp;&amp; performance.now();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Throttles a function and delays its executiong, so it's only called at most</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* once within a given time period.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Function} fn The function to throttle.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {number} timeout The amount of time that must pass before the</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>function can be called again.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Function} The throttled function.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function throttle(fn, timeout) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var timer = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!timer) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>timer = setTimeout(function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>fn();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>timer = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}, timeout);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Adds an event handler to a DOM node ensuring cross-browser compatibility.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Node} node The DOM node to add the event handler to.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {string} event The event name.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Function} fn The event handler to add.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {boolean} opt_useCapture Optionally adds the even to the capture</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>phase. Note: this only works in modern browsers.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function addEvent(node, event, fn, opt_useCapture) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (typeof node.addEventListener == 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>node.addEventListener(event, fn, opt_useCapture || false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>else if (typeof node.attachEvent == 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>node.attachEvent('on' + event, fn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Removes a previously added event handler from a DOM node.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Node} node The DOM node to remove the event handler from.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {string} event The event name.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Function} fn The event handler to remove.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {boolean} opt_useCapture If the event handler was added with this</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>flag set to true, it should be set to true here in order to remove it.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function removeEvent(node, event, fn, opt_useCapture) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (typeof node.removeEventListener == 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>node.removeEventListener(event, fn, opt_useCapture || false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>else if (typeof node.detatchEvent == 'function') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>node.detatchEvent('on' + event, fn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns the intersection between two rect objects.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Object} rect1 The first rect.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Object} rect2 The second rect.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {?Object} The intersection rect or undefined if no intersection</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* <span class="Apple-converted-space">    </span>is found.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function computeRectIntersection(rect1, rect2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var top = Math.max(rect1.top, rect2.top);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var bottom = Math.min(rect1.bottom, rect2.bottom);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var left = Math.max(rect1.left, rect2.left);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var right = Math.min(rect1.right, rect2.right);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var width = right - left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var height = bottom - top;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return (width &gt;= 0 &amp;&amp; height &gt;= 0) &amp;&amp; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>top: top,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bottom: bottom,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>left: left,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>right: right,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>width: width,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>height: height</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Shims the native getBoundingClientRect for compatibility with older IE.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Element} el The element whose bounding rect to get.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Object} The (possibly shimmed) rect of the element.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function getBoundingClientRect(el) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var rect;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>rect = el.getBoundingClientRect();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} catch (err) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Ignore Windows 7 IE11 "Unspecified error"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// https://github.com/WICG/IntersectionObserver/pull/205</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!rect) return getEmptyRect();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Older IE</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!(rect.width &amp;&amp; rect.height)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>rect = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>top: rect.top,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>right: rect.right,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>bottom: rect.bottom,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>left: rect.left,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: rect.right - rect.left,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>height: rect.bottom - rect.top</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return rect;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Returns an empty rect object. An empty rect is returned when an element</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* is not in the DOM.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Object} The empty rect.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function getEmptyRect() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>top: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bottom: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>left: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>right: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>width: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>height: 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Checks to see if a parent element contains a child elemnt (including inside</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* shadow DOM).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Node} parent The parent element.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Node} child The child element.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {boolean} True if the parent node contains the child node.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function containsDeep(parent, child) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var node = child;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>while (node) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (node == parent) return true;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>node = getParentNode(node);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return false;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* Gets the parent node of an element or its host element if the parent node</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* is a shadow root.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @param {Node} node The node whose parent to get.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>* @return {Node|null} The parent node or null if no parent exists.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>*/</span></p>
<p class="p1"><span class="s1">function getParentNode(node) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>var parent = node.parentNode;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (parent &amp;&amp; parent.nodeType == 11 &amp;&amp; parent.host) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// If the parent is a shadow root, return the host element.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return parent.host;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return parent;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Exposes the constructors globally.</span></p>
<p class="p1"><span class="s1">window.IntersectionObserver = IntersectionObserver;</span></p>
<p class="p1"><span class="s1">window.IntersectionObserverEntry = IntersectionObserverEntry;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">}(window, document));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// IntersectionObserverEntry</span></p>
<p class="p1"><span class="s1">// Minimal polyfill for Edge 15's lack of `isIntersecting`</span></p>
<p class="p1"><span class="s1">// See: https://github.com/WICG/IntersectionObserver/issues/211</span></p>
<p class="p1"><span class="s1">Object.defineProperty(IntersectionObserverEntry.prototype,</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>'isIntersecting', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>get: function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this.intersectionRatio &gt; 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1">);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// XMLHttpRequest</span></p>
<p class="p1"><span class="s1">(function (global, NativeXMLHttpRequest) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>// &lt;Global&gt;.XMLHttpRequest</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.XMLHttpRequest = function XMLHttpRequest() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var request = this, nativeRequest = request._request = NativeXMLHttpRequest ? new NativeXMLHttpRequest() : new ActiveXObject('MSXML2.XMLHTTP.3.0');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nativeRequest.onreadystatechange = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.readyState = nativeRequest.readyState;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var readyState = request.readyState === 4;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.response = request.responseText = readyState ? nativeRequest.responseText : null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.status = readyState ? nativeRequest.status : null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.statusText = readyState ? nativeRequest.statusText : null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.dispatchEvent(new Event('readystatechange'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (readyState) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.dispatchEvent(new Event('load'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if ('onerror' in nativeRequest) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>nativeRequest.onerror = function () {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>request.dispatchEvent(new Event('error'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.XMLHttpRequest.UNSENT = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.XMLHttpRequest.OPENED = 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.XMLHttpRequest.HEADERS_RECEIVED = 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.XMLHttpRequest.LOADING = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>global.XMLHttpRequest.DONE = 4;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var XMLHttpRequestPrototype = global.XMLHttpRequest.prototype;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.addEventListener = global.addEventListener;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.removeEventListener = global.removeEventListener;</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.dispatchEvent = global.dispatchEvent;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.abort = function abort() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this._request();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.getAllResponseHeaders = function getAllResponseHeaders() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this._request.getAllResponseHeaders();</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.getResponseHeader = function getResponseHeader(header) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return this._request.getResponseHeader(header);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.open = function open(method, url) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// method, url, async, username, password</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._request.open(method, url, arguments[2], arguments[3], arguments[4]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.overrideMimeType = function overrideMimeType(mimetype) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._request.overrideMimeType(mimetype);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.send = function send() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._request.send(0 in arguments ? arguments[0] : null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>XMLHttpRequestPrototype.setRequestHeader = function setRequestHeader(header, value) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>this._request.setRequestHeader(header, value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>};</span></p>
<p class="p1"><span class="s1">}(this, this.XMLHttpRequest));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// navigator.sendBeacon</span></p>
<p class="p1"><span class="s1">if (!('navigator' in this)) this.navigator = {};</span></p>
<p class="p1"><span class="s1">this.navigator.sendBeacon = function sendBeacon(url, data) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>var xhr = ('XMLHttpRequest' in window) ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>xhr.open('POST', url, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>xhr.setRequestHeader('Accept', '*/*');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>if (typeof data === 'string') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xhr.setRequestHeader('Content-Type', 'text/plain;charset=UTF-8');</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>} else if (Object.prototype.toString.call(data) === '[object Blob]') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (data.type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>xhr.setRequestHeader('Content-Type', data.type);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>xhr.send(data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-tab-span">	</span>return true;</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p1"><span class="s1">})</span></p>
<p class="p1"><span class="s1">.call('object' === typeof window &amp;&amp; window || 'object' === typeof self &amp;&amp; self || 'object' === typeof global &amp;&amp; global || {});</span></p>
</body>
</html>
